<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Documentation.SBV.Examples.Crypto.AES</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">sbv-8.6: SMT Based Verification: Symbolic Haskell theorem prover using SMT solving.</span><ul class="links" id="page-menu"><li><a href="src/Documentation.SBV.Examples.Crypto.AES.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Levent Erkok</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>erkokl@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Documentation.SBV.Examples.Crypto.AES</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Formalizing GF(2^8)</a></li><li><a href="#g:2">Implementing AES</a><ul><li><a href="#g:3">Types and basic operations</a></li><li><a href="#g:4">The key schedule</a></li><li><a href="#g:5">The S-box transformation</a></li><li><a href="#g:6">The inverse S-box transformation</a></li><li><a href="#g:7">AddRoundKey transformation</a></li><li><a href="#g:8">Tables for T-Box encryption</a></li><li><a href="#g:9">Tables for T-Box decryption</a></li><li><a href="#g:10">AES rounds</a></li></ul></li><li><a href="#g:11">AES API</a></li><li><a href="#g:12">Test vectors</a><ul><li><a href="#g:13">128-bit enc/dec test</a></li><li><a href="#g:14">192-bit enc/dec test</a></li><li><a href="#g:15">256-bit enc/dec test</a></li></ul></li><li><a href="#g:16">Verification</a></li><li><a href="#g:17">Code generation</a></li><li><a href="#g:18">C-library generation</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>An implementation of AES (Advanced Encryption Standard), using SBV.
 For details on AES, see <a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">http://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a>.</p><p>We do a T-box implementation, which leads to good C code as we can take
 advantage of look-up tables. Note that we make virtually no attempt to
 optimize our Haskell code. The concern here is not with getting Haskell running
 fast at all. The idea is to program the T-Box implementation as naturally and clearly
 as possible in Haskell, and have SBV's code-generator generate fast C code automatically.
 Therefore, we merely use ordinary Haskell lists as our data-structures, and do not
 bother with any unboxing or strictness annotations. Thus, we achieve the separation
 of concerns: Correctness via clairty and simplicity and proofs on the Haskell side,
 performance by relying on SBV's code generator. If necessary, the generated code
 can be FFI'd back into Haskell to complete the loop.</p><p>All 3 valid key sizes (128, 192, and 256) as required by the FIPS-197 standard
 are supported.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:GF28">GF28</a> = <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 8</li><li class="src short"><a href="#v:gf28Mult">gf28Mult</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a></li><li class="src short"><a href="#v:gf28Pow">gf28Pow</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a></li><li class="src short"><a href="#v:gf28Inverse">gf28Inverse</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:State">State</a> = [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Key">Key</a> = [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><span class="keyword">type</span> <a href="#t:KS">KS</a> = (<a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>, [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>], <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>)</li><li class="src short"><a href="#v:rotR">rotR</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] -&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>]</li><li class="src short"><a href="#v:roundConstants">roundConstants</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>]</li><li class="src short"><a href="#v:invMixColumns">invMixColumns</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a></li><li class="src short"><a href="#v:keyExpansion">keyExpansion</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>]</li><li class="src short"><a href="#v:sboxTable">sboxTable</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>]</li><li class="src short"><a href="#v:sbox">sbox</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a></li><li class="src short"><a href="#v:unSBoxTable">unSBoxTable</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>]</li><li class="src short"><a href="#v:unSBox">unSBox</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a></li><li class="src short"><a href="#v:sboxInverseCorrect">sboxInverseCorrect</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Internals.html#t:SBool" title="Data.SBV.Internals">SBool</a></li><li class="src short"><a href="#v:addRoundKey">addRoundKey</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a></li><li class="src short"><a href="#v:t0Func">t0Func</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>]</li><li class="src short"><a href="#v:t0">t0</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:t1">t1</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:t2">t2</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:t3">t3</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:u0Func">u0Func</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>]</li><li class="src short"><a href="#v:u0">u0</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:u1">u1</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:u2">u2</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:u3">u3</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32</li><li class="src short"><a href="#v:doRounds">doRounds</a> :: (<a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a>) -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a></li><li class="src short"><a href="#v:aesRound">aesRound</a> :: <a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a></li><li class="src short"><a href="#v:aesInvRound">aesInvRound</a> :: <a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a></li><li class="src short"><a href="#v:aesKeySchedule">aesKeySchedule</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; (<a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a>, <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a>)</li><li class="src short"><a href="#v:aesEncrypt">aesEncrypt</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a> -&gt; [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:aesDecrypt">aesDecrypt</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a> -&gt; [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:t128Enc">t128Enc</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:t128Dec">t128Dec</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:t192Enc">t192Enc</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:t192Dec">t192Dec</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:t256Enc">t256Enc</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:t256Dec">t256Dec</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32]</li><li class="src short"><a href="#v:aes128IsCorrect">aes128IsCorrect</a> :: (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32) -&gt; (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32) -&gt; <a href="Data-SBV-Internals.html#t:SBool" title="Data.SBV.Internals">SBool</a></li><li class="src short"><a href="#v:cgAES128BlockEncrypt">cgAES128BlockEncrypt</a> :: <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:aesLibComponents">aesLibComponents</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; [(<a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a>, <a href="Data-SBV-Tools-CodeGen.html#t:SBVCodeGen" title="Data.SBV.Tools.CodeGen">SBVCodeGen</a> ())]</li><li class="src short"><a href="#v:cgAESLibrary">cgAESLibrary</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.13.0.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:cgAES128Library">cgAES128Library</a> :: <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:hex8">hex8</a> :: (<a href="Data-SBV-Internals.html#t:SymVal" title="Data.SBV.Internals">SymVal</a> a, <a href="../base-4.13.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.13.0.0/Prelude.html#t:Integral" title="Prelude">Integral</a> a) =&gt; <a href="Data-SBV-Internals.html#t:SBV" title="Data.SBV.Internals">SBV</a> a -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Formalizing GF(2^8)</h1></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:GF28" class="def">GF28</a> = <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 8 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#GF28" class="link">Source</a> <a href="#t:GF28" class="selflink">#</a></p><div class="doc"><p>An element of the Galois Field 2^8, which are essentially polynomials with
 maximum degree 7. They are conveniently represented as values between 0 and 255.</p></div></div><div class="top"><p class="src"><a id="v:gf28Mult" class="def">gf28Mult</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#gf28Mult" class="link">Source</a> <a href="#v:gf28Mult" class="selflink">#</a></p><div class="doc"><p>Multiplication in GF(2^8). This is simple polynomial multipliation, followed
 by the irreducible polynomial <code>x^8+x^4+x^3+x^1+1</code>. We simply use the <code><a href="Data-SBV-Tools-Polynomial.html#v:pMult" title="Data.SBV.Tools.Polynomial">pMult</a></code>
 function exported by SBV to do the operation. </p></div></div><div class="top"><p class="src"><a id="v:gf28Pow" class="def">gf28Pow</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#gf28Pow" class="link">Source</a> <a href="#v:gf28Pow" class="selflink">#</a></p><div class="doc"><p>Exponentiation by a constant in GF(2^8). The implementation uses the usual
 square-and-multiply trick to speed up the computation.</p></div></div><div class="top"><p class="src"><a id="v:gf28Inverse" class="def">gf28Inverse</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#gf28Inverse" class="link">Source</a> <a href="#v:gf28Inverse" class="selflink">#</a></p><div class="doc"><p>Computing inverses in GF(2^8). By the mathematical properties of GF(2^8)
 and the particular irreducible polynomial used <code>x^8+x^5+x^3+x^1+1</code>, it
 turns out that raising to the 254 power gives us the multiplicative inverse.
 Of course, we can prove this using SBV:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>prove $ \x -&gt; x ./= 0 .=&gt; x `gf28Mult` gf28Inverse x .== 1
</code></strong>Q.E.D.
</pre><p>Note that we exclude <code>0</code> in our theorem, as it does not have a
 multiplicative inverse.</p></div></div><a href="#g:2" id="g:2"><h1>Implementing AES</h1></a><a href="#g:3" id="g:3"><h2>Types and basic operations</h2></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:State" class="def">State</a> = [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#State" class="link">Source</a> <a href="#t:State" class="selflink">#</a></p><div class="doc"><p>AES state. The state consists of four 32-bit words, each of which is in turn treated
 as four GF28's, i.e., 4 bytes. The T-Box implementation keeps the four-bytes together
 for efficient representation.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Key" class="def">Key</a> = [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#Key" class="link">Source</a> <a href="#t:Key" class="selflink">#</a></p><div class="doc"><p>The key, which can be 128, 192, or 256 bits. Represented as a sequence of 32-bit words.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:KS" class="def">KS</a> = (<a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>, [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>], <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>) <a href="src/Documentation.SBV.Examples.Crypto.AES.html#KS" class="link">Source</a> <a href="#t:KS" class="selflink">#</a></p><div class="doc"><p>The key schedule. AES executes in rounds, and it treats first and last round keys slightly
 differently than the middle ones. We reflect that choice by being explicit about it in our type.
 The length of the middle list of keys depends on the key-size, which in turn determines
 the number of rounds.</p></div></div><div class="top"><p class="src"><a id="v:rotR" class="def">rotR</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] -&gt; <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#rotR" class="link">Source</a> <a href="#v:rotR" class="selflink">#</a></p><div class="doc"><p>Rotating a state row by a fixed amount to the right.</p></div></div><a href="#g:4" id="g:4"><h2>The key schedule</h2></a><div class="top"><p class="src"><a id="v:roundConstants" class="def">roundConstants</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#roundConstants" class="link">Source</a> <a href="#v:roundConstants" class="selflink">#</a></p><div class="doc"><p>Definition of round-constants, as specified in Section 5.2 of the AES standard.</p></div></div><div class="top"><p class="src"><a id="v:invMixColumns" class="def">invMixColumns</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#invMixColumns" class="link">Source</a> <a href="#v:invMixColumns" class="selflink">#</a></p><div class="doc"><p>The <code>InvMixColumns</code> transformation, as described in Section 5.3.3 of the standard. Note
 that this transformation is only used explicitly during key-expansion in the T-Box implementation
 of AES.</p></div></div><div class="top"><p class="src"><a id="v:keyExpansion" class="def">keyExpansion</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a>] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#keyExpansion" class="link">Source</a> <a href="#v:keyExpansion" class="selflink">#</a></p><div class="doc"><p>Key expansion. Starting with the given key, returns an infinite sequence of
 words, as described by the AES standard, Section 5.2, Figure 11.</p></div></div><a href="#g:5" id="g:5"><h2>The S-box transformation</h2></a><div class="top"><p class="src"><a id="v:sboxTable" class="def">sboxTable</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#sboxTable" class="link">Source</a> <a href="#v:sboxTable" class="selflink">#</a></p><div class="doc"><p>The values of the AES S-box table. Note that we describe the S-box programmatically
 using the mathematical construction given in Section 5.1.1 of the standard. However,
 the code-generation will turn this into a mere look-up table, as it is just a
 constant table, all computation being done at &quot;compile-time&quot;.</p></div></div><div class="top"><p class="src"><a id="v:sbox" class="def">sbox</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#sbox" class="link">Source</a> <a href="#v:sbox" class="selflink">#</a></p><div class="doc"><p>The sbox transformation. We simply select from the sbox table. Note that we
 are obliged to give a default value (here <code>0</code>) to be used if the index is out-of-bounds
 as required by SBV's <code><a href="Data-SBV-Trans.html#v:select" title="Data.SBV.Trans">select</a></code> function. However, that will never happen since
 the table has all 256 elements in it.</p></div></div><a href="#g:6" id="g:6"><h2>The inverse S-box transformation</h2></a><div class="top"><p class="src"><a id="v:unSBoxTable" class="def">unSBoxTable</a> :: [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#unSBoxTable" class="link">Source</a> <a href="#v:unSBoxTable" class="selflink">#</a></p><div class="doc"><p>The values of the inverse S-box table. Again, the construction is programmatic.</p></div></div><div class="top"><p class="src"><a id="v:unSBox" class="def">unSBox</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#unSBox" class="link">Source</a> <a href="#v:unSBox" class="selflink">#</a></p><div class="doc"><p>The inverse s-box transformation.</p></div></div><div class="top"><p class="src"><a id="v:sboxInverseCorrect" class="def">sboxInverseCorrect</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Internals.html#t:SBool" title="Data.SBV.Internals">SBool</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#sboxInverseCorrect" class="link">Source</a> <a href="#v:sboxInverseCorrect" class="selflink">#</a></p><div class="doc"><p>Prove that the <code><a href="Documentation-SBV-Examples-Crypto-AES.html#v:sbox" title="Documentation.SBV.Examples.Crypto.AES">sbox</a></code> and <code><a href="Documentation-SBV-Examples-Crypto-AES.html#v:unSBox" title="Documentation.SBV.Examples.Crypto.AES">unSBox</a></code> are inverses. We have:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>prove sboxInverseCorrect
</code></strong>Q.E.D.
</pre></div></div><a href="#g:7" id="g:7"><h2>AddRoundKey transformation</h2></a><div class="top"><p class="src"><a id="v:addRoundKey" class="def">addRoundKey</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#addRoundKey" class="link">Source</a> <a href="#v:addRoundKey" class="selflink">#</a></p><div class="doc"><p>Adding the round-key to the current state. We simply exploit the fact
 that addition is just xor in implementing this transformation.</p></div></div><a href="#g:8" id="g:8"><h2>Tables for T-Box encryption</h2></a><div class="top"><p class="src"><a id="v:t0Func" class="def">t0Func</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t0Func" class="link">Source</a> <a href="#v:t0Func" class="selflink">#</a></p><div class="doc"><p>T-box table generation function for encryption</p></div></div><div class="top"><p class="src"><a id="v:t0" class="def">t0</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t0" class="link">Source</a> <a href="#v:t0" class="selflink">#</a></p><div class="doc"><p>First look-up table used in encryption</p></div></div><div class="top"><p class="src"><a id="v:t1" class="def">t1</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t1" class="link">Source</a> <a href="#v:t1" class="selflink">#</a></p><div class="doc"><p>Second look-up table used in encryption</p></div></div><div class="top"><p class="src"><a id="v:t2" class="def">t2</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t2" class="link">Source</a> <a href="#v:t2" class="selflink">#</a></p><div class="doc"><p>Third look-up table used in encryption</p></div></div><div class="top"><p class="src"><a id="v:t3" class="def">t3</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t3" class="link">Source</a> <a href="#v:t3" class="selflink">#</a></p><div class="doc"><p>Fourth look-up table used in encryption</p></div></div><a href="#g:9" id="g:9"><h2>Tables for T-Box decryption</h2></a><div class="top"><p class="src"><a id="v:u0Func" class="def">u0Func</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a>] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#u0Func" class="link">Source</a> <a href="#v:u0Func" class="selflink">#</a></p><div class="doc"><p>T-box table generating function for decryption</p></div></div><div class="top"><p class="src"><a id="v:u0" class="def">u0</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#u0" class="link">Source</a> <a href="#v:u0" class="selflink">#</a></p><div class="doc"><p>First look-up table used in decryption</p></div></div><div class="top"><p class="src"><a id="v:u1" class="def">u1</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#u1" class="link">Source</a> <a href="#v:u1" class="selflink">#</a></p><div class="doc"><p>Second look-up table used in decryption</p></div></div><div class="top"><p class="src"><a id="v:u2" class="def">u2</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#u2" class="link">Source</a> <a href="#v:u2" class="selflink">#</a></p><div class="doc"><p>Third look-up table used in decryption</p></div></div><div class="top"><p class="src"><a id="v:u3" class="def">u3</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:GF28" title="Documentation.SBV.Examples.Crypto.AES">GF28</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32 <a href="src/Documentation.SBV.Examples.Crypto.AES.html#u3" class="link">Source</a> <a href="#v:u3" class="selflink">#</a></p><div class="doc"><p>Fourth look-up table used in decryption</p></div></div><a href="#g:10" id="g:10"><h2>AES rounds</h2></a><div class="top"><p class="src"><a id="v:doRounds" class="def">doRounds</a> :: (<a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a>) -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#doRounds" class="link">Source</a> <a href="#v:doRounds" class="selflink">#</a></p><div class="doc"><p>Generic round function. Given the function to perform one round, a key-schedule,
 and a starting state, it performs the AES rounds.</p></div></div><div class="top"><p class="src"><a id="v:aesRound" class="def">aesRound</a> :: <a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#aesRound" class="link">Source</a> <a href="#v:aesRound" class="selflink">#</a></p><div class="doc"><p>One encryption round. The first argument indicates whether this is the final round
 or not, in which case the construction is slightly different.</p></div></div><div class="top"><p class="src"><a id="v:aesInvRound" class="def">aesInvRound</a> :: <a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:State" title="Documentation.SBV.Examples.Crypto.AES">State</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#aesInvRound" class="link">Source</a> <a href="#v:aesInvRound" class="selflink">#</a></p><div class="doc"><p>One decryption round. Similar to the encryption round, the first argument
 indicates whether this is the final round or not.</p></div></div><a href="#g:11" id="g:11"><h1>AES API</h1></a><div class="top"><p class="src"><a id="v:aesKeySchedule" class="def">aesKeySchedule</a> :: <a href="Documentation-SBV-Examples-Crypto-AES.html#t:Key" title="Documentation.SBV.Examples.Crypto.AES">Key</a> -&gt; (<a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a>, <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a>) <a href="src/Documentation.SBV.Examples.Crypto.AES.html#aesKeySchedule" class="link">Source</a> <a href="#v:aesKeySchedule" class="selflink">#</a></p><div class="doc"><p>Key schedule. Given a 128, 192, or 256 bit key, expand it to get key-schedules
 for encryption and decryption. The key is given as a sequence of 32-bit words.
 (4 elements for 128-bits, 6 for 192, and 8 for 256.)</p></div></div><div class="top"><p class="src"><a id="v:aesEncrypt" class="def">aesEncrypt</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a> -&gt; [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#aesEncrypt" class="link">Source</a> <a href="#v:aesEncrypt" class="selflink">#</a></p><div class="doc"><p>Block encryption. The first argument is the plain-text, which must have
 precisely 4 elements, for a total of 128-bits of input. The second
 argument is the key-schedule to be used, obtained by a call to <code><a href="Documentation-SBV-Examples-Crypto-AES.html#v:aesKeySchedule" title="Documentation.SBV.Examples.Crypto.AES">aesKeySchedule</a></code>.
 The output will always have 4 32-bit words, which is the cipher-text.</p></div></div><div class="top"><p class="src"><a id="v:aesDecrypt" class="def">aesDecrypt</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] -&gt; <a href="Documentation-SBV-Examples-Crypto-AES.html#t:KS" title="Documentation.SBV.Examples.Crypto.AES">KS</a> -&gt; [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#aesDecrypt" class="link">Source</a> <a href="#v:aesDecrypt" class="selflink">#</a></p><div class="doc"><p>Block decryption. The arguments are the same as in <code><a href="Documentation-SBV-Examples-Crypto-AES.html#v:aesEncrypt" title="Documentation.SBV.Examples.Crypto.AES">aesEncrypt</a></code>, except
 the first argument is the cipher-text and the output is the corresponding
 plain-text.</p></div></div><a href="#g:12" id="g:12"><h1>Test vectors</h1></a><a href="#g:13" id="g:13"><h2>128-bit enc/dec test</h2></a><div class="top"><p class="src"><a id="v:t128Enc" class="def">t128Enc</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t128Enc" class="link">Source</a> <a href="#v:t128Enc" class="selflink">#</a></p><div class="doc"><p>128-bit encryption test, from Appendix C.1 of the AES standard:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map hex8 t128Enc
</code></strong>[&quot;69c4e0d8&quot;,&quot;6a7b0430&quot;,&quot;d8cdb780&quot;,&quot;70b4c55a&quot;]
</pre></div></div><div class="top"><p class="src"><a id="v:t128Dec" class="def">t128Dec</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t128Dec" class="link">Source</a> <a href="#v:t128Dec" class="selflink">#</a></p><div class="doc"><p>128-bit decryption test, from Appendix C.1 of the AES standard:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map hex8 t128Dec
</code></strong>[&quot;00112233&quot;,&quot;44556677&quot;,&quot;8899aabb&quot;,&quot;ccddeeff&quot;]
</pre></div></div><a href="#g:14" id="g:14"><h2>192-bit enc/dec test</h2></a><div class="top"><p class="src"><a id="v:t192Enc" class="def">t192Enc</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t192Enc" class="link">Source</a> <a href="#v:t192Enc" class="selflink">#</a></p><div class="doc"><p>192-bit encryption test, from Appendix C.2 of the AES standard:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map hex8 t192Enc
</code></strong>[&quot;dda97ca4&quot;,&quot;864cdfe0&quot;,&quot;6eaf70a0&quot;,&quot;ec0d7191&quot;]
</pre></div></div><div class="top"><p class="src"><a id="v:t192Dec" class="def">t192Dec</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t192Dec" class="link">Source</a> <a href="#v:t192Dec" class="selflink">#</a></p><div class="doc"><p>192-bit decryption test, from Appendix C.2 of the AES standard:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map hex8 t192Dec
</code></strong>[&quot;00112233&quot;,&quot;44556677&quot;,&quot;8899aabb&quot;,&quot;ccddeeff&quot;]
</pre></div></div><a href="#g:15" id="g:15"><h2>256-bit enc/dec test</h2></a><div class="top"><p class="src"><a id="v:t256Enc" class="def">t256Enc</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t256Enc" class="link">Source</a> <a href="#v:t256Enc" class="selflink">#</a></p><div class="doc"><p>256-bit encryption, from Appendix C.3 of the AES standard:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map hex8 t256Enc
</code></strong>[&quot;8ea2b7ca&quot;,&quot;516745bf&quot;,&quot;eafc4990&quot;,&quot;4b496089&quot;]
</pre></div></div><div class="top"><p class="src"><a id="v:t256Dec" class="def">t256Dec</a> :: [<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#t256Dec" class="link">Source</a> <a href="#v:t256Dec" class="selflink">#</a></p><div class="doc"><p>256-bit decryption, from Appendix C.3 of the AES standard:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map hex8 t256Dec
</code></strong>[&quot;00112233&quot;,&quot;44556677&quot;,&quot;8899aabb&quot;,&quot;ccddeeff&quot;]
</pre></div></div><a href="#g:16" id="g:16"><h1>Verification</h1></a><div class="doc empty">&nbsp;</div><div class="doc"><p>While SMT based technologies can prove correct many small properties fairly quickly, it would
  be naive for them to automatically verify that our AES implementation is correct. (By correct,
  we mean decryption follewed by encryption yielding the same result.) However, we can state
  this property precisely using SBV, and use quick-check to gain some confidence.</p></div><div class="top"><p class="src"><a id="v:aes128IsCorrect" class="def">aes128IsCorrect</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#aes128IsCorrect" class="link">Source</a> <a href="#v:aes128IsCorrect" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32)</td><td class="doc"><p>plain-text words</p></td></tr><tr><td class="src">-&gt; (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32, <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32)</td><td class="doc"><p>key-words</p></td></tr><tr><td class="src">-&gt; <a href="Data-SBV-Internals.html#t:SBool" title="Data.SBV.Internals">SBool</a></td><td class="doc"><p>True if round-trip gives us plain-text back</p></td></tr></table></div><div class="doc"><p>Correctness theorem for 128-bit AES. Ideally, we would run:</p><pre>  prove aes128IsCorrect
</pre><p>to get a proof automatically. Unfortunately, while SBV will successfully generate the proof
 obligation for this theorem and ship it to the SMT solver, it would be naive to expect the SMT-solver
 to finish that proof in any reasonable time with the currently available SMT solving technologies.
 Instead, we can issue:</p><pre>  quickCheck aes128IsCorrect
</pre><p>and get some degree of confidence in our code. Similar predicates can be easily constructed for 192, and
 256 bit cases as well.</p></div></div><a href="#g:17" id="g:17"><h1>Code generation</h1></a><div class="doc empty">&nbsp;</div><div class="doc"><p>We have emphasized that our T-Box implementation in Haskell was guided by clarity and correctness, not
   performance. Indeed, our implementation is hardly the fastest AES implementation in Haskell. However,
   we can use it to automatically generate straight-line C-code that can run fairly fast.</p><p>For the purposes of illustration, we only show here how to generate code for a 128-bit AES block-encrypt
   function, that takes 8 32-bit words as an argument. The first 4 are the 128-bit input, and the final
   four are the 128-bit key. The impact of this is that the generated function would expand the key for
   each block of encryption, a needless task unless we change the key in every block. In a more serios application,
   we would instead generate code for both the <code><a href="Documentation-SBV-Examples-Crypto-AES.html#v:aesKeySchedule" title="Documentation.SBV.Examples.Crypto.AES">aesKeySchedule</a></code> and the <code><a href="Documentation-SBV-Examples-Crypto-AES.html#v:aesEncrypt" title="Documentation.SBV.Examples.Crypto.AES">aesEncrypt</a></code> functions, thus reusing the
   key-schedule over many applications of the encryption call. (Unfortunately doing this is rather cumbersome right
   now, since Haskell does not support fixed-size lists.)</p></div><div class="top"><p class="src"><a id="v:cgAES128BlockEncrypt" class="def">cgAES128BlockEncrypt</a> :: <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Documentation.SBV.Examples.Crypto.AES.html#cgAES128BlockEncrypt" class="link">Source</a> <a href="#v:cgAES128BlockEncrypt" class="selflink">#</a></p><div class="doc"><p>Code generation for 128-bit AES encryption.</p><p>The following sample from the generated code-lines show how T-Boxes are rendered as C arrays:</p><pre>  static const SWord32 table1[] = {
      0xc66363a5UL, 0xf87c7c84UL, 0xee777799UL, 0xf67b7b8dUL,
      0xfff2f20dUL, 0xd66b6bbdUL, 0xde6f6fb1UL, 0x91c5c554UL,
      0x60303050UL, 0x02010103UL, 0xce6767a9UL, 0x562b2b7dUL,
      0xe7fefe19UL, 0xb5d7d762UL, 0x4dababe6UL, 0xec76769aUL,
      ...
      }
</pre><p>The generated program has 5 tables (one sbox table, and 4-Tboxes), all converted to fast C arrays. Here
 is a sample of the generated straightline C-code:</p><pre>  const SWord8  s1915 = (SWord8) s1912;
  const SWord8  s1916 = table0[s1915];
  const SWord16 s1917 = (((SWord16) s1914) &lt;&lt; 8) | ((SWord16) s1916);
  const SWord32 s1918 = (((SWord32) s1911) &lt;&lt; 16) | ((SWord32) s1917);
  const SWord32 s1919 = s1844 ^ s1918;
  const SWord32 s1920 = s1903 ^ s1919;
</pre><p>The GNU C-compiler does a fine job of optimizing this straightline code to generate a fairly efficient C implementation.</p></div></div><a href="#g:18" id="g:18"><h1>C-library generation</h1></a><div class="doc empty">&nbsp;</div><div class="doc"><p>The <code><a href="Documentation-SBV-Examples-Crypto-AES.html#v:cgAES128BlockEncrypt" title="Documentation.SBV.Examples.Crypto.AES">cgAES128BlockEncrypt</a></code> example shows how to generate code for 128-bit AES encryption. As the generated
   function performs encryption on a given block, it performs key expansion as necessary. However, this is
   not quite practical: We would like to expand the key only once, and encrypt the stream of plain-text blocks using
   the same expanded key (potentially using some crypto-mode), until we decide to change the key. In this
   section, we show how to use SBV to instead generate a library of functions that can be used in such a scenario.
   The generated library is a typical <code>.a</code> archive, that can be linked using the C-compiler as usual.</p></div><div class="top"><p class="src"><a id="v:aesLibComponents" class="def">aesLibComponents</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; [(<a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a>, <a href="Data-SBV-Tools-CodeGen.html#t:SBVCodeGen" title="Data.SBV.Tools.CodeGen">SBVCodeGen</a> ())] <a href="src/Documentation.SBV.Examples.Crypto.AES.html#aesLibComponents" class="link">Source</a> <a href="#v:aesLibComponents" class="selflink">#</a></p><div class="doc"><p>Components of the AES implementation that the library is generated from</p></div></div><div class="top"><p class="src"><a id="v:cgAESLibrary" class="def">cgAESLibrary</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.13.0.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.13.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Documentation.SBV.Examples.Crypto.AES.html#cgAESLibrary" class="link">Source</a> <a href="#v:cgAESLibrary" class="selflink">#</a></p><div class="doc"><p>Generate code for AES functionality; given the key size.</p></div></div><div class="top"><p class="src"><a id="v:cgAES128Library" class="def">cgAES128Library</a> :: <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Documentation.SBV.Examples.Crypto.AES.html#cgAES128Library" class="link">Source</a> <a href="#v:cgAES128Library" class="selflink">#</a></p><div class="doc"><p>Generate a C library, containing functions for performing 128-bit enc<em>dec</em>key-expansion.
 A note on performance: In a very rough speed test, the generated code was able to do
 6.3 million block encryptions per second on a decent MacBook Pro. On the same machine, OpenSSL
 reports 8.2 million block encryptions per second. So, the generated code is about 25% slower
 as compared to the highly optimized OpenSSL implementation. (Note that the speed test was done
 somewhat simplistically, so these numbers should be considered very rough estimates.)</p></div></div><div class="top"><p class="src"><a id="v:hex8" class="def">hex8</a> :: (<a href="Data-SBV-Internals.html#t:SymVal" title="Data.SBV.Internals">SymVal</a> a, <a href="../base-4.13.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.13.0.0/Prelude.html#t:Integral" title="Prelude">Integral</a> a) =&gt; <a href="Data-SBV-Internals.html#t:SBV" title="Data.SBV.Internals">SBV</a> a -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="src/Documentation.SBV.Examples.Crypto.AES.html#hex8" class="link">Source</a> <a href="#v:hex8" class="selflink">#</a></p><div class="doc"><p>For doctest purposes only</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>