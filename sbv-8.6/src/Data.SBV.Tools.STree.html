<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module    : Data.SBV.Tools.STree</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright : (c) Levent Erkok</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer: erkokl@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Implementation of full-binary symbolic trees, providing logarithmic</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- time access to elements. Both reads and writes are supported.</span><span>
</span><span id="line-11"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances   #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall -Werror #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.SBV.Tools.STree</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier">STree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier">readSTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#writeSTree"><span class="hs-identifier">writeSTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#mkSTree"><span class="hs-identifier">mkSTree</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html"><span class="hs-identifier">Data.SBV.Core.Data</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.Core.Model.html"><span class="hs-identifier">Data.SBV.Core.Model</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | A symbolic tree containing values of type e, indexed by</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- elements of type i. Note that these are full-trees, and their</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- their shapes remain constant. There is no API provided that</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- can change the shape of the tree. These structures are useful</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- when dealing with data-structures that are indexed with symbolic</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- values where access time is important. 'STree' structures provide</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- logarithmic time reads and writes.</span><span>
</span><span id="line-34"></span><span class="hs-keyword">type</span><span> </span><span id="STree"><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier hs-var">STree</span></a></span></span><span> </span><span id="local-6989586621681148907"><span class="annot"><a href="#local-6989586621681148907"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621681148906"><span class="annot"><a href="#local-6989586621681148906"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#STreeInternal"><span class="hs-identifier hs-type">STreeInternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148907"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148906"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- Internal representation, not exposed to the user</span><span>
</span><span id="line-37"></span><span class="hs-keyword">data</span><span> </span><span id="STreeInternal"><span class="annot"><a href="Data.SBV.Tools.STree.html#STreeInternal"><span class="hs-identifier hs-var">STreeInternal</span></a></span></span><span> </span><span id="local-6989586621681148944"><span class="annot"><a href="#local-6989586621681148944"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621681148945"><span class="annot"><a href="#local-6989586621681148945"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SLeaf"><span class="annot"><a href="Data.SBV.Tools.STree.html#SLeaf"><span class="hs-identifier hs-var">SLeaf</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621681148945"><span class="hs-identifier hs-type">e</span></a></span><span>                        </span><span class="hs-comment">-- NB. parameter 'i' is phantom</span><span>
</span><span id="line-38"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span id="SBin"><span class="annot"><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-var">SBin</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#STreeInternal"><span class="hs-identifier hs-type">STreeInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148944"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148945"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#STreeInternal"><span class="hs-identifier hs-type">STreeInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148944"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148945"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>                       </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681148898"><span id="local-6989586621681148900"><span id="local-6989586621681148902"><span class="annot"><span class="annottext">Int -&gt; STreeInternal i e -&gt; ShowS
[STreeInternal i e] -&gt; ShowS
STreeInternal i e -&gt; String
(Int -&gt; STreeInternal i e -&gt; ShowS)
-&gt; (STreeInternal i e -&gt; String)
-&gt; ([STreeInternal i e] -&gt; ShowS)
-&gt; Show (STreeInternal i e)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall i e. Show e =&gt; Int -&gt; STreeInternal i e -&gt; ShowS
forall i e. Show e =&gt; [STreeInternal i e] -&gt; ShowS
forall i e. Show e =&gt; STreeInternal i e -&gt; String
showList :: [STreeInternal i e] -&gt; ShowS
$cshowList :: forall i e. Show e =&gt; [STreeInternal i e] -&gt; ShowS
show :: STreeInternal i e -&gt; String
$cshow :: forall i e. Show e =&gt; STreeInternal i e -&gt; String
showsPrec :: Int -&gt; STreeInternal i e -&gt; ShowS
$cshowsPrec :: forall i e. Show e =&gt; Int -&gt; STreeInternal i e -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621681148895"><span id="local-6989586621681148896"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681148892"><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148896"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Model.html#Mergeable"><span class="hs-identifier hs-type">Mergeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier hs-type">STree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148895"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148896"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621681148890"><span class="annot"><span class="annottext">symbolicMerge :: Bool -&gt; SBool -&gt; STree i e -&gt; STree i e -&gt; STree i e
</span><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var hs-var hs-var hs-var">symbolicMerge</span></a></span></span><span> </span><span id="local-6989586621681148888"><span class="annot"><span class="annottext">f :: Bool
</span><a href="#local-6989586621681148888"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681148887"><span class="annot"><span class="annottext">b :: SBool
</span><a href="#local-6989586621681148887"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#SLeaf"><span class="hs-identifier hs-type">SLeaf</span></a></span><span> </span><span id="local-6989586621681148886"><span class="annot"><span class="annottext">i :: SBV e
</span><a href="#local-6989586621681148886"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#SLeaf"><span class="hs-identifier hs-type">SLeaf</span></a></span><span> </span><span id="local-6989586621681148885"><span class="annot"><span class="annottext">j :: SBV e
</span><a href="#local-6989586621681148885"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV e -&gt; STree i e
forall i e. e -&gt; STreeInternal i e
</span><a href="Data.SBV.Tools.STree.html#SLeaf"><span class="hs-identifier hs-var">SLeaf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; SBool -&gt; SBV e -&gt; SBV e -&gt; SBV e
forall a. Mergeable a =&gt; Bool -&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var">symbolicMerge</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681148888"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681148887"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">SBV e
</span><a href="#local-6989586621681148886"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SBV e
</span><a href="#local-6989586621681148885"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var">symbolicMerge</span></a></span><span> </span><span id="local-6989586621681148884"><span class="annot"><span class="annottext">f :: Bool
</span><a href="#local-6989586621681148884"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681148883"><span class="annot"><span class="annottext">b :: SBool
</span><a href="#local-6989586621681148883"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-type">SBin</span></a></span><span> </span><span id="local-6989586621681148882"><span class="annot"><span class="annottext">l :: STree i e
</span><a href="#local-6989586621681148882"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681148881"><span class="annot"><span class="annottext">r :: STree i e
</span><a href="#local-6989586621681148881"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-type">SBin</span></a></span><span> </span><span id="local-6989586621681148880"><span class="annot"><span class="annottext">l' :: STree i e
</span><a href="#local-6989586621681148880"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span id="local-6989586621681148879"><span class="annot"><span class="annottext">r' :: STree i e
</span><a href="#local-6989586621681148879"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STree i e -&gt; STree i e -&gt; STree i e
forall i e.
STreeInternal i e -&gt; STreeInternal i e -&gt; STreeInternal i e
</span><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-var">SBin</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; SBool -&gt; STree i e -&gt; STree i e -&gt; STree i e
forall a. Mergeable a =&gt; Bool -&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var">symbolicMerge</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681148884"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681148883"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">STree i e
</span><a href="#local-6989586621681148882"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">STree i e
</span><a href="#local-6989586621681148880"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; SBool -&gt; STree i e -&gt; STree i e -&gt; STree i e
forall a. Mergeable a =&gt; Bool -&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var">symbolicMerge</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681148884"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681148883"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">STree i e
</span><a href="#local-6989586621681148881"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">STree i e
</span><a href="#local-6989586621681148879"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var">symbolicMerge</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; STree i e
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SBV.STree.symbolicMerge: Impossible happened while merging states&quot;</span></span></span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Reading a value. We bit-blast the index and descend down the full tree</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- according to bit-values.</span><span>
</span><span id="line-48"></span><span id="local-6989586621681148876"><span id="local-6989586621681148877"><span class="annot"><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-type">readSTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Model.html#SFiniteBits"><span class="hs-identifier hs-type">SFiniteBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148877"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148876"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier hs-type">STree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148877"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148876"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148877"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148876"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-49"></span><span id="readSTree"><span class="annot"><span class="annottext">readSTree :: STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var hs-var">readSTree</span></a></span></span><span> </span><span id="local-6989586621681148875"><span class="annot"><span class="annottext">s :: STree i e
</span><a href="#local-6989586621681148875"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681148874"><span class="annot"><span class="annottext">i :: SBV i
</span><a href="#local-6989586621681148874"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBool] -&gt; STree i e -&gt; SBV e
forall p i. Mergeable p =&gt; [SBool] -&gt; STreeInternal i p -&gt; p
</span><a href="#local-6989586621681148873"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV i -&gt; [SBool]
forall a. SFiniteBits a =&gt; SBV a -&gt; [SBool]
</span><a href="Data.SBV.Core.Model.html#blastBE"><span class="hs-identifier hs-var">blastBE</span></a></span><span> </span><span class="annot"><span class="annottext">SBV i
</span><a href="#local-6989586621681148874"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">STree i e
</span><a href="#local-6989586621681148875"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681148873"><span class="annot"><span class="annottext">walk :: [SBool] -&gt; STreeInternal i p -&gt; p
</span><a href="#local-6989586621681148873"><span class="hs-identifier hs-var hs-var">walk</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#SLeaf"><span class="hs-identifier hs-type">SLeaf</span></a></span><span> </span><span id="local-6989586621681148871"><span class="annot"><span class="annottext">v :: p
</span><a href="#local-6989586621681148871"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681148871"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="#local-6989586621681148873"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681148870"><span class="annot"><span class="annottext">b :: SBool
</span><a href="#local-6989586621681148870"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681148869"><span class="annot"><span class="annottext">bs :: [SBool]
</span><a href="#local-6989586621681148869"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-type">SBin</span></a></span><span> </span><span id="local-6989586621681148868"><span class="annot"><span class="annottext">l :: STreeInternal i p
</span><a href="#local-6989586621681148868"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681148867"><span class="annot"><span class="annottext">r :: STreeInternal i p
</span><a href="#local-6989586621681148867"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; p -&gt; p -&gt; p
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681148870"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SBool] -&gt; STreeInternal i p -&gt; p
</span><a href="#local-6989586621681148873"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="annot"><span class="annottext">[SBool]
</span><a href="#local-6989586621681148869"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">STreeInternal i p
</span><a href="#local-6989586621681148867"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SBool] -&gt; STreeInternal i p -&gt; p
</span><a href="#local-6989586621681148873"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="annot"><span class="annottext">[SBool]
</span><a href="#local-6989586621681148869"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">STreeInternal i p
</span><a href="#local-6989586621681148868"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="#local-6989586621681148873"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; p
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; p) -&gt; String -&gt; p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SBV.STree.readSTree: Impossible happened while reading: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SBV i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SBV i
</span><a href="#local-6989586621681148874"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Writing a value, similar to how reads are done. The important thing is that the tree</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- representation keeps updates to a minimum.</span><span>
</span><span id="line-56"></span><span id="local-6989586621681148863"><span id="local-6989586621681148864"><span class="annot"><a href="Data.SBV.Tools.STree.html#writeSTree"><span class="hs-identifier hs-type">writeSTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Model.html#SFiniteBits"><span class="hs-identifier hs-type">SFiniteBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148864"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148863"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier hs-type">STree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148864"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148863"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148864"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148863"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier hs-type">STree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148864"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148863"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-57"></span><span id="writeSTree"><span class="annot"><span class="annottext">writeSTree :: STree i e -&gt; SBV i -&gt; SBV e -&gt; STree i e
</span><a href="Data.SBV.Tools.STree.html#writeSTree"><span class="hs-identifier hs-var hs-var">writeSTree</span></a></span></span><span> </span><span id="local-6989586621681148862"><span class="annot"><span class="annottext">s :: STree i e
</span><a href="#local-6989586621681148862"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681148861"><span class="annot"><span class="annottext">i :: SBV i
</span><a href="#local-6989586621681148861"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681148860"><span class="annot"><span class="annottext">j :: SBV e
</span><a href="#local-6989586621681148860"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBool] -&gt; STree i e -&gt; STree i e
forall i.
Mergeable (STreeInternal i (SBV e)) =&gt;
[SBool] -&gt; STreeInternal i (SBV e) -&gt; STreeInternal i (SBV e)
</span><a href="#local-6989586621681148859"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV i -&gt; [SBool]
forall a. SFiniteBits a =&gt; SBV a -&gt; [SBool]
</span><a href="Data.SBV.Core.Model.html#blastBE"><span class="hs-identifier hs-var">blastBE</span></a></span><span> </span><span class="annot"><span class="annottext">SBV i
</span><a href="#local-6989586621681148861"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">STree i e
</span><a href="#local-6989586621681148862"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681148859"><span class="annot"><span class="annottext">walk :: [SBool] -&gt; STreeInternal i (SBV e) -&gt; STreeInternal i (SBV e)
</span><a href="#local-6989586621681148859"><span class="hs-identifier hs-var hs-var">walk</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV e -&gt; STreeInternal i (SBV e)
forall i e. e -&gt; STreeInternal i e
</span><a href="Data.SBV.Tools.STree.html#SLeaf"><span class="hs-identifier hs-var">SLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">SBV e
</span><a href="#local-6989586621681148860"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><a href="#local-6989586621681148859"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681148858"><span class="annot"><span class="annottext">b :: SBool
</span><a href="#local-6989586621681148858"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681148857"><span class="annot"><span class="annottext">bs :: [SBool]
</span><a href="#local-6989586621681148857"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-type">SBin</span></a></span><span> </span><span id="local-6989586621681148856"><span class="annot"><span class="annottext">l :: STreeInternal i (SBV e)
</span><a href="#local-6989586621681148856"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681148855"><span class="annot"><span class="annottext">r :: STreeInternal i (SBV e)
</span><a href="#local-6989586621681148855"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STreeInternal i (SBV e)
-&gt; STreeInternal i (SBV e) -&gt; STreeInternal i (SBV e)
forall i e.
STreeInternal i e -&gt; STreeInternal i e -&gt; STreeInternal i e
</span><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-var">SBin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBool
-&gt; STreeInternal i (SBV e)
-&gt; STreeInternal i (SBV e)
-&gt; STreeInternal i (SBV e)
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681148858"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">STreeInternal i (SBV e)
</span><a href="#local-6989586621681148856"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SBool] -&gt; STreeInternal i (SBV e) -&gt; STreeInternal i (SBV e)
</span><a href="#local-6989586621681148859"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="annot"><span class="annottext">[SBool]
</span><a href="#local-6989586621681148857"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">STreeInternal i (SBV e)
</span><a href="#local-6989586621681148856"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBool
-&gt; STreeInternal i (SBV e)
-&gt; STreeInternal i (SBV e)
-&gt; STreeInternal i (SBV e)
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681148858"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SBool] -&gt; STreeInternal i (SBV e) -&gt; STreeInternal i (SBV e)
</span><a href="#local-6989586621681148859"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="annot"><span class="annottext">[SBool]
</span><a href="#local-6989586621681148857"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">STreeInternal i (SBV e)
</span><a href="#local-6989586621681148855"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">STreeInternal i (SBV e)
</span><a href="#local-6989586621681148855"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><a href="#local-6989586621681148859"><span class="hs-identifier hs-var">walk</span></a></span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; STreeInternal i (SBV e)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; STreeInternal i (SBV e))
-&gt; String -&gt; STreeInternal i (SBV e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SBV.STree.writeSTree: Impossible happened while reading: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SBV i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SBV i
</span><a href="#local-6989586621681148861"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Construct the fully balanced initial tree using the given values.</span><span>
</span><span id="line-63"></span><span class="annot"><a href="Data.SBV.Tools.STree.html#mkSTree"><span class="hs-identifier hs-type">mkSTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681148854"><span class="annot"><a href="#local-6989586621681148854"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621681148853"><span class="annot"><a href="#local-6989586621681148853"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148854"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148853"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier hs-type">STree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148854"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681148853"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-64"></span><span id="mkSTree"><span class="annot"><span class="annottext">mkSTree :: [SBV e] -&gt; STree i e
</span><a href="Data.SBV.Tools.STree.html#mkSTree"><span class="hs-identifier hs-var hs-var">mkSTree</span></a></span></span><span> </span><span id="local-6989586621681148852"><span class="annot"><span class="annottext">ivals :: [SBV e]
</span><a href="#local-6989586621681148852"><span class="hs-identifier hs-var">ivals</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Proxy i -&gt; Bool
forall a. HasKind a =&gt; a -&gt; Bool
</span><a href="Data.SBV.Core.Kind.html#isReal"><span class="hs-identifier hs-var">isReal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy i
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681148854"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; STree i e
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SBV.STree.mkSTree: Cannot build a real-valued sized tree&quot;</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy i -&gt; Bool
forall a. HasKind a =&gt; a -&gt; Bool
</span><a href="Data.SBV.Core.Kind.html#isBounded"><span class="hs-identifier hs-var">isBounded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy i
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681148854"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; STree i e
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SBV.STree.mkSTree: Cannot build an infinitely large tree&quot;</span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681148847"><span class="hs-identifier hs-var">reqd</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681148845"><span class="hs-identifier hs-var">given</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; STree i e
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; STree i e) -&gt; String -&gt; STree i e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SBV.STree.mkSTree: Required &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681148847"><span class="hs-identifier hs-var">reqd</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; elements, received: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681148845"><span class="hs-identifier hs-var">given</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBV e] -&gt; STree i e
forall e i. [e] -&gt; STreeInternal i e
</span><a href="#local-6989586621681148844"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV e]
</span><a href="#local-6989586621681148852"><span class="hs-identifier hs-var">ivals</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681148847"><span class="annot"><span class="annottext">reqd :: Int
</span><a href="#local-6989586621681148847"><span class="hs-identifier hs-var hs-var">reqd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Proxy i -&gt; Int
forall a. HasKind a =&gt; a -&gt; Int
</span><a href="Data.SBV.Core.Kind.html#intSizeOf"><span class="hs-identifier hs-var">intSizeOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy i
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681148854"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>        </span><span id="local-6989586621681148845"><span class="annot"><span class="annottext">given :: Int
</span><a href="#local-6989586621681148845"><span class="hs-identifier hs-var hs-var">given</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBV e] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[SBV e]
</span><a href="#local-6989586621681148852"><span class="hs-identifier hs-var">ivals</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span id="local-6989586621681148844"><span class="annot"><span class="annottext">go :: [e] -&gt; STreeInternal i e
</span><a href="#local-6989586621681148844"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; STreeInternal i e
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SBV.STree.mkSTree: Impossible happened, ran out of elements&quot;</span></span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><a href="#local-6989586621681148844"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681148840"><span class="annot"><span class="annottext">l :: e
</span><a href="#local-6989586621681148840"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; STreeInternal i e
forall i e. e -&gt; STreeInternal i e
</span><a href="Data.SBV.Tools.STree.html#SLeaf"><span class="hs-identifier hs-var">SLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621681148840"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><a href="#local-6989586621681148844"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681148839"><span class="annot"><span class="annottext">ns :: [e]
</span><a href="#local-6989586621681148839"><span class="hs-identifier hs-var">ns</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681148838"><span class="annot"><span class="annottext">l :: [e]
</span><a href="#local-6989586621681148838"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681148837"><span class="annot"><span class="annottext">r :: [e]
</span><a href="#local-6989586621681148837"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [e] -&gt; ([e], [e])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[e] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621681148839"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621681148839"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">STreeInternal i e -&gt; STreeInternal i e -&gt; STreeInternal i e
forall i e.
STreeInternal i e -&gt; STreeInternal i e -&gt; STreeInternal i e
</span><a href="Data.SBV.Tools.STree.html#SBin"><span class="hs-identifier hs-var">SBin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[e] -&gt; STreeInternal i e
</span><a href="#local-6989586621681148844"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621681148838"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[e] -&gt; STreeInternal i e
</span><a href="#local-6989586621681148844"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621681148837"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span></pre></body></html>