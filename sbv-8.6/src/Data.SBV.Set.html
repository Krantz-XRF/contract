<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module    : Data.SBV.Set</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright : (c) Levent Erkok</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer: erkokl@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- A collection of set utilities, useful when working with symbolic sets.</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- To the extent possible, the functions in this module follow those</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- of &quot;Data.Set&quot; so importing qualified is the recommended workflow.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Note that unlike &quot;Data.Set&quot;, SBV sets can be infinite, represented</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- as a complement of some finite set. This means that a symbolic set</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- is either finite, or its complement is finite. (If the underlying</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- domain is finite, then obviously both the set itself and its complement</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- will always be finite.) Therefore, there are some differences in the API</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- from Haskell sets. For instance, you can take the complement of any set,</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- which is something you cannot do in Haskell! Conversely, you cannot compute</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- the size of a symbolic set (as it can be infinite!), nor you can turn</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- it into a list or necessarily enumerate its elements.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- __A note on cardinality__: You can indirectly talk about cardinality: 'Data.SBV.Set.hasSize'</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- can be used to state that the set is finite and has size @k@ for a user-specified symbolic</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- integer @k@.</span><span>
</span><span id="line-26"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types          #-}</span><span>
</span><span id="line-29"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-30"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall -Werror #-}</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.SBV.Set</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Constructing sets</span></span><span>
</span><span id="line-36"></span><span>          </span><span class="annot"><a href="Data.SBV.Set.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#full"><span class="hs-identifier">full</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#universal"><span class="hs-identifier">universal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#singleton"><span class="hs-identifier">singleton</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#fromList"><span class="hs-identifier">fromList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#complement"><span class="hs-identifier">complement</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Equality of sets</span></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><span class="hs-comment">-- $setEquality</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Insertion and deletion</span></span><span>
</span><span id="line-42"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#insert"><span class="hs-identifier">insert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#delete"><span class="hs-identifier">delete</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Query</span></span><span>
</span><span id="line-45"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#member"><span class="hs-identifier">member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#notMember"><span class="hs-identifier">notMember</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#null"><span class="hs-identifier">null</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#isFull"><span class="hs-identifier">isFull</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#isUniversal"><span class="hs-identifier">isUniversal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#hasSize"><span class="hs-identifier">hasSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#isSubsetOf"><span class="hs-identifier">isSubsetOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#isProperSubsetOf"><span class="hs-identifier">isProperSubsetOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#disjoint"><span class="hs-identifier">disjoint</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Combinations</span></span><span>
</span><span id="line-48"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#union"><span class="hs-identifier">union</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#unions"><span class="hs-identifier">unions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#intersection"><span class="hs-identifier">intersection</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#intersections"><span class="hs-identifier">intersections</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#difference"><span class="hs-identifier">difference</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html"><span class="hs-identifier">Data.SBV.Core.Data</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.Core.Model.html"><span class="hs-identifier">Data.SBV.Core.Model</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator">(.==)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Model.html#.%2F%3D"><span class="hs-operator">(./=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.Core.Symbolic.html"><span class="hs-identifier">Data.SBV.Core.Symbolic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier">SetOp</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- For doctest use only</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.SBV.Core.Model</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.SBV.Provers.Prover</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XScopedTypeVariables</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Empty set.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- &gt;&gt;&gt; empty :: SSet Integer</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- {} :: {SInteger}</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Data.SBV.Set.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150067"><span class="annot"><a href="#local-6989586621681150067"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150067"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-73"></span><span id="empty"><span class="annot"><span class="annottext">empty :: SSet a
</span><a href="Data.SBV.Set.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150064"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CV -&gt; Either CV (Cached SV)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(CV -&gt; Either CV (Cached SV)) -&gt; CV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CVal -&gt; CV
</span><a href="Data.SBV.Core.Concrete.html#CV"><span class="hs-identifier hs-var">CV</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150064"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(CVal -&gt; CV) -&gt; CVal -&gt; CV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RCSet CVal -&gt; CVal
</span><a href="Data.SBV.Core.Concrete.html#CSet"><span class="hs-identifier hs-var">CSet</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet CVal -&gt; CVal) -&gt; RCSet CVal -&gt; CVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set CVal -&gt; RCSet CVal
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">Set CVal
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681150064"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681150064"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#KSet"><span class="hs-identifier hs-var">KSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681150067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Full set.</span><span>
</span><span id="line-77"></span><span class="hs-comment">--</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &gt;&gt;&gt; full :: SSet Integer</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- U :: {SInteger}</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- Note that the universal set over a type is represented by the letter @U@.</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Data.SBV.Set.html#full"><span class="hs-identifier hs-type">full</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150149"><span class="annot"><a href="#local-6989586621681150149"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150149"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150149"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-83"></span><span id="full"><span class="annot"><span class="annottext">full :: SSet a
</span><a href="Data.SBV.Set.html#full"><span class="hs-identifier hs-var hs-var">full</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150057"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CV -&gt; Either CV (Cached SV)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(CV -&gt; Either CV (Cached SV)) -&gt; CV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; CVal -&gt; CV
</span><a href="Data.SBV.Core.Concrete.html#CV"><span class="hs-identifier hs-var">CV</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150057"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(CVal -&gt; CV) -&gt; CVal -&gt; CV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RCSet CVal -&gt; CVal
</span><a href="Data.SBV.Core.Concrete.html#CSet"><span class="hs-identifier hs-var">CSet</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet CVal -&gt; CVal) -&gt; RCSet CVal -&gt; CVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set CVal -&gt; RCSet CVal
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-var">ComplementSet</span></a></span><span> </span><span class="annot"><span class="annottext">Set CVal
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681150057"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681150057"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#KSet"><span class="hs-identifier hs-var">KSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681150149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Synonym for 'full'.</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Data.SBV.Set.html#universal"><span class="hs-identifier hs-type">universal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150055"><span class="annot"><a href="#local-6989586621681150055"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150055"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-88"></span><span id="universal"><span class="annot"><span class="annottext">universal :: SSet a
</span><a href="Data.SBV.Set.html#universal"><span class="hs-identifier hs-var hs-var">universal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a
forall a. HasKind a =&gt; SSet a
</span><a href="Data.SBV.Set.html#full"><span class="hs-identifier hs-var">full</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Singleton list.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt;&gt;&gt; singleton 2 :: SSet Integer</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- {2} :: {SInteger}</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Data.SBV.Set.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150054"><span class="annot"><a href="#local-6989586621681150054"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150054"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-95"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: SBV a -&gt; SSet a
</span><a href="Data.SBV.Set.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV a -&gt; SSet a -&gt; SSet a
forall a. (Ord a, SymVal a) =&gt; SBV a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#insert"><span class="hs-operator hs-var">`insert`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SSet a
forall a. HasKind a =&gt; SSet a
</span><a href="Data.SBV.Set.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | Conversion from a list.</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt;&gt;&gt; fromList ([] :: [Integer])</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- {} :: {SInteger}</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt;&gt;&gt; fromList [1,2,3]</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- {1,2,3} :: {SInteger}</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt;&gt;&gt; fromList [5,5,5,12,12,3]</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- {3,5,12} :: {SInteger}</span><span>
</span><span id="line-105"></span><span class="annot"><a href="Data.SBV.Set.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150053"><span class="annot"><a href="#local-6989586621681150053"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150053"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150053"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681150053"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150053"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-106"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: [a] -&gt; SSet a
</span><a href="Data.SBV.Set.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; ([a] -&gt; RCSet a) -&gt; [a] -&gt; SSet a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; ([a] -&gt; Set a) -&gt; [a] -&gt; RCSet a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Set a
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Complement.</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;&gt;&gt; empty .== complement (full :: SSet Integer)</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Complementing twice gets us back the original set:</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(s :: SSet Integer) -&gt; complement (complement s) .== s</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-117"></span><span class="annot"><a href="Data.SBV.Set.html#complement"><span class="hs-identifier hs-type">complement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150049"><span class="annot"><a href="#local-6989586621681150049"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150049"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150049"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150049"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-118"></span><span id="complement"><span class="annot"><span class="annottext">complement :: SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#complement"><span class="hs-identifier hs-var hs-var">complement</span></a></span></span><span> </span><span id="local-6989586621681150048"><span class="annot"><span class="annottext">ss :: SSet a
</span><a href="#local-6989586621681150048"><span class="hs-identifier hs-var">ss</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681150047"><span class="annot"><span class="annottext">rs :: Set a
</span><a href="#local-6989586621681150047"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150048"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-var">ComplementSet</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150047"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681150045"><span class="annot"><span class="annottext">cs :: Set a
</span><a href="#local-6989586621681150045"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150048"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150045"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150044"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681150042"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681150044"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681150044"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#KSet"><span class="hs-identifier hs-var">KSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681150049"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621681150042"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681150042"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681150041"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681150041"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681150040"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150040"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150041"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150048"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-128"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150041"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150044"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetComplement"><span class="hs-identifier hs-var">SetComplement</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150040"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Insert an element into a set.</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- Insertion is order independent:</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x y (s :: SSet Integer) -&gt; x `insert` (y `insert` s) .== y `insert` (x `insert` s)</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- Deletion after insertion is not necessarily identity:</span><span>
</span><span id="line-138"></span><span class="hs-comment">--</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `delete` (x `insert` s) .== s</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- Falsifiable. Counter-example:</span><span>
</span><span id="line-141"></span><span class="hs-comment">--   s0 =   0 :: Integer</span><span>
</span><span id="line-142"></span><span class="hs-comment">--   s1 = {0} :: {Integer}</span><span>
</span><span id="line-143"></span><span class="hs-comment">--</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- But the above is true if the element isn't in the set to start with:</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `notMember` s .=&gt; x `delete` (x `insert` s) .== s</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- Insertion into a full set does nothing:</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; insert x full .== (full :: SSet Integer)</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Data.SBV.Set.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150147"><span class="annot"><a href="#local-6989586621681150147"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150147"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150147"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150147"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150147"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150147"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-154"></span><span id="insert"><span class="annot"><span class="annottext">insert :: SBV a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621681150034"><span class="annot"><span class="annottext">se :: SBV a
</span><a href="#local-6989586621681150034"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span id="local-6989586621681150033"><span class="annot"><span class="annottext">ss :: SSet a
</span><a href="#local-6989586621681150033"><span class="hs-identifier hs-var">ss</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- Case 1: Constant regular set, just add it:</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681150032"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621681150032"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150034"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681150031"><span class="annot"><span class="annottext">rs :: Set a
</span><a href="#local-6989586621681150031"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150033"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681150032"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.insert`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150031"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-comment">-- Case 2: Constant complement set, with element in the complement, just remove it:</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681150029"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621681150029"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150034"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681150028"><span class="annot"><span class="annottext">cs :: Set a
</span><a href="#local-6989586621681150028"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150033"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681150029"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150028"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-var">ComplementSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681150029"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.delete`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150028"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150025"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681150024"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681150023"><span class="annot"><span class="annottext">ka :: Kind
</span><a href="#local-6989586621681150023"><span class="hs-identifier hs-var hs-var">ka</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681150147"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span id="local-6989586621681150025"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681150025"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#KSet"><span class="hs-identifier hs-var">KSet</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150023"><span class="hs-identifier hs-var">ka</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>        </span><span id="local-6989586621681150024"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681150024"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681150022"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681150022"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681150021"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150021"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150022"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150033"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-170"></span><span>                  </span><span id="local-6989586621681150020"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150020"><span class="hs-identifier hs-var">sve</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SBV a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150022"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150034"><span class="hs-identifier hs-var">se</span></a></span><span>
</span><span id="line-171"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150022"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150025"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetInsert"><span class="hs-identifier hs-var">SetInsert</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150020"><span class="hs-identifier hs-var">sve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150021"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Delete an element from a set.</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- Deletion is order independent:</span><span>
</span><span id="line-176"></span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x y (s :: SSet Integer) -&gt; x `delete` (y `delete` s) .== y `delete` (x `delete` s)</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- Insertion after deletion is not necessarily identity:</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `insert` (x `delete` s) .== s</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- Falsifiable. Counter-example:</span><span>
</span><span id="line-184"></span><span class="hs-comment">--   s0 =  0 :: Integer</span><span>
</span><span id="line-185"></span><span class="hs-comment">--   s1 = {} :: {Integer}</span><span>
</span><span id="line-186"></span><span class="hs-comment">--</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- But the above is true if the element is in the set to start with:</span><span>
</span><span id="line-188"></span><span class="hs-comment">--</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `member` s .=&gt; x `insert` (x `delete` s) .== s</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-191"></span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- Deletion from an empty set does nothing:</span><span>
</span><span id="line-193"></span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; delete x empty .== (empty :: SSet Integer)</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Data.SBV.Set.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681150018"><span class="annot"><a href="#local-6989586621681150018"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150018"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-197"></span><span id="delete"><span class="annot"><span class="annottext">delete :: SBV a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span id="local-6989586621681150017"><span class="annot"><span class="annottext">se :: SBV a
</span><a href="#local-6989586621681150017"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span id="local-6989586621681150016"><span class="annot"><span class="annottext">ss :: SSet a
</span><a href="#local-6989586621681150016"><span class="hs-identifier hs-var">ss</span></a></span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-comment">-- Case 1: Constant regular set, just remove it:</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681150015"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621681150015"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150017"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681150014"><span class="annot"><span class="annottext">rs :: Set a
</span><a href="#local-6989586621681150014"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150016"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681150015"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.delete`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150014"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">-- Case 2: Constant complement set, with element missing in the complement, just add it:</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681150013"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621681150013"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150017"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681150012"><span class="annot"><span class="annottext">cs :: Set a
</span><a href="#local-6989586621681150012"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150016"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681150013"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150012"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-var">ComplementSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681150013"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.insert`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150012"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150010"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681150009"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681150008"><span class="annot"><span class="annottext">ka :: Kind
</span><a href="#local-6989586621681150008"><span class="hs-identifier hs-var hs-var">ka</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681150018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621681150010"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681150010"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#KSet"><span class="hs-identifier hs-var">KSet</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150008"><span class="hs-identifier hs-var">ka</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621681150009"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681150009"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681150007"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681150007"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681150006"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150006"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150007"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150016"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-213"></span><span>                  </span><span id="local-6989586621681150005"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150005"><span class="hs-identifier hs-var">sve</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SBV a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150007"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150017"><span class="hs-identifier hs-var">se</span></a></span><span>
</span><span id="line-214"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681150007"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681150010"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetDelete"><span class="hs-identifier hs-var">SetDelete</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150005"><span class="hs-identifier hs-var">sve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681150006"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Test for membership.</span><span>
</span><span id="line-217"></span><span class="hs-comment">--</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; x `member` singleton (x :: SInteger)</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-220"></span><span class="hs-comment">--</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `member` (x `insert` s)</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; x `member` (full :: SSet Integer)</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-226"></span><span id="local-6989586621681150125"><span class="annot"><a href="Data.SBV.Set.html#member"><span class="hs-identifier hs-type">member</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150125"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150125"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-227"></span><span id="member"><span class="annot"><span class="annottext">member :: SBV a -&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#member"><span class="hs-identifier hs-var hs-var">member</span></a></span></span><span> </span><span id="local-6989586621681150003"><span class="annot"><span class="annottext">se :: SBV a
</span><a href="#local-6989586621681150003"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span id="local-6989586621681150002"><span class="annot"><span class="annottext">ss :: SSet a
</span><a href="#local-6989586621681150002"><span class="hs-identifier hs-var">ss</span></a></span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-comment">-- Case 1: Constant regular set, just check:</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681150001"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621681150001"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150003"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681150000"><span class="annot"><span class="annottext">rs :: Set a
</span><a href="#local-6989586621681150000"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150002"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SBool
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; SBool) -&gt; Bool -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681150001"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681150000"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-comment">-- Case 2: Constant complement set, check for non-member</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681149999"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621681149999"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150003"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681149998"><span class="annot"><span class="annottext">cs :: Set a
</span><a href="#local-6989586621681149998"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150002"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SBool
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; SBool) -&gt; Bool -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681149999"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149998"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SBool
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SBool) -&gt; SVal -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.SBV.Core.Kind.html#KBool"><span class="hs-identifier hs-var">KBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681149996"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681149996"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681149996"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681149995"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681149995"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681149994"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149994"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149995"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681150002"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-240"></span><span>                  </span><span id="local-6989586621681149993"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149993"><span class="hs-identifier hs-var">sve</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SBV a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149995"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681150003"><span class="hs-identifier hs-var">se</span></a></span><span>
</span><span id="line-241"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149995"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.SBV.Core.Kind.html#KBool"><span class="hs-identifier hs-var">KBool</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetMember"><span class="hs-identifier hs-var">SetMember</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149993"><span class="hs-identifier hs-var">sve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149994"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Test for non-membership.</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; x `notMember` observe &quot;set&quot; (singleton (x :: SInteger))</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- Falsifiable. Counter-example:</span><span>
</span><span id="line-247"></span><span class="hs-comment">--   set = {0} :: {Integer}</span><span>
</span><span id="line-248"></span><span class="hs-comment">--   s0  =   0 :: Integer</span><span>
</span><span id="line-249"></span><span class="hs-comment">--</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `notMember` (x `delete` s)</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-252"></span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; x `notMember` (empty :: SSet Integer)</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-255"></span><span id="local-6989586621681149991"><span class="annot"><a href="Data.SBV.Set.html#notMember"><span class="hs-identifier hs-type">notMember</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149991"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-256"></span><span id="notMember"><span class="annot"><span class="annottext">notMember :: SBV a -&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#notMember"><span class="hs-identifier hs-var hs-var">notMember</span></a></span></span><span> </span><span id="local-6989586621681149990"><span class="annot"><span class="annottext">se :: SBV a
</span><a href="#local-6989586621681149990"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span id="local-6989586621681149989"><span class="annot"><span class="annottext">ss :: SSet a
</span><a href="#local-6989586621681149989"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#sNot"><span class="hs-identifier hs-var">sNot</span></a></span><span> </span><span class="annot"><span class="annottext">(SBool -&gt; SBool) -&gt; SBool -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; SSet a -&gt; SBool
forall a. (Ord a, SymVal a) =&gt; SBV a -&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#member"><span class="hs-identifier hs-var">member</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681149990"><span class="hs-identifier hs-var">se</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149989"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Is this the empty set?</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- &gt;&gt;&gt; null (empty :: SSet Integer)</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-262"></span><span class="hs-comment">--</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; null (x `delete` singleton (x :: SInteger))</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ null (full :: SSet Integer)</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- Falsifiable</span><span>
</span><span id="line-268"></span><span class="hs-comment">--</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- Note how we have to call `Data.SBV.prove` in the last case since dealing</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- with infinite sets requires a call to the solver and cannot be</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- constant folded.</span><span>
</span><span id="line-272"></span><span id="local-6989586621681150120"><span class="annot"><a href="Data.SBV.Set.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150120"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150120"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-273"></span><span id="null"><span class="annot"><span class="annottext">null :: SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#null"><span class="hs-identifier hs-var hs-var">null</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
forall a. HasKind a =&gt; SSet a
</span><a href="Data.SBV.Set.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Synonym for 'Data.SBV.Set.null'.</span><span>
</span><span id="line-276"></span><span id="local-6989586621681149987"><span class="annot"><a href="Data.SBV.Set.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149987"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149987"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-277"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SBool
forall a. HasKind a =&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#null"><span class="hs-identifier hs-var">null</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Is this the full set?</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ isFull (empty :: SSet Integer)</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- Falsifiable</span><span>
</span><span id="line-283"></span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x -&gt; isFull (observe &quot;set&quot; (x `delete` (full :: SSet Integer)))</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- Falsifiable. Counter-example:</span><span>
</span><span id="line-286"></span><span class="hs-comment">--   set = U - {0} :: {Integer}</span><span>
</span><span id="line-287"></span><span class="hs-comment">--   s0  =       0 :: Integer</span><span>
</span><span id="line-288"></span><span class="hs-comment">--</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- &gt;&gt;&gt; isFull (full :: SSet Integer)</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-291"></span><span class="hs-comment">--</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- Note how we have to call `Data.SBV.prove` in the first case since dealing</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- with infinite sets requires a call to the solver and cannot be</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- constant folded.</span><span>
</span><span id="line-295"></span><span id="local-6989586621681149986"><span class="annot"><a href="Data.SBV.Set.html#isFull"><span class="hs-identifier hs-type">isFull</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-296"></span><span id="isFull"><span class="annot"><span class="annottext">isFull :: SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#isFull"><span class="hs-identifier hs-var hs-var">isFull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
forall a. HasKind a =&gt; SSet a
</span><a href="Data.SBV.Set.html#full"><span class="hs-identifier hs-var">full</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Synonym for 'Data.SBV.Set.isFull'.</span><span>
</span><span id="line-299"></span><span id="local-6989586621681149985"><span class="annot"><a href="Data.SBV.Set.html#isUniversal"><span class="hs-identifier hs-type">isUniversal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Kind.html#HasKind"><span class="hs-identifier hs-type">HasKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-300"></span><span id="isUniversal"><span class="annot"><span class="annottext">isUniversal :: SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#isUniversal"><span class="hs-identifier hs-var hs-var">isUniversal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SBool
forall a. HasKind a =&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#isFull"><span class="hs-identifier hs-var">isFull</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | Does the set have the given size? It implicitly asserts that the set</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- it is operating on is finite. Also see 'Data.SBV.Set.card'.</span><span>
</span><span id="line-304"></span><span class="hs-comment">--</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \i -&gt; hasSize (empty :: SSet Integer) i .== (i .== 0)</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- &gt;&gt;&gt; sat $ \i -&gt; hasSize (full :: SSet Integer) i</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- Unsatisfiable</span><span>
</span><span id="line-310"></span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \a b i j k -&gt; hasSize (a :: SSet Integer) i .&amp;&amp; hasSize (b :: SSet Integer) j .&amp;&amp; hasSize (a `union` b) k .=&gt; k .&gt;= i `smax` j</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \a b i j k -&gt; hasSize (a :: SSet Integer) i .&amp;&amp; hasSize (b :: SSet Integer) j .&amp;&amp; hasSize (a `intersection` b) k .=&gt; k .&lt;= i `smin` j</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \a k -&gt; hasSize (a :: SSet Integer) k .=&gt; k .&gt;= 0</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-319"></span><span id="local-6989586621681149984"><span class="annot"><a href="Data.SBV.Set.html#hasSize"><span class="hs-identifier hs-type">hasSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149984"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149984"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149984"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SInteger"><span class="hs-identifier hs-type">SInteger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-320"></span><span id="hasSize"><span class="annot"><span class="annottext">hasSize :: SSet a -&gt; SInteger -&gt; SBool
</span><a href="Data.SBV.Set.html#hasSize"><span class="hs-identifier hs-var hs-var">hasSize</span></a></span></span><span> </span><span id="local-6989586621681149983"><span class="annot"><span class="annottext">sa :: SSet a
</span><a href="#local-6989586621681149983"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621681149982"><span class="annot"><span class="annottext">si :: SInteger
</span><a href="#local-6989586621681149982"><span class="hs-identifier hs-var">si</span></a></span></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-comment">-- Case 1: Constant regular set, see if the size matches</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149981"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149981"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149983"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SInteger
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149981"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SInteger -&gt; SInteger -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SInteger
</span><a href="#local-6989586621681149982"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-comment">-- Case 2: Constant complement set, will never have finite size</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149983"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="Data.SBV.Core.Data.html#sFalse"><span class="hs-identifier hs-var">sFalse</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-comment">-- Case 3: Integer is constant, and is negative:</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681149978"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621681149978"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SInteger -&gt; Maybe Integer
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SInteger
</span><a href="#local-6989586621681149982"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681149978"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="Data.SBV.Core.Data.html#sFalse"><span class="hs-identifier hs-var">sFalse</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SBool
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SBool) -&gt; SVal -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.SBV.Core.Kind.html#KBool"><span class="hs-identifier hs-var">KBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681149976"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681149976"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681149976"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681149975"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681149975"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681149974"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149974"><span class="hs-identifier hs-var">sva</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149975"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149983"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-337"></span><span>                  </span><span id="local-6989586621681149973"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149973"><span class="hs-identifier hs-var">svi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SInteger -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149975"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SInteger
</span><a href="#local-6989586621681149982"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-338"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149975"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.SBV.Core.Kind.html#KBool"><span class="hs-identifier hs-var">KBool</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetHasSize"><span class="hs-identifier hs-var">SetHasSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149974"><span class="hs-identifier hs-var">sva</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149973"><span class="hs-identifier hs-var">svi</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Subset test.</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ empty `isSubsetOf` (full :: SSet Integer)</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-344"></span><span class="hs-comment">--</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; s `isSubsetOf` (x `insert` s)</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-347"></span><span class="hs-comment">--</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; (x `delete` s) `isSubsetOf` s</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-350"></span><span id="local-6989586621681150108"><span class="annot"><a href="Data.SBV.Set.html#isSubsetOf"><span class="hs-identifier hs-type">isSubsetOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-351"></span><span id="isSubsetOf"><span class="annot"><span class="annottext">isSubsetOf :: SSet a -&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#isSubsetOf"><span class="hs-identifier hs-var hs-var">isSubsetOf</span></a></span></span><span> </span><span id="local-6989586621681149971"><span class="annot"><span class="annottext">sa :: SSet a
</span><a href="#local-6989586621681149971"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621681149970"><span class="annot"><span class="annottext">sb :: SSet a
</span><a href="#local-6989586621681149970"><span class="hs-identifier hs-var">sb</span></a></span></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-comment">-- Case 1: Constant regular sets, just check:</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149969"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149969"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149971"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149968"><span class="annot"><span class="annottext">b :: Set a
</span><a href="#local-6989586621681149968"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149970"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SBool
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; SBool) -&gt; Bool -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149969"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.isSubsetOf`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149968"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-comment">-- Case 2: Constant complement sets, check in the reverse direction:</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681149966"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149966"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149971"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681149965"><span class="annot"><span class="annottext">b :: Set a
</span><a href="#local-6989586621681149965"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149970"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SBool
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; SBool) -&gt; Bool -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149965"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.isSubsetOf`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149966"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SBool
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SBool) -&gt; SVal -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.SBV.Core.Kind.html#KBool"><span class="hs-identifier hs-var">KBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681149964"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681149964"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681149964"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681149963"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681149963"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681149962"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149962"><span class="hs-identifier hs-var">sva</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149963"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149971"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-364"></span><span>                  </span><span id="local-6989586621681149961"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149961"><span class="hs-identifier hs-var">svb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149963"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149970"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-365"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149963"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.SBV.Core.Kind.html#KBool"><span class="hs-identifier hs-var">KBool</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetSubset"><span class="hs-identifier hs-var">SetSubset</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149962"><span class="hs-identifier hs-var">sva</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149961"><span class="hs-identifier hs-var">svb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Proper subset test.</span><span>
</span><span id="line-368"></span><span class="hs-comment">--</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ empty `isProperSubsetOf` (full :: SSet Integer)</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-371"></span><span class="hs-comment">--</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; s `isProperSubsetOf` (x `insert` s)</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- Falsifiable. Counter-example:</span><span>
</span><span id="line-374"></span><span class="hs-comment">--   s0 = 0 :: Integer</span><span>
</span><span id="line-375"></span><span class="hs-comment">--   s1 = U :: {Integer}</span><span>
</span><span id="line-376"></span><span class="hs-comment">--</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `notMember` s .=&gt; s `isProperSubsetOf` (x `insert` s)</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-379"></span><span class="hs-comment">--</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; (x `delete` s) `isProperSubsetOf` s</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- Falsifiable. Counter-example:</span><span>
</span><span id="line-382"></span><span class="hs-comment">--   s0 =         0 :: Integer</span><span>
</span><span id="line-383"></span><span class="hs-comment">--   s1 = U - {0,1} :: {Integer}</span><span>
</span><span id="line-384"></span><span class="hs-comment">--</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \x (s :: SSet Integer) -&gt; x `member` s .=&gt; (x `delete` s) `isProperSubsetOf` s</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-387"></span><span id="local-6989586621681149959"><span class="annot"><a href="Data.SBV.Set.html#isProperSubsetOf"><span class="hs-identifier hs-type">isProperSubsetOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149959"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149959"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149959"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149959"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-388"></span><span id="isProperSubsetOf"><span class="annot"><span class="annottext">isProperSubsetOf :: SSet a -&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#isProperSubsetOf"><span class="hs-identifier hs-var hs-var">isProperSubsetOf</span></a></span></span><span> </span><span id="local-6989586621681149958"><span class="annot"><span class="annottext">a :: SSet a
</span><a href="#local-6989586621681149958"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681149957"><span class="annot"><span class="annottext">b :: SSet a
</span><a href="#local-6989586621681149957"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149958"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SBool
forall a. (Ord a, SymVal a) =&gt; SSet a -&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#isSubsetOf"><span class="hs-operator hs-var">`isSubsetOf`</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149957"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%26%26"><span class="hs-operator hs-var">.&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149958"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%2F%3D"><span class="hs-operator hs-var">./=</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149957"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- | Disjoint test.</span><span>
</span><span id="line-391"></span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- &gt;&gt;&gt; disjoint (fromList [2,4,6])   (fromList [1,3])</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- &gt;&gt;&gt; disjoint (fromList [2,4,6,8]) (fromList [2,3,5,7])</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- &gt;&gt;&gt; disjoint (fromList [1,2])     (fromList [1,2,3,4])</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(s :: SSet Integer) -&gt; s `disjoint` complement s</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- &gt;&gt;&gt; allSat $ \(s :: SSet Integer) -&gt; s `disjoint` s</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- Solution #1:</span><span>
</span><span id="line-402"></span><span class="hs-comment">--   s0 = {} :: {Integer}</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- This is the only solution.</span><span>
</span><span id="line-404"></span><span class="hs-comment">--</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- The last example is particularly interesting: The empty set is the</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- only set where `disjoint` is not reflexive!</span><span>
</span><span id="line-407"></span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- Note that disjointness of a set from its complement is guaranteed</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- by the fact that all types are inhabited; an implicit assumption</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- we have in classic logic which is also enjoyed by Haskell due to</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- the presence of bottom!</span><span>
</span><span id="line-412"></span><span id="local-6989586621681149955"><span class="annot"><a href="Data.SBV.Set.html#disjoint"><span class="hs-identifier hs-type">disjoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span></span><span>
</span><span id="line-413"></span><span id="disjoint"><span class="annot"><span class="annottext">disjoint :: SSet a -&gt; SSet a -&gt; SBool
</span><a href="Data.SBV.Set.html#disjoint"><span class="hs-identifier hs-var hs-var">disjoint</span></a></span></span><span> </span><span id="local-6989586621681149954"><span class="annot"><span class="annottext">a :: SSet a
</span><a href="#local-6989586621681149954"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681149953"><span class="annot"><span class="annottext">b :: SSet a
</span><a href="#local-6989586621681149953"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149954"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SSet a
forall a. (Ord a, SymVal a) =&gt; SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#intersection"><span class="hs-operator hs-var">`intersection`</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149953"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
forall a. HasKind a =&gt; SSet a
</span><a href="Data.SBV.Set.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | Union.</span><span>
</span><span id="line-416"></span><span class="hs-comment">--</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- &gt;&gt;&gt; union (fromList [1..10]) (fromList [5..15]) .== (fromList [1..15] :: SSet Integer)</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) b -&gt; a `union` b .== b `union` a</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) b c -&gt; a `union` (b `union` c) .== (a `union` b) `union` c</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `union` full .== full</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `union` empty .== a</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `union` complement a .== full</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-429"></span><span id="local-6989586621681149952"><span class="annot"><a href="Data.SBV.Set.html#union"><span class="hs-identifier hs-type">union</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149952"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149952"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149952"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149952"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149952"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-430"></span><span id="union"><span class="annot"><span class="annottext">union :: SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#union"><span class="hs-identifier hs-var hs-var">union</span></a></span></span><span> </span><span id="local-6989586621681149951"><span class="annot"><span class="annottext">sa :: SSet a
</span><a href="#local-6989586621681149951"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621681149950"><span class="annot"><span class="annottext">sb :: SSet a
</span><a href="#local-6989586621681149950"><span class="hs-identifier hs-var">sb</span></a></span></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-comment">-- Case 1: Constant regular sets, just compute</span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149949"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149949"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149951"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149948"><span class="annot"><span class="annottext">b :: Set a
</span><a href="#local-6989586621681149948"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149950"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149949"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.union`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149948"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-comment">-- Case 2: Constant complement sets, complement the intersection:</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681149946"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149946"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149951"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681149945"><span class="annot"><span class="annottext">b :: Set a
</span><a href="#local-6989586621681149945"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149950"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-var">ComplementSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149946"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.intersection`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149945"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681149943"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681149942"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681149943"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681149943"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149951"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-443"></span><span>        </span><span id="local-6989586621681149942"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681149942"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681149941"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681149941"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681149940"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149940"><span class="hs-identifier hs-var">sva</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149941"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149951"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-444"></span><span>                  </span><span id="local-6989586621681149939"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149939"><span class="hs-identifier hs-var">svb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149941"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149950"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-445"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149941"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681149943"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetUnion"><span class="hs-identifier hs-var">SetUnion</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149940"><span class="hs-identifier hs-var">sva</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149939"><span class="hs-identifier hs-var">svb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- | Unions. Equivalent to @'foldr' 'union' 'empty'@.</span><span>
</span><span id="line-448"></span><span class="hs-comment">--</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ unions [] .== (empty :: SSet Integer)</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-451"></span><span id="local-6989586621681149937"><span class="annot"><a href="Data.SBV.Set.html#unions"><span class="hs-identifier hs-type">unions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149937"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149937"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149937"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149937"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-452"></span><span id="unions"><span class="annot"><span class="annottext">unions :: [SSet a] -&gt; SSet a
</span><a href="Data.SBV.Set.html#unions"><span class="hs-identifier hs-var hs-var">unions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SSet a -&gt; SSet a -&gt; SSet a) -&gt; SSet a -&gt; [SSet a] -&gt; SSet a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SSet a
forall a. (Ord a, SymVal a) =&gt; SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#union"><span class="hs-identifier hs-var">union</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
forall a. HasKind a =&gt; SSet a
</span><a href="Data.SBV.Set.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- | Intersection.</span><span>
</span><span id="line-455"></span><span class="hs-comment">--</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- &gt;&gt;&gt; intersection (fromList [1..10]) (fromList [5..15]) .== (fromList [5..10] :: SSet Integer)</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) b -&gt; a `intersection` b .== b `intersection` a</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) b c -&gt; a `intersection` (b `intersection` c) .== (a `intersection` b) `intersection` c</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `intersection` full .== a</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `intersection` empty .== empty</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `intersection` complement a .== empty</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) b -&gt; a `disjoint` b .=&gt; a `intersection` b .== empty</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-470"></span><span id="local-6989586621681150106"><span class="annot"><a href="Data.SBV.Set.html#intersection"><span class="hs-identifier hs-type">intersection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681150106"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150106"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150106"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150106"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681150106"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-471"></span><span id="intersection"><span class="annot"><span class="annottext">intersection :: SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#intersection"><span class="hs-identifier hs-var hs-var">intersection</span></a></span></span><span> </span><span id="local-6989586621681149935"><span class="annot"><span class="annottext">sa :: SSet a
</span><a href="#local-6989586621681149935"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621681149934"><span class="annot"><span class="annottext">sb :: SSet a
</span><a href="#local-6989586621681149934"><span class="hs-identifier hs-var">sb</span></a></span></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-comment">-- Case 1: Constant regular sets, just compute</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149933"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149933"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149935"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149932"><span class="annot"><span class="annottext">b :: Set a
</span><a href="#local-6989586621681149932"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149934"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149933"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.intersection`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149932"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-comment">-- Case 2: Constant complement sets, complement the union:</span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681149931"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149931"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149935"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-type">ComplementSet</span></a></span><span> </span><span id="local-6989586621681149930"><span class="annot"><span class="annottext">b :: Set a
</span><a href="#local-6989586621681149930"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149934"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#ComplementSet"><span class="hs-identifier hs-var">ComplementSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149931"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.union`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149930"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681149929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681149928"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681149929"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681149929"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149935"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-484"></span><span>        </span><span id="local-6989586621681149928"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681149928"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681149927"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681149927"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681149926"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149926"><span class="hs-identifier hs-var">sva</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149927"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149935"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-485"></span><span>                  </span><span id="local-6989586621681149925"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149925"><span class="hs-identifier hs-var">svb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149927"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149934"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-486"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149927"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681149929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetIntersect"><span class="hs-identifier hs-var">SetIntersect</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149926"><span class="hs-identifier hs-var">sva</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149925"><span class="hs-identifier hs-var">svb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- | Intersections. Equivalent to @'foldr' 'intersection' 'full'@. Note that</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- Haskell's 'Data.Set' does not support this operation as it does not have a</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- way of representing universal sets.</span><span>
</span><span id="line-491"></span><span class="hs-comment">--</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ intersections [] .== (full :: SSet Integer)</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-494"></span><span id="local-6989586621681149923"><span class="annot"><a href="Data.SBV.Set.html#intersections"><span class="hs-identifier hs-type">intersections</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149923"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-495"></span><span id="intersections"><span class="annot"><span class="annottext">intersections :: [SSet a] -&gt; SSet a
</span><a href="Data.SBV.Set.html#intersections"><span class="hs-identifier hs-var hs-var">intersections</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SSet a -&gt; SSet a -&gt; SSet a) -&gt; SSet a -&gt; [SSet a] -&gt; SSet a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SSet a
forall a. (Ord a, SymVal a) =&gt; SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#intersection"><span class="hs-identifier hs-var">intersection</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
forall a. HasKind a =&gt; SSet a
</span><a href="Data.SBV.Set.html#full"><span class="hs-identifier hs-var">full</span></a></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">-- | Difference.</span><span>
</span><span id="line-498"></span><span class="hs-comment">--</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; empty `difference` a .== empty</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `difference` empty .== a</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; full `difference` a .== complement a</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- &gt;&gt;&gt; prove $ \(a :: SSet Integer) -&gt; a `difference` a .== empty</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- Q.E.D.</span><span>
</span><span id="line-507"></span><span id="local-6989586621681149922"><span class="annot"><a href="Data.SBV.Set.html#difference"><span class="hs-identifier hs-type">difference</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149922"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149922"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149922"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149922"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149922"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-508"></span><span id="difference"><span class="annot"><span class="annottext">difference :: SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#difference"><span class="hs-identifier hs-var hs-var">difference</span></a></span></span><span> </span><span id="local-6989586621681149921"><span class="annot"><span class="annottext">sa :: SSet a
</span><a href="#local-6989586621681149921"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621681149920"><span class="annot"><span class="annottext">sb :: SSet a
</span><a href="#local-6989586621681149920"><span class="hs-identifier hs-var">sb</span></a></span></span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-comment">-- Only constant fold the regular case, others are left symbolic</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149919"><span class="annot"><span class="annottext">a :: Set a
</span><a href="#local-6989586621681149919"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149921"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-type">RegularSet</span></a></span><span> </span><span id="local-6989586621681149918"><span class="annot"><span class="annottext">b :: Set a
</span><a href="#local-6989586621681149918"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Maybe (RCSet a)
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149920"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RCSet a -&gt; SSet a
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(RCSet a -&gt; SSet a) -&gt; RCSet a -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; RCSet a
forall a. Set a -&gt; RCSet a
</span><a href="Data.SBV.Core.Concrete.html#RegularSet"><span class="hs-identifier hs-var">RegularSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; RCSet a) -&gt; Set a -&gt; RCSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149919"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.difference`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621681149918"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-comment">-- Otherwise, go symbolic</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVal -&gt; SSet a
forall a. SVal -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-var">SBV</span></a></span><span> </span><span class="annot"><span class="annottext">(SVal -&gt; SSet a) -&gt; SVal -&gt; SSet a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Either CV (Cached SV) -&gt; SVal
</span><a href="Data.SBV.Core.Symbolic.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681149916"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CV (Cached SV) -&gt; SVal) -&gt; Either CV (Cached SV) -&gt; SVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cached SV -&gt; Either CV (Cached SV)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Cached SV -&gt; Either CV (Cached SV))
-&gt; Cached SV -&gt; Either CV (Cached SV)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; IO SV) -&gt; Cached SV
forall a. (State -&gt; IO a) -&gt; Cached a
</span><a href="Data.SBV.Core.Symbolic.html#cache"><span class="hs-identifier hs-var">cache</span></a></span><span> </span><span class="annot"><span class="annottext">State -&gt; IO SV
</span><a href="#local-6989586621681149915"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681149916"><span class="annot"><span class="annottext">k :: Kind
</span><a href="#local-6989586621681149916"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149921"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-517"></span><span>        </span><span id="local-6989586621681149915"><span class="annot"><span class="annottext">r :: State -&gt; IO SV
</span><a href="#local-6989586621681149915"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681149914"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621681149914"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681149913"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149913"><span class="hs-identifier hs-var">sva</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149914"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149921"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-518"></span><span>                  </span><span id="local-6989586621681149912"><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149912"><span class="hs-identifier hs-var">svb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; SSet a -&gt; IO SV
forall a. State -&gt; SBV a -&gt; IO SV
</span><a href="Data.SBV.Core.Data.html#sbvToSV"><span class="hs-identifier hs-var">sbvToSV</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149914"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SSet a
</span><a href="#local-6989586621681149920"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-519"></span><span>                  </span><span class="annot"><span class="annottext">State -&gt; Kind -&gt; SBVExpr -&gt; IO SV
</span><a href="Data.SBV.Core.Symbolic.html#newExpr"><span class="hs-identifier hs-var">newExpr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621681149914"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681149916"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(SBVExpr -&gt; IO SV) -&gt; SBVExpr -&gt; IO SV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Op -&gt; [SV] -&gt; SBVExpr
</span><a href="Data.SBV.Core.Symbolic.html#SBVApp"><span class="hs-identifier hs-var">SBVApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetOp -&gt; Op
</span><a href="Data.SBV.Core.Symbolic.html#SetOp"><span class="hs-identifier hs-var">SetOp</span></a></span><span> </span><span class="annot"><span class="annottext">SetOp
</span><a href="Data.SBV.Core.Symbolic.html#SetDifference"><span class="hs-identifier hs-var">SetDifference</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149913"><span class="hs-identifier hs-var">sva</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SV
</span><a href="#local-6989586621681149912"><span class="hs-identifier hs-var">svb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="hs-comment">-- | Synonym for 'Data.SBV.Set.difference'.</span><span>
</span><span id="line-522"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="Data.SBV.Set.html#%5C%5C"><span class="hs-operator hs-type">\\</span></a></span><span>
</span><span id="line-523"></span><span id="local-6989586621681149910"><span class="annot"><a href="Data.SBV.Set.html#%5C%5C"><span class="hs-operator hs-type">(\\)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681149910"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149910"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149910"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149910"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681149910"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-524"></span><span id="%5C%5C"><span class="annot"><span class="annottext">\\ :: SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#%5C%5C"><span class="hs-operator hs-var hs-var">(\\)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SSet a -&gt; SSet a -&gt; SSet a
forall a. (Ord a, SymVal a) =&gt; SSet a -&gt; SSet a -&gt; SSet a
</span><a href="Data.SBV.Set.html#difference"><span class="hs-identifier hs-var">difference</span></a></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="hs-comment">{- $setEquality
We can compare sets for equality:

&gt;&gt;&gt; empty .== (empty :: SSet Integer)
True
&gt;&gt;&gt; full .== (full :: SSet Integer)
True
&gt;&gt;&gt; full ./= (full :: SSet Integer)
False
&gt;&gt;&gt; sat $ \(x::SSet (Maybe Integer)) y z -&gt; distinct [x, y, z]
Satisfiable. Model:
  s0 = U - {Just 0} :: {Maybe Integer}
  s1 =           {} :: {Maybe Integer}
  s2 =            U :: {Maybe Integer}

However, if we compare two sets that are constructed as regular or in the complement
form, we have to use a proof to establish equality:

&gt;&gt;&gt; prove $ full .== (empty :: SSet Integer)
Falsifiable

The reason for this is that there is no way in Haskell to compare an infinite
set to any other set, as infinite sets are not representable at all! So, we have
to delay the judgment to the SMT solver. If you try to constant fold, you
will get:

&gt;&gt;&gt; full .== (empty :: SSet Integer)
&lt;symbolic&gt; :: SBool

indicating that the result is a symbolic value that needs a decision
procedure to be determined!
-}</span><span>
</span><span id="line-558"></span></pre></body></html>