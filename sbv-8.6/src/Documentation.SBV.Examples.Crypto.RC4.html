<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module    : Documentation.SBV.Examples.Crypto.RC4</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright : (c) Austin Seipp</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer: erkokl@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- An implementation of RC4 (AKA Rivest Cipher 4 or Alleged RC4/ARC4),</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- using SBV. For information on RC4, see: &lt;http://en.wikipedia.org/wiki/RC4&gt;.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- We make no effort to optimize the code, and instead focus on a clear</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- implementation. In fact, the RC4 algorithm relies on in-place update of</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- its state heavily for efficiency, and is therefore unsuitable for a purely</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- functional implementation.</span><span>
</span><span id="line-16"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall -Werror #-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Documentation.SBV.Examples.Crypto.RC4</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">chr</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">genericIndex</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.html"><span class="hs-identifier">Data.SBV</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html"><span class="hs-identifier">Data.SBV.Tools.STree</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showHex</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- * Types</span><span>
</span><span id="line-35"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | RC4 State contains 256 8-bit values. We use the symbolically accessible</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- full-binary type 'STree' to represent the state, since RC4 needs</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- access to the array via a symbolic index and it's important to minimize access time.</span><span>
</span><span id="line-40"></span><span class="hs-keyword">type</span><span> </span><span id="S"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-var">S</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SBV.Tools.STree.html#STree"><span class="hs-identifier hs-type">STree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | Construct the fully balanced initial tree, where the leaves are simply the numbers @0@ through @255@.</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#initS"><span class="hs-identifier hs-type">initS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-type">S</span></a></span><span>
</span><span id="line-44"></span><span id="initS"><span class="annot"><span class="annottext">initS :: S
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#initS"><span class="hs-identifier hs-var hs-var">initS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBV Word8] -&gt; S
forall i e. HasKind i =&gt; [SBV e] -&gt; STree i e
</span><a href="Data.SBV.Tools.STree.html#mkSTree"><span class="hs-identifier hs-var">mkSTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; SBV Word8) -&gt; [Word8] -&gt; [SBV Word8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; SBV Word8
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">255</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | The key is a stream of 'Word8' values.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Represents the current state of the RC4 stream: it is the @S@ array</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- along with the @i@ and @j@ index values used by the PRGA.</span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="RC4"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#RC4"><span class="hs-identifier hs-var">RC4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- * The PRGA</span><span>
</span><span id="line-55"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Swaps two elements in the RC4 array.</span><span>
</span><span id="line-58"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#swap"><span class="hs-identifier hs-type">swap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-type">S</span></a></span><span>
</span><span id="line-59"></span><span id="swap"><span class="annot"><span class="annottext">swap :: SBV Word8 -&gt; SBV Word8 -&gt; S -&gt; S
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#swap"><span class="hs-identifier hs-var hs-var">swap</span></a></span></span><span> </span><span id="local-6989586621681161041"><span class="annot"><span class="annottext">i :: SBV Word8
</span><a href="#local-6989586621681161041"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681161040"><span class="annot"><span class="annottext">j :: SBV Word8
</span><a href="#local-6989586621681161040"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621681161039"><span class="annot"><span class="annottext">st :: S
</span><a href="#local-6989586621681161039"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8 -&gt; S
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e -&gt; STree i e
</span><a href="Data.SBV.Tools.STree.html#writeSTree"><span class="hs-identifier hs-var">writeSTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8 -&gt; S
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e -&gt; STree i e
</span><a href="Data.SBV.Tools.STree.html#writeSTree"><span class="hs-identifier hs-var">writeSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161039"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161041"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161037"><span class="hs-identifier hs-var">stj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161040"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161036"><span class="hs-identifier hs-var">sti</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681161036"><span class="annot"><span class="annottext">sti :: SBV Word8
</span><a href="#local-6989586621681161036"><span class="hs-identifier hs-var hs-var">sti</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var">readSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161039"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161041"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-61"></span><span>        </span><span id="local-6989586621681161037"><span class="annot"><span class="annottext">stj :: SBV Word8
</span><a href="#local-6989586621681161037"><span class="hs-identifier hs-var hs-var">stj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var">readSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161039"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161040"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Implements the PRGA used in RC4. We return the new state and the next key value generated.</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#prga"><span class="hs-identifier hs-type">prga</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#RC4"><span class="hs-identifier hs-type">RC4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#RC4"><span class="hs-identifier hs-type">RC4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span id="prga"><span class="annot"><span class="annottext">prga :: RC4 -&gt; (SBV Word8, RC4)
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#prga"><span class="hs-identifier hs-var hs-var">prga</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161033"><span class="annot"><span class="annottext">st' :: S
</span><a href="#local-6989586621681161033"><span class="hs-identifier hs-var">st'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161032"><span class="annot"><span class="annottext">i' :: SBV Word8
</span><a href="#local-6989586621681161032"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161031"><span class="annot"><span class="annottext">j' :: SBV Word8
</span><a href="#local-6989586621681161031"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var">readSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161030"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161029"><span class="hs-identifier hs-var">kInd</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161030"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161028"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161027"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681161028"><span class="annot"><span class="annottext">i :: SBV Word8
</span><a href="#local-6989586621681161028"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161032"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-67"></span><span>        </span><span id="local-6989586621681161027"><span class="annot"><span class="annottext">j :: SBV Word8
</span><a href="#local-6989586621681161027"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161031"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var">readSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161033"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161028"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-68"></span><span>        </span><span id="local-6989586621681161030"><span class="annot"><span class="annottext">st :: S
</span><a href="#local-6989586621681161030"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; S -&gt; S
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161028"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161027"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161033"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-69"></span><span>        </span><span id="local-6989586621681161029"><span class="annot"><span class="annottext">kInd :: SBV Word8
</span><a href="#local-6989586621681161029"><span class="hs-identifier hs-var hs-var">kInd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var">readSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161030"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161028"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var">readSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161030"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161027"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- * Key schedule</span><span>
</span><span id="line-73"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Constructs the state to be used by the PRGA using the given key.</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#initRC4"><span class="hs-identifier hs-type">initRC4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-type">S</span></a></span><span>
</span><span id="line-77"></span><span id="initRC4"><span class="annot"><span class="annottext">initRC4 :: [SBV Word8] -&gt; S
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#initRC4"><span class="hs-identifier hs-var hs-var">initRC4</span></a></span></span><span> </span><span id="local-6989586621681161024"><span class="annot"><span class="annottext">key :: [SBV Word8]
</span><a href="#local-6989586621681161024"><span class="hs-identifier hs-var">key</span></a></span></span><span>
</span><span id="line-78"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161023"><span class="hs-identifier hs-var">keyLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161023"><span class="hs-identifier hs-var">keyLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span>
</span><span id="line-79"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; S
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; S) -&gt; [Char] -&gt; S
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RC4 requires a key of length between 1 and 256, received: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161023"><span class="hs-identifier hs-var">keyLength</span></a></span><span>
</span><span id="line-80"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-81"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SBV Word8, S) -&gt; S
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SBV Word8, S) -&gt; S) -&gt; (SBV Word8, S) -&gt; S
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((SBV Word8, S) -&gt; SBV Word8 -&gt; (SBV Word8, S))
-&gt; (SBV Word8, S) -&gt; [SBV Word8] -&gt; (SBV Word8, S)
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">(SBV Word8, S) -&gt; SBV Word8 -&gt; (SBV Word8, S)
</span><a href="#local-6989586621681161016"><span class="hs-identifier hs-var">mix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">S
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#initS"><span class="hs-identifier hs-var">initS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">255</span></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681161023"><span class="annot"><span class="annottext">keyLength :: Int
</span><a href="#local-6989586621681161023"><span class="hs-identifier hs-var hs-var">keyLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBV Word8] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681161024"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-83"></span><span>       </span><span class="annot"><a href="#local-6989586621681161016"><span class="hs-identifier hs-type">mix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#S"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>       </span><span id="local-6989586621681161016"><span class="annot"><span class="annottext">mix :: (SBV Word8, S) -&gt; SBV Word8 -&gt; (SBV Word8, S)
</span><a href="#local-6989586621681161016"><span class="hs-identifier hs-var hs-var">mix</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161014"><span class="annot"><span class="annottext">j' :: SBV Word8
</span><a href="#local-6989586621681161014"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161013"><span class="annot"><span class="annottext">s :: S
</span><a href="#local-6989586621681161013"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681161012"><span class="annot"><span class="annottext">i :: SBV Word8
</span><a href="#local-6989586621681161012"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681161011"><span class="annot"><span class="annottext">j :: SBV Word8
</span><a href="#local-6989586621681161011"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161014"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">S -&gt; SBV Word8 -&gt; SBV Word8
forall i e.
(SFiniteBits i, SymVal e) =&gt;
STree i e -&gt; SBV i -&gt; SBV e
</span><a href="Data.SBV.Tools.STree.html#readSTree"><span class="hs-identifier hs-var">readSTree</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161013"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161012"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[SBV Word8] -&gt; Word8 -&gt; SBV Word8
forall i a. Integral i =&gt; [a] -&gt; i -&gt; a
</span><span class="hs-identifier hs-var">genericIndex</span></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681161024"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Word8 -&gt; Word8
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Word8 -&gt; Maybe Word8
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161012"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161023"><span class="hs-identifier hs-var">keyLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161011"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; S -&gt; S
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161012"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161011"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621681161013"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | The key-schedule. Note that this function returns an infinite list.</span><span>
</span><span id="line-88"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#keySchedule"><span class="hs-identifier hs-type">keySchedule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span id="keySchedule"><span class="annot"><span class="annottext">keySchedule :: [SBV Word8] -&gt; [SBV Word8]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#keySchedule"><span class="hs-identifier hs-var hs-var">keySchedule</span></a></span></span><span> </span><span id="local-6989586621681161007"><span class="annot"><span class="annottext">key :: [SBV Word8]
</span><a href="#local-6989586621681161007"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RC4 -&gt; [SBV Word8]
</span><a href="#local-6989586621681161006"><span class="hs-identifier hs-var">genKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SBV Word8] -&gt; S
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#initRC4"><span class="hs-identifier hs-var">initRC4</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681161007"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621681161006"><span class="hs-identifier hs-type">genKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#RC4"><span class="hs-identifier hs-type">RC4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>        </span><span id="local-6989586621681161006"><span class="annot"><span class="annottext">genKeys :: RC4 -&gt; [SBV Word8]
</span><a href="#local-6989586621681161006"><span class="hs-identifier hs-var hs-var">genKeys</span></a></span></span><span> </span><span id="local-6989586621681161005"><span class="annot"><span class="annottext">st :: RC4
</span><a href="#local-6989586621681161005"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161004"><span class="annot"><span class="annottext">k :: SBV Word8
</span><a href="#local-6989586621681161004"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161003"><span class="annot"><span class="annottext">st' :: RC4
</span><a href="#local-6989586621681161003"><span class="hs-identifier hs-var">st'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RC4 -&gt; (SBV Word8, RC4)
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#prga"><span class="hs-identifier hs-var">prga</span></a></span><span> </span><span class="annot"><span class="annottext">RC4
</span><a href="#local-6989586621681161005"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SBV Word8
</span><a href="#local-6989586621681161004"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; [SBV Word8] -&gt; [SBV Word8]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">RC4 -&gt; [SBV Word8]
</span><a href="#local-6989586621681161006"><span class="hs-identifier hs-var">genKeys</span></a></span><span> </span><span class="annot"><span class="annottext">RC4
</span><a href="#local-6989586621681161003"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Generate a key-schedule from a given key-string.</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#keyScheduleString"><span class="hs-identifier hs-type">keyScheduleString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span id="keyScheduleString"><span class="annot"><span class="annottext">keyScheduleString :: [Char] -&gt; [SBV Word8]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#keyScheduleString"><span class="hs-identifier hs-var hs-var">keyScheduleString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBV Word8] -&gt; [SBV Word8]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#keySchedule"><span class="hs-identifier hs-var">keySchedule</span></a></span><span> </span><span class="annot"><span class="annottext">([SBV Word8] -&gt; [SBV Word8])
-&gt; ([Char] -&gt; [SBV Word8]) -&gt; [Char] -&gt; [SBV Word8]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; SBV Word8) -&gt; [Char] -&gt; [SBV Word8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; SBV Word8
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; SBV Word8) -&gt; (Char -&gt; Word8) -&gt; Char -&gt; SBV Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- * Encryption and Decryption</span><span>
</span><span id="line-99"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | RC4 encryption. We generate key-words and xor it with the input. The</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- following test-vectors are from Wikipedia &lt;http://en.wikipedia.org/wiki/RC4&gt;:</span><span>
</span><span id="line-103"></span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt;&gt;&gt; concatMap hex2 $ encrypt &quot;Key&quot; &quot;Plaintext&quot;</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- &quot;bbf316e8d940af0ad3&quot;</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;&gt;&gt; concatMap hex2 $ encrypt &quot;Wiki&quot; &quot;pedia&quot;</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &quot;1021bf0420&quot;</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;&gt;&gt; concatMap hex2 $ encrypt &quot;Secret&quot; &quot;Attack at dawn&quot;</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &quot;45a01f645fc35b383552544b9bf5&quot;</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#encrypt"><span class="hs-identifier hs-type">encrypt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span id="encrypt"><span class="annot"><span class="annottext">encrypt :: [Char] -&gt; [Char] -&gt; [SBV Word8]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#encrypt"><span class="hs-identifier hs-var hs-var">encrypt</span></a></span></span><span> </span><span id="local-6989586621681160998"><span class="annot"><span class="annottext">key :: [Char]
</span><a href="#local-6989586621681160998"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621681160997"><span class="annot"><span class="annottext">pt :: [Char]
</span><a href="#local-6989586621681160997"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8)
-&gt; [SBV Word8] -&gt; [SBV Word8] -&gt; [SBV Word8]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [SBV Word8]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#keyScheduleString"><span class="hs-identifier hs-var">keyScheduleString</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681160998"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; SBV Word8) -&gt; [Char] -&gt; [SBV Word8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SBV Word8
</span><a href="#local-6989586621681160994"><span class="hs-identifier hs-var">cvt</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681160997"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681160994"><span class="annot"><span class="annottext">cvt :: Char -&gt; SBV Word8
</span><a href="#local-6989586621681160994"><span class="hs-identifier hs-var hs-var">cvt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; SBV Word8
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; SBV Word8) -&gt; (Char -&gt; Word8) -&gt; Char -&gt; SBV Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | RC4 decryption. Essentially the same as decryption. For the above test vectors we have:</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &gt;&gt;&gt; decrypt &quot;Key&quot; [0xbb, 0xf3, 0x16, 0xe8, 0xd9, 0x40, 0xaf, 0x0a, 0xd3]</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- &quot;Plaintext&quot;</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- &gt;&gt;&gt; decrypt &quot;Wiki&quot; [0x10, 0x21, 0xbf, 0x04, 0x20]</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- &quot;pedia&quot;</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- &gt;&gt;&gt; decrypt &quot;Secret&quot; [0x45, 0xa0, 0x1f, 0x64, 0x5f, 0xc3, 0x5b, 0x38, 0x35, 0x52, 0x54, 0x4b, 0x9b, 0xf5]</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- &quot;Attack at dawn&quot;</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#decrypt"><span class="hs-identifier hs-type">decrypt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Data.html#SWord8"><span class="hs-identifier hs-type">SWord8</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-127"></span><span id="decrypt"><span class="annot"><span class="annottext">decrypt :: [Char] -&gt; [SBV Word8] -&gt; [Char]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#decrypt"><span class="hs-identifier hs-var hs-var">decrypt</span></a></span></span><span> </span><span id="local-6989586621681160992"><span class="annot"><span class="annottext">key :: [Char]
</span><a href="#local-6989586621681160992"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621681160991"><span class="annot"><span class="annottext">ct :: [SBV Word8]
</span><a href="#local-6989586621681160991"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SBV Word8 -&gt; Char) -&gt; [SBV Word8] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; Char
</span><a href="#local-6989586621681160990"><span class="hs-identifier hs-var">cvt</span></a></span><span> </span><span class="annot"><span class="annottext">([SBV Word8] -&gt; [Char]) -&gt; [SBV Word8] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8)
-&gt; [SBV Word8] -&gt; [SBV Word8] -&gt; [SBV Word8]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [SBV Word8]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#keyScheduleString"><span class="hs-identifier hs-var">keyScheduleString</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681160992"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160991"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681160990"><span class="annot"><span class="annottext">cvt :: SBV Word8 -&gt; Char
</span><a href="#local-6989586621681160990"><span class="hs-identifier hs-var hs-var">cvt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><span class="hs-identifier hs-var">chr</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Char) -&gt; (SBV Word8 -&gt; Int) -&gt; SBV Word8 -&gt; Char
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Int) -&gt; (SBV Word8 -&gt; Word8) -&gt; SBV Word8 -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word8 -&gt; Word8
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Word8 -&gt; Word8)
-&gt; (SBV Word8 -&gt; Maybe Word8) -&gt; SBV Word8 -&gt; Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; Maybe Word8
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- * Verification</span><span>
</span><span id="line-132"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Prove that round-trip encryption/decryption leaves the plain-text unchanged.</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- The theorem is stated parametrically over key and plain-text sizes. The expression</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- performs the proof for a 40-bit key (5 bytes) and 40-bit plaintext (again 5 bytes).</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- Note that this theorem is trivial to prove, since it is essentially establishing</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- xor'in the same value twice leaves a word unchanged (i.e., @x `xor` y `xor` y = x@).</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- However, the proof takes quite a while to complete, as it gives rise to a fairly</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- large symbolic trace.</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#rc4IsCorrect"><span class="hs-identifier hs-type">rc4IsCorrect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Data.SBV.SMT.SMT.html#ThmResult"><span class="hs-identifier hs-type">ThmResult</span></a></span><span>
</span><span id="line-143"></span><span id="rc4IsCorrect"><span class="annot"><span class="annottext">rc4IsCorrect :: IO ThmResult
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#rc4IsCorrect"><span class="hs-identifier hs-var hs-var">rc4IsCorrect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicT IO SBool -&gt; IO ThmResult
forall a. Provable a =&gt; a -&gt; IO ThmResult
</span><a href="Data.SBV.Client.BaseIO.html#prove"><span class="hs-identifier hs-var">prove</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolicT IO SBool -&gt; IO ThmResult)
-&gt; SymbolicT IO SBool -&gt; IO ThmResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>        </span><span id="local-6989586621681160987"><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160987"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Symbolic [SBV Word8]
forall a. SymVal a =&gt; Int -&gt; Symbolic [SBV a]
</span><a href="Data.SBV.Client.BaseIO.html#mkForallVars"><span class="hs-identifier hs-var">mkForallVars</span></a></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-145"></span><span>        </span><span id="local-6989586621681160985"><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160985"><span class="hs-identifier hs-var">pt</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Symbolic [SBV Word8]
forall a. SymVal a =&gt; Int -&gt; Symbolic [SBV a]
</span><a href="Data.SBV.Client.BaseIO.html#mkForallVars"><span class="hs-identifier hs-var">mkForallVars</span></a></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681160984"><span class="annot"><span class="annottext">ks :: [SBV Word8]
</span><a href="#local-6989586621681160984"><span class="hs-identifier hs-var hs-var">ks</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBV Word8] -&gt; [SBV Word8]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#keySchedule"><span class="hs-identifier hs-var">keySchedule</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160987"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-147"></span><span>            </span><span id="local-6989586621681160983"><span class="annot"><span class="annottext">ct :: [SBV Word8]
</span><a href="#local-6989586621681160983"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8)
-&gt; [SBV Word8] -&gt; [SBV Word8] -&gt; [SBV Word8]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160984"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160985"><span class="hs-identifier hs-var">pt</span></a></span><span>
</span><span id="line-148"></span><span>            </span><span id="local-6989586621681160982"><span class="annot"><span class="annottext">pt' :: [SBV Word8]
</span><a href="#local-6989586621681160982"><span class="hs-identifier hs-var hs-var">pt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8)
-&gt; [SBV Word8] -&gt; [SBV Word8] -&gt; [SBV Word8]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">SBV Word8 -&gt; SBV Word8 -&gt; SBV Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160984"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160983"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">SBool -&gt; SymbolicT IO SBool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SBool -&gt; SymbolicT IO SBool) -&gt; SBool -&gt; SymbolicT IO SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160985"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV Word8] -&gt; [SBV Word8] -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV Word8]
</span><a href="#local-6989586621681160982"><span class="hs-identifier hs-var">pt'</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">--------------------------------------------------------------------------------------------</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | For doctest purposes only</span><span>
</span><span id="line-153"></span><span id="local-6989586621681160980"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.RC4.html#hex2"><span class="hs-identifier hs-type">hex2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681160980"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621681160980"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621681160980"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681160980"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-154"></span><span id="hex2"><span class="annot"><span class="annottext">hex2 :: SBV a -&gt; [Char]
</span><a href="Documentation.SBV.Examples.Crypto.RC4.html#hex2"><span class="hs-identifier hs-var hs-var">hex2</span></a></span></span><span> </span><span id="local-6989586621681160978"><span class="annot"><span class="annottext">v :: SBV a
</span><a href="#local-6989586621681160978"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; [Char]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681160976"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-char">'0'</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681160976"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681160976"><span class="annot"><span class="annottext">s :: [Char]
</span><a href="#local-6989586621681160976"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [Char] -&gt; [Char]) -&gt; [Char] -&gt; a -&gt; [Char]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char] -&gt; [Char]
forall a. (Integral a, Show a) =&gt; a -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">showHex</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; [Char]) -&gt; (SBV a -&gt; a) -&gt; SBV a -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; a
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; (SBV a -&gt; Maybe a) -&gt; SBV a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">(SBV a -&gt; [Char]) -&gt; SBV a -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681160978"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-156"></span></pre></body></html>