<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module    : Documentation.SBV.Examples.Crypto.SHA</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright : (c) Levent Erkok</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer: erkokl@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Implementation of SHA2 class of algorithms, closely following the spec</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- &lt;http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf&gt;.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- We support all variants of SHA in the spec, except for SHA1. Note that</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- this implementation is really useful for code-generation purposes from</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- SBV, as it is hard to state (or prove!) any particular properties of</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- these algorithms that is suitable for SMT solving.</span><span>
</span><span id="line-16"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types          #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Documentation.SBV.Examples.Crypto.SHA</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.html"><span class="hs-identifier">Data.SBV</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.Tools.CodeGen.html"><span class="hs-identifier">Data.SBV.Tools.CodeGen</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">genericLength</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showHex</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- * Parameterizing SHA</span><span>
</span><span id="line-37"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Parameterized SHA representation, that captures all the differences</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- between variants of the algorithm. @w@ is the word-size type.</span><span>
</span><span id="line-41"></span><span class="hs-keyword">data</span><span> </span><span id="SHA"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-var">SHA</span></a></span></span><span> </span><span id="local-6989586621681161435"><span class="annot"><a href="#local-6989586621681161435"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SHA"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-var">SHA</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="wordSize"><span class="annot"><span class="annottext">SHA w -&gt; Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#wordSize"><span class="hs-identifier hs-var hs-var">wordSize</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>              </span><span class="hs-comment">-- ^ Section 1           : Word size we operate with</span><span>
</span><span id="line-42"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="blockSize"><span class="annot"><span class="annottext">SHA w -&gt; Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#blockSize"><span class="hs-identifier hs-var hs-var">blockSize</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>              </span><span class="hs-comment">-- ^ Section 1           : Block size for messages</span><span>
</span><span id="line-43"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="sum0Coefficients"><span class="annot"><span class="annottext">SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum0Coefficients"><span class="hs-identifier hs-var hs-var">sum0Coefficients</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Section 4.1.2-3     : Coefficients of the Sum0 function</span><span>
</span><span id="line-44"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="sum1Coefficients"><span class="annot"><span class="annottext">SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum1Coefficients"><span class="hs-identifier hs-var hs-var">sum1Coefficients</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Section 4.1.2-3     : Coefficients of the Sum1 function</span><span>
</span><span id="line-45"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="sigma0Coefficients"><span class="annot"><span class="annottext">SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma0Coefficients"><span class="hs-identifier hs-var hs-var">sigma0Coefficients</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Section 4.1.2-3     : Coefficients of the sigma0 function</span><span>
</span><span id="line-46"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="sigma1Coefficients"><span class="annot"><span class="annottext">SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma1Coefficients"><span class="hs-identifier hs-var hs-var">sigma1Coefficients</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Section 4.1.2-3     : Coefficients of the sigma1 function</span><span>
</span><span id="line-47"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="shaConstants"><span class="annot"><span class="annottext">SHA w -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaConstants"><span class="hs-identifier hs-var hs-var">shaConstants</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161435"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span><span>              </span><span class="hs-comment">-- ^ Section 4.2.2-3     : Magic SHA constants</span><span>
</span><span id="line-48"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="h0"><span class="annot"><span class="annottext">SHA w -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#h0"><span class="hs-identifier hs-var hs-var">h0</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161435"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span><span>              </span><span class="hs-comment">-- ^ Section 5.3.2-6     : Initial hash value</span><span>
</span><span id="line-49"></span><span>                 </span><span class="hs-special">,</span><span> </span><span id="shaLoopCount"><span class="annot"><span class="annottext">SHA w -&gt; Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaLoopCount"><span class="hs-identifier hs-var hs-var">shaLoopCount</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>              </span><span class="hs-comment">-- ^ Section 6.2.2, 6.4.2: How many iterations are there in the inner loop</span><span>
</span><span id="line-50"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- * Section 4.1.2, SHA functions</span><span>
</span><span id="line-54"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | The choose function.</span><span>
</span><span id="line-57"></span><span id="local-6989586621681161390"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#ch"><span class="hs-identifier hs-type">ch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161390"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161390"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161390"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161390"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161390"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-58"></span><span id="ch"><span class="annot"><span class="annottext">ch :: a -&gt; a -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#ch"><span class="hs-identifier hs-var hs-var">ch</span></a></span></span><span> </span><span id="local-6989586621681161325"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621681161325"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681161324"><span class="annot"><span class="annottext">y :: a
</span><a href="#local-6989586621681161324"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621681161323"><span class="annot"><span class="annottext">z :: a
</span><a href="#local-6989586621681161323"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161325"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161324"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161325"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161323"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | The majority function.</span><span>
</span><span id="line-61"></span><span id="local-6989586621681161319"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#maj"><span class="hs-identifier hs-type">maj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161319"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-62"></span><span id="maj"><span class="annot"><span class="annottext">maj :: a -&gt; a -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#maj"><span class="hs-identifier hs-var hs-var">maj</span></a></span></span><span> </span><span id="local-6989586621681161317"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621681161317"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681161316"><span class="annot"><span class="annottext">y :: a
</span><a href="#local-6989586621681161316"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621681161315"><span class="annot"><span class="annottext">z :: a
</span><a href="#local-6989586621681161315"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161317"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161316"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161317"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161315"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161316"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161315"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | The sum-0 function. We parameterize over the rotation amounts as different</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- variants of SHA use different rotation amnounts.</span><span>
</span><span id="line-66"></span><span id="local-6989586621681161313"><span id="local-6989586621681161314"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum0"><span class="hs-identifier hs-type">sum0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161314"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161313"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161314"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161314"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-67"></span><span id="sum0"><span class="annot"><span class="annottext">sum0 :: SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum0"><span class="hs-identifier hs-var hs-var">sum0</span></a></span></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sum0Coefficients :: forall w. SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum0Coefficients"><span class="hs-identifier hs-var">sum0Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161311"><span class="annot"><span class="annottext">a :: Int
</span><a href="#local-6989586621681161311"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161310"><span class="annot"><span class="annottext">b :: Int
</span><a href="#local-6989586621681161310"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161309"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621681161309"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span id="local-6989586621681161308"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621681161308"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161308"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161311"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161308"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161310"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161308"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161309"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | The sum-1 function. Again, parameterized.</span><span>
</span><span id="line-70"></span><span id="local-6989586621681161305"><span id="local-6989586621681161306"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum1"><span class="hs-identifier hs-type">sum1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161306"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161305"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161306"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161306"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-71"></span><span id="sum1"><span class="annot"><span class="annottext">sum1 :: SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum1"><span class="hs-identifier hs-var hs-var">sum1</span></a></span></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sum1Coefficients :: forall w. SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum1Coefficients"><span class="hs-identifier hs-var">sum1Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161303"><span class="annot"><span class="annottext">a :: Int
</span><a href="#local-6989586621681161303"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161302"><span class="annot"><span class="annottext">b :: Int
</span><a href="#local-6989586621681161302"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161301"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621681161301"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span id="local-6989586621681161300"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621681161300"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161300"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161303"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161300"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161302"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161300"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161301"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | The sigma0 function. Parameterized.</span><span>
</span><span id="line-74"></span><span id="local-6989586621681161298"><span id="local-6989586621681161299"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma0"><span class="hs-identifier hs-type">sigma0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161299"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161298"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161299"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161299"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-75"></span><span id="sigma0"><span class="annot"><span class="annottext">sigma0 :: SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma0"><span class="hs-identifier hs-var hs-var">sigma0</span></a></span></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sigma0Coefficients :: forall w. SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma0Coefficients"><span class="hs-identifier hs-var">sigma0Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161296"><span class="annot"><span class="annottext">a :: Int
</span><a href="#local-6989586621681161296"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161295"><span class="annot"><span class="annottext">b :: Int
</span><a href="#local-6989586621681161295"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161294"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621681161294"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span id="local-6989586621681161293"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621681161293"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161293"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161296"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161293"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161295"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161293"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161294"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | The sigma1 function. Parameterized.</span><span>
</span><span id="line-78"></span><span id="local-6989586621681161391"><span id="local-6989586621681161392"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma1"><span class="hs-identifier hs-type">sigma1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161392"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161391"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161392"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161392"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-79"></span><span id="sigma1"><span class="annot"><span class="annottext">sigma1 :: SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma1"><span class="hs-identifier hs-var hs-var">sigma1</span></a></span></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sigma1Coefficients :: forall w. SHA w -&gt; (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma1Coefficients"><span class="hs-identifier hs-var">sigma1Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161290"><span class="annot"><span class="annottext">a :: Int
</span><a href="#local-6989586621681161290"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161289"><span class="annot"><span class="annottext">b :: Int
</span><a href="#local-6989586621681161289"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161288"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621681161288"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span id="local-6989586621681161287"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621681161287"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161287"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161290"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161287"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161289"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161287"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161288"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- * SHA variants</span><span>
</span><span id="line-83"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Parameterization for SHA224.</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha224P"><span class="hs-identifier hs-type">sha224P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span id="sha224P"><span class="annot"><span class="annottext">sha224P :: SHA (SWord 32)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha224P"><span class="hs-identifier hs-var hs-var">sha224P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA :: forall w.
Int
-&gt; Int
-&gt; (Int, Int, Int)
-&gt; (Int, Int, Int)
-&gt; (Int, Int, Int)
-&gt; (Int, Int, Int)
-&gt; [w]
-&gt; [w]
-&gt; Int
-&gt; SHA w
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type hs-type">SHA</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">wordSize :: Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#wordSize"><span class="hs-identifier hs-var">wordSize</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">32</span></span><span>
</span><span id="line-88"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">blockSize :: Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#blockSize"><span class="hs-identifier hs-var">blockSize</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">512</span></span><span>
</span><span id="line-89"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sum0Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum0Coefficients"><span class="hs-identifier hs-var">sum0Coefficients</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">13</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">22</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sum1Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum1Coefficients"><span class="hs-identifier hs-var">sum1Coefficients</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-number">6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">11</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">25</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sigma0Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma0Coefficients"><span class="hs-identifier hs-var">sigma0Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-number">7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">18</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sigma1Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma1Coefficients"><span class="hs-identifier hs-var">sigma1Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">17</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shaConstants :: [SWord 32]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaConstants"><span class="hs-identifier hs-var">shaConstants</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0x428a2f98</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x71374491</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xb5c0fbcf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xe9b5dba5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x3956c25b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x59f111f1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x923f82a4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xab1c5ed5</span></span><span>
</span><span id="line-94"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd807aa98</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x12835b01</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x243185be</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x550c7dc3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x72be5d74</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x80deb1fe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x9bdc06a7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc19bf174</span></span><span>
</span><span id="line-95"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xe49b69c1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xefbe4786</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x0fc19dc6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x240ca1cc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2de92c6f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x4a7484aa</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x5cb0a9dc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x76f988da</span></span><span>
</span><span id="line-96"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x983e5152</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa831c66d</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xb00327c8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xbf597fc7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc6e00bf3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd5a79147</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x06ca6351</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x14292967</span></span><span>
</span><span id="line-97"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x27b70a85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2e1b2138</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x4d2c6dfc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x53380d13</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x650a7354</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x766a0abb</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x81c2c92e</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x92722c85</span></span><span>
</span><span id="line-98"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa2bfe8a1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa81a664b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc24b8b70</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc76c51a3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd192e819</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd6990624</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xf40e3585</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x106aa070</span></span><span>
</span><span id="line-99"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x19a4c116</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x1e376c08</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2748774c</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x34b0bcb5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x391c0cb3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x4ed8aa4a</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x5b9cca4f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x682e6ff3</span></span><span>
</span><span id="line-100"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x748f82ee</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x78a5636f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x84c87814</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x8cc70208</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x90befffa</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa4506ceb</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xbef9a3f7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc67178f2</span></span><span>
</span><span id="line-101"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">h0 :: [SWord 32]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#h0"><span class="hs-identifier hs-var">h0</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0xc1059ed8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x367cd507</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x3070dd17</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xf70e5939</span></span><span>
</span><span id="line-103"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xffc00b31</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x68581511</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x64f98fa7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xbefa4fa4</span></span><span>
</span><span id="line-104"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shaLoopCount :: Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaLoopCount"><span class="hs-identifier hs-var">shaLoopCount</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-106"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Parameterization for SHA256. Inherits mostly from SHA224.</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha256P"><span class="hs-identifier hs-type">sha256P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span id="sha256P"><span class="annot"><span class="annottext">sha256P :: SHA (SWord 32)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha256P"><span class="hs-identifier hs-var hs-var">sha256P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha224P"><span class="hs-identifier hs-var">sha224P</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">h0 :: [SWord 32]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#h0"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0x6a09e667</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xbb67ae85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x3c6ef372</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa54ff53a</span></span><span>
</span><span id="line-111"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x510e527f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x9b05688c</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x1f83d9ab</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x5be0cd19</span></span><span>
</span><span id="line-112"></span><span>                         </span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Parameterization for SHA384.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha384P"><span class="hs-identifier hs-type">sha384P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span id="sha384P"><span class="annot"><span class="annottext">sha384P :: SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha384P"><span class="hs-identifier hs-var hs-var">sha384P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA :: forall w.
Int
-&gt; Int
-&gt; (Int, Int, Int)
-&gt; (Int, Int, Int)
-&gt; (Int, Int, Int)
-&gt; (Int, Int, Int)
-&gt; [w]
-&gt; [w]
-&gt; Int
-&gt; SHA w
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type hs-type">SHA</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">wordSize :: Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#wordSize"><span class="hs-identifier hs-var">wordSize</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-118"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">blockSize :: Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#blockSize"><span class="hs-identifier hs-var">blockSize</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1024</span></span><span>
</span><span id="line-119"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sum0Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum0Coefficients"><span class="hs-identifier hs-var">sum0Coefficients</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">28</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">34</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">39</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sum1Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum1Coefficients"><span class="hs-identifier hs-var">sum1Coefficients</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">14</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">18</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">41</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sigma0Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma0Coefficients"><span class="hs-identifier hs-var">sigma0Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-number">7</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sigma1Coefficients :: (Int, Int, Int)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma1Coefficients"><span class="hs-identifier hs-var">sigma1Coefficients</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">61</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-number">6</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shaConstants :: [SWord 64]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaConstants"><span class="hs-identifier hs-var">shaConstants</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0x428a2f98d728ae22</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x7137449123ef65cd</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xb5c0fbcfec4d3b2f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xe9b5dba58189dbbc</span></span><span>
</span><span id="line-124"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x3956c25bf348b538</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x59f111f1b605d019</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x923f82a4af194f9b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xab1c5ed5da6d8118</span></span><span>
</span><span id="line-125"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd807aa98a3030242</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x12835b0145706fbe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x243185be4ee4b28c</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x550c7dc3d5ffb4e2</span></span><span>
</span><span id="line-126"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x72be5d74f27b896f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x80deb1fe3b1696b1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x9bdc06a725c71235</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc19bf174cf692694</span></span><span>
</span><span id="line-127"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xe49b69c19ef14ad2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xefbe4786384f25e3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x0fc19dc68b8cd5b5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x240ca1cc77ac9c65</span></span><span>
</span><span id="line-128"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2de92c6f592b0275</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x4a7484aa6ea6e483</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x5cb0a9dcbd41fbd4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x76f988da831153b5</span></span><span>
</span><span id="line-129"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x983e5152ee66dfab</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa831c66d2db43210</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xb00327c898fb213f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xbf597fc7beef0ee4</span></span><span>
</span><span id="line-130"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc6e00bf33da88fc2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd5a79147930aa725</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x06ca6351e003826f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x142929670a0e6e70</span></span><span>
</span><span id="line-131"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x27b70a8546d22ffc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2e1b21385c26c926</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x4d2c6dfc5ac42aed</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x53380d139d95b3df</span></span><span>
</span><span id="line-132"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x650a73548baf63de</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x766a0abb3c77b2a8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x81c2c92e47edaee6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x92722c851482353b</span></span><span>
</span><span id="line-133"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa2bfe8a14cf10364</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa81a664bbc423001</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc24b8b70d0f89791</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc76c51a30654be30</span></span><span>
</span><span id="line-134"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd192e819d6ef5218</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd69906245565a910</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xf40e35855771202a</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x106aa07032bbd1b8</span></span><span>
</span><span id="line-135"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x19a4c116b8d2d0c8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x1e376c085141ab53</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2748774cdf8eeb99</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x34b0bcb5e19b48a8</span></span><span>
</span><span id="line-136"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x391c0cb3c5c95a63</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x4ed8aa4ae3418acb</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x5b9cca4f7763e373</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x682e6ff3d6b2b8a3</span></span><span>
</span><span id="line-137"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x748f82ee5defb2fc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x78a5636f43172f60</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x84c87814a1f0ab72</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x8cc702081a6439ec</span></span><span>
</span><span id="line-138"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x90befffa23631e28</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa4506cebde82bde9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xbef9a3f7b2c67915</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xc67178f2e372532b</span></span><span>
</span><span id="line-139"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xca273eceea26619c</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xd186b8c721c0c207</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xeada7dd6cde0eb1e</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xf57d4f7fee6ed178</span></span><span>
</span><span id="line-140"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x06f067aa72176fba</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x0a637dc5a2c898a6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x113f9804bef90dae</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x1b710b35131c471b</span></span><span>
</span><span id="line-141"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x28db77f523047d84</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x32caab7b40c72493</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x3c9ebe0a15c9bebc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x431d67c49c100d4c</span></span><span>
</span><span id="line-142"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x4cc5d4becb3e42b6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x597f299cfc657e2a</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x5fcb6fab3ad6faec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x6c44198c4a475817</span></span><span>
</span><span id="line-143"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">h0 :: [SWord 64]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#h0"><span class="hs-identifier hs-var">h0</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0xcbbb9d5dc1059ed8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x629a292a367cd507</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x9159015a3070dd17</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x152fecd8f70e5939</span></span><span>
</span><span id="line-145"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x67332667ffc00b31</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x8eb44a8768581511</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xdb0c2e0d64f98fa7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x47b5481dbefa4fa4</span></span><span>
</span><span id="line-146"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shaLoopCount :: Int
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaLoopCount"><span class="hs-identifier hs-var">shaLoopCount</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">80</span></span><span>
</span><span id="line-148"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Parameterization for SHA512. Inherits mostly from SHA384.</span><span>
</span><span id="line-151"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512P"><span class="hs-identifier hs-type">sha512P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="sha512P"><span class="annot"><span class="annottext">sha512P :: SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512P"><span class="hs-identifier hs-var hs-var">sha512P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha384P"><span class="hs-identifier hs-var">sha384P</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">h0 :: [SWord 64]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#h0"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0x6a09e667f3bcc908</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xbb67ae8584caa73b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x3c6ef372fe94f82b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xa54ff53a5f1d36f1</span></span><span>
</span><span id="line-153"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x510e527fade682d1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x9b05688c2b3e6c1f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x1f83d9abfb41bd6b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x5be0cd19137e2179</span></span><span>
</span><span id="line-154"></span><span>                         </span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Parameterization for SHA512_224. Inherits mostly from SHA512</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_224P"><span class="hs-identifier hs-type">sha512_224P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span id="sha512_224P"><span class="annot"><span class="annottext">sha512_224P :: SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_224P"><span class="hs-identifier hs-var hs-var">sha512_224P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512P"><span class="hs-identifier hs-var">sha512P</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">h0 :: [SWord 64]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#h0"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0x8C3D37C819544DA2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x73E1996689DCD4D6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x1DFAB7AE32FF9C82</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x679DD514582F9FCF</span></span><span>
</span><span id="line-160"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x0F6D2B697BD44DA8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x77E36F7304C48942</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x3F9D85A86A1D36C8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x1112E6AD91D692A1</span></span><span>
</span><span id="line-161"></span><span>                             </span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Parameterization for SHA512_256. Inherits mostly from SHA512</span><span>
</span><span id="line-165"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_256P"><span class="hs-identifier hs-type">sha512_256P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span id="sha512_256P"><span class="annot"><span class="annottext">sha512_256P :: SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_256P"><span class="hs-identifier hs-var hs-var">sha512_256P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512P"><span class="hs-identifier hs-var">sha512P</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">h0 :: [SWord 64]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#h0"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">0x22312194FC2BF72C</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x9F555FA3C84C64C2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2393B86B6F53B151</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x963877195940EABD</span></span><span>
</span><span id="line-167"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x96283EE2A88EFFE3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0xBE5E1E2553863992</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x2B0199FC2C85B8AA</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0x0EB72DDC81C52CA2</span></span><span>
</span><span id="line-168"></span><span>                             </span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- * Section 5, Preprocessing</span><span>
</span><span id="line-173"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | 'Block' is a  synonym for lists, but makes the intent clear.</span><span>
</span><span id="line-176"></span><span class="hs-keyword">newtype</span><span> </span><span id="Block"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#Block"><span class="hs-identifier hs-var">Block</span></a></span></span><span> </span><span id="local-6989586621681161402"><span class="annot"><a href="#local-6989586621681161402"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Block"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#Block"><span class="hs-identifier hs-var">Block</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161402"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Prepare the message by turning it into blocks. We also check for the message</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- size requirement here. Note that this won't actually happen in practice as the input</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- length would be &gt; 2^64 (or 2^128), and you'd run out of memory first! Such a check</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#prepareMessage"><span class="hs-identifier hs-type">prepareMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681161380"><span class="annot"><a href="#local-6989586621681161380"><span class="hs-identifier hs-type">w</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681161380"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#ByteConverter"><span class="hs-identifier hs-type">ByteConverter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161380"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161380"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161380"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span id="prepareMessage"><span class="annot"><span class="annottext">prepareMessage :: SHA w -&gt; String -&gt; [Block w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#prepareMessage"><span class="hs-identifier hs-var hs-var">prepareMessage</span></a></span></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span class="hs-special">{</span><span id="local-6989586621681161277"><span class="annot"><span class="annottext">Int
wordSize :: Int
wordSize :: forall w. SHA w -&gt; Int
</span><a href="#local-6989586621681161277"><span class="hs-identifier hs-var hs-var">wordSize</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161276"><span class="annot"><span class="annottext">Int
blockSize :: Int
blockSize :: forall w. SHA w -&gt; Int
</span><a href="#local-6989586621681161276"><span class="hs-identifier hs-var hs-var">blockSize</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621681161275"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161275"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681161274"><span class="hs-identifier hs-var">msgLen</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681161273"><span class="hs-identifier hs-var">maxLen</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Block w]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [Block w]) -&gt; String -&gt; [Block w]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Message is too big! Size: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681161274"><span class="hs-identifier hs-var">msgLen</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; Max: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681161273"><span class="hs-identifier hs-var">maxLen</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[w] -&gt; [Block w]
forall a. [a] -&gt; [Block a]
</span><a href="#local-6989586621681161270"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">([w] -&gt; [Block w]) -&gt; [w] -&gt; [Block w]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ([SWord 8] -&gt; w) -&gt; [SWord 8] -&gt; [w]
forall a b. Int -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#chunkBy"><span class="hs-identifier hs-var">chunkBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161277"><span class="hs-identifier hs-var">wordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SWord 8] -&gt; w
forall a. ByteConverter a =&gt; [SWord 8] -&gt; a
</span><a href="Data.SBV.Core.Sized.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">[SWord 8]
</span><a href="#local-6989586621681161266"><span class="hs-identifier hs-var">padded</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- Maximum message size supported by the algorithm</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="#local-6989586621681161273"><span class="hs-identifier hs-type">maxLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-190"></span><span>        </span><span id="local-6989586621681161273"><span class="annot"><span class="annottext">maxLen :: Integer
</span><a href="#local-6989586621681161273"><span class="hs-identifier hs-var hs-var">maxLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161277"><span class="hs-identifier hs-var">wordSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-comment">-- Size of the input in bits</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href="#local-6989586621681161274"><span class="hs-identifier hs-type">msgLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621681161274"><span class="annot"><span class="annottext">msgLen :: Integer
</span><a href="#local-6989586621681161274"><span class="hs-identifier hs-var hs-var">msgLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Integer
forall i a. Num i =&gt; [a] -&gt; i
</span><span class="hs-identifier hs-var">genericLength</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161275"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-comment">-- In all variants, we have 16-element blocks:</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-comment">--    SHA 224, 256                  :  512-bit block size with 32-bit word size: Total 16 words to a block</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-comment">--    SHA 384, 512, 512_224, 512_256: 1024-bit block size with 64-bit word size: Total 16 words to a block</span><span>
</span><span id="line-199"></span><span>        </span><span id="local-6989586621681161270"><span class="annot"><span class="annottext">parse :: [a] -&gt; [Block a]
</span><a href="#local-6989586621681161270"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ([a] -&gt; Block a) -&gt; [a] -&gt; [Block a]
forall a b. Int -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#chunkBy"><span class="hs-identifier hs-var">chunkBy</span></a></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Block a
forall a. [a] -&gt; Block a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><a href="#local-6989586621681161263"><span class="hs-identifier hs-type">msgSizeAsBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>        </span><span id="local-6989586621681161263"><span class="annot"><span class="annottext">msgSizeAsBytes :: [SWord 8]
</span><a href="#local-6989586621681161263"><span class="hs-identifier hs-var hs-var">msgSizeAsBytes</span></a></span></span><span>
</span><span id="line-203"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161277"><span class="hs-identifier hs-var">wordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; [SWord 8]
forall a. ByteConverter a =&gt; a -&gt; [SWord 8]
</span><a href="Data.SBV.Core.Sized.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SWord 64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681161274"><span class="hs-identifier hs-var">msgLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span>  </span><span class="annot"><span class="hs-number">64</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161277"><span class="hs-identifier hs-var">wordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 128 -&gt; [SWord 8]
forall a. ByteConverter a =&gt; a -&gt; [SWord 8]
</span><a href="Data.SBV.Core.Sized.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SWord 128
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681161274"><span class="hs-identifier hs-var">msgLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">128</span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [SWord 8]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [SWord 8]) -&gt; String -&gt; [SWord 8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;prepareMessage: Unexpected word size: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161277"><span class="hs-identifier hs-var">wordSize</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-comment">-- kLen is how many bits extra we need in the padding</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><a href="#local-6989586621681161261"><span class="hs-identifier hs-type">kLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-209"></span><span>        </span><span id="local-6989586621681161261"><span class="annot"><span class="annottext">kLen :: Int
</span><a href="#local-6989586621681161261"><span class="hs-identifier hs-var hs-var">kLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161276"><span class="hs-identifier hs-var">blockSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681161274"><span class="hs-identifier hs-var">msgLen</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161277"><span class="hs-identifier hs-var">wordSize</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161276"><span class="hs-identifier hs-var">blockSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-comment">-- Since message is always a multiple of 8, we need to pad it with the byte 0x80 for the first byte</span><span>
</span><span id="line-212"></span><span>        </span><span class="hs-comment">-- after it (1000 0000), and then enough bytes to fill to make it a multiple of the block size.</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="#local-6989586621681161266"><span class="hs-identifier hs-type">padded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621681161266"><span class="annot"><span class="annottext">padded :: [SWord 8]
</span><a href="#local-6989586621681161266"><span class="hs-identifier hs-var hs-var">padded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; SWord 8) -&gt; String -&gt; [SWord 8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SWord 8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; SWord 8) -&gt; (Char -&gt; Int) -&gt; Char -&gt; SWord 8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161275"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[SWord 8] -&gt; [SWord 8] -&gt; [SWord 8]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0x80</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SWord 8] -&gt; [SWord 8] -&gt; [SWord 8]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SWord 8 -&gt; [SWord 8]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161261"><span class="hs-identifier hs-var">kLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[SWord 8] -&gt; [SWord 8] -&gt; [SWord 8]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SWord 8]
</span><a href="#local-6989586621681161263"><span class="hs-identifier hs-var">msgSizeAsBytes</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- * Section 6.2.2 and 6.4.2, Hash computation</span><span>
</span><span id="line-218"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Hash one block of message, starting from a previous hash. This function</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- corresponds to body of the for-loop in the spec. This function always</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- produces a list of length 8, corresponding to the final 8 values of the @H@.</span><span>
</span><span id="line-223"></span><span id="local-6989586621681161381"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#hashBlock"><span class="hs-identifier hs-type">hashBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681161381"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161381"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161381"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161381"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161381"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161381"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-224"></span><span id="hashBlock"><span class="annot"><span class="annottext">hashBlock :: SHA w -&gt; [w] -&gt; Block w -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#hashBlock"><span class="hs-identifier hs-var hs-var">hashBlock</span></a></span></span><span> </span><span id="local-6989586621681161255"><span class="annot"><span class="annottext">p :: SHA w
</span><a href="#local-6989586621681161255"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span class="hs-special">{</span><span id="local-6989586621681161254"><span class="annot"><span class="annottext">Int
shaLoopCount :: Int
shaLoopCount :: forall w. SHA w -&gt; Int
</span><a href="#local-6989586621681161254"><span class="hs-identifier hs-var hs-var">shaLoopCount</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161253"><span class="annot"><span class="annottext">[w]
shaConstants :: [w]
shaConstants :: forall w. SHA w -&gt; [w]
</span><a href="#local-6989586621681161253"><span class="hs-identifier hs-var hs-var">shaConstants</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621681161252"><span class="annot"><span class="annottext">hPrev :: [w]
</span><a href="#local-6989586621681161252"><span class="hs-identifier hs-var">hPrev</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621681161251"><span class="annot"><span class="annottext">m :: [w]
</span><a href="#local-6989586621681161251"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161250"><span class="hs-identifier hs-var">step4</span></a></span><span>
</span><span id="line-225"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681161249"><span class="annot"><span class="annottext">lim :: Int
</span><a href="#local-6989586621681161249"><span class="hs-identifier hs-var hs-var">lim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161254"><span class="hs-identifier hs-var">shaLoopCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>         </span><span class="hs-comment">-- Step 1: Prepare the message schedule:</span><span>
</span><span id="line-228"></span><span>         </span><span id="local-6989586621681161248"><span class="annot"><span class="annottext">w :: Int -&gt; w
</span><a href="#local-6989586621681161248"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681161247"><span class="annot"><span class="annottext">t :: Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161251"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[w] -&gt; Int -&gt; w
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161249"><span class="hs-identifier hs-var">lim</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA w -&gt; w -&gt; w
forall a w. Bits a =&gt; SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma1"><span class="hs-identifier hs-var">sigma1</span></a></span><span> </span><span class="annot"><span class="annottext">SHA w
</span><a href="#local-6989586621681161255"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; w
</span><a href="#local-6989586621681161248"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; w
</span><a href="#local-6989586621681161248"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">SHA w -&gt; w -&gt; w
forall a w. Bits a =&gt; SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sigma0"><span class="hs-identifier hs-var">sigma0</span></a></span><span> </span><span class="annot"><span class="annottext">SHA w
</span><a href="#local-6989586621681161255"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; w
</span><a href="#local-6989586621681161248"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">15</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; w
</span><a href="#local-6989586621681161248"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; w
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; w) -&gt; String -&gt; w
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;hashBlock, unexpected t: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161247"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>         </span><span class="hs-comment">-- Step 2: Initialize working variables</span><span>
</span><span id="line-234"></span><span>         </span><span class="hs-comment">-- No code needed!</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>         </span><span class="hs-comment">-- Step 3 Body:</span><span>
</span><span id="line-237"></span><span>         </span><span id="local-6989586621681161243"><span class="annot"><span class="annottext">step3Body :: [w] -&gt; Int -&gt; [w]
</span><a href="#local-6989586621681161243"><span class="hs-identifier hs-var hs-var">step3Body</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681161242"><span class="annot"><span class="annottext">a :: w
</span><a href="#local-6989586621681161242"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161241"><span class="annot"><span class="annottext">b :: w
</span><a href="#local-6989586621681161241"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161240"><span class="annot"><span class="annottext">c :: w
</span><a href="#local-6989586621681161240"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161239"><span class="annot"><span class="annottext">d :: w
</span><a href="#local-6989586621681161239"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161238"><span class="annot"><span class="annottext">e :: w
</span><a href="#local-6989586621681161238"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161237"><span class="annot"><span class="annottext">f :: w
</span><a href="#local-6989586621681161237"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161236"><span class="annot"><span class="annottext">g :: w
</span><a href="#local-6989586621681161236"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161235"><span class="annot"><span class="annottext">h :: w
</span><a href="#local-6989586621681161235"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621681161234"><span class="annot"><span class="annottext">t :: Int
</span><a href="#local-6989586621681161234"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161233"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161232"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161242"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161241"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161240"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161239"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161233"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161238"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161237"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161236"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>           </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681161233"><span class="annot"><span class="annottext">t1 :: w
</span><a href="#local-6989586621681161233"><span class="hs-identifier hs-var hs-var">t1</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161235"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">SHA w -&gt; w -&gt; w
forall a w. Bits a =&gt; SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum1"><span class="hs-identifier hs-var">sum1</span></a></span><span> </span><span class="annot"><span class="annottext">SHA w
</span><a href="#local-6989586621681161255"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161238"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w -&gt; w
forall a. Bits a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#ch"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161238"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161237"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161236"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161253"><span class="hs-identifier hs-var">shaConstants</span></a></span><span> </span><span class="annot"><span class="annottext">[w] -&gt; Int -&gt; w
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161234"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; w
</span><a href="#local-6989586621681161248"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161234"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-239"></span><span>                 </span><span id="local-6989586621681161232"><span class="annot"><span class="annottext">t2 :: w
</span><a href="#local-6989586621681161232"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA w -&gt; w -&gt; w
forall a w. Bits a =&gt; SHA w -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sum0"><span class="hs-identifier hs-var">sum0</span></a></span><span> </span><span class="annot"><span class="annottext">SHA w
</span><a href="#local-6989586621681161255"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161242"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w -&gt; w
forall a. Bits a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#maj"><span class="hs-identifier hs-var">maj</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161242"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161241"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621681161240"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-240"></span><span>         </span><span class="annot"><a href="#local-6989586621681161243"><span class="hs-identifier hs-var">step3Body</span></a></span><span> </span><span id="local-6989586621681161231"><span class="annot"><span class="annottext">xs :: [w]
</span><a href="#local-6989586621681161231"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621681161230"><span class="annot"><span class="annottext">t :: Int
</span><a href="#local-6989586621681161230"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [w]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [w]) -&gt; String -&gt; [w]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Impossible! step3Body received a list of length &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[w] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161231"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, iteration: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161230"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>         </span><span class="hs-comment">-- Step 3 simply folds the body for the required loop-count</span><span>
</span><span id="line-243"></span><span>         </span><span id="local-6989586621681161228"><span class="annot"><span class="annottext">step3 :: [w]
</span><a href="#local-6989586621681161228"><span class="hs-identifier hs-var hs-var">step3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([w] -&gt; Int -&gt; [w]) -&gt; [w] -&gt; [Int] -&gt; [w]
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">[w] -&gt; Int -&gt; [w]
</span><a href="#local-6989586621681161243"><span class="hs-identifier hs-var">step3Body</span></a></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161252"><span class="hs-identifier hs-var">hPrev</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161249"><span class="hs-identifier hs-var">lim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>         </span><span class="hs-comment">-- Step 4</span><span>
</span><span id="line-246"></span><span>         </span><span id="local-6989586621681161250"><span class="annot"><span class="annottext">step4 :: [w]
</span><a href="#local-6989586621681161250"><span class="hs-identifier hs-var hs-var">step4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; w) -&gt; [w] -&gt; [w] -&gt; [w]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161228"><span class="hs-identifier hs-var">step3</span></a></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161252"><span class="hs-identifier hs-var">hPrev</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Compute the hash of a given string using the specified parameterized hash algorithm.</span><span>
</span><span id="line-249"></span><span id="local-6989586621681161372"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-type">shaP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681161372"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621681161372"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#ByteConverter"><span class="hs-identifier hs-type">ByteConverter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161372"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161372"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161372"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-250"></span><span id="shaP"><span class="annot"><span class="annottext">shaP :: SHA w -&gt; String -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-var hs-var">shaP</span></a></span></span><span> </span><span id="local-6989586621681161224"><span class="annot"><span class="annottext">p :: SHA w
</span><a href="#local-6989586621681161224"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#SHA"><span class="hs-identifier hs-type">SHA</span></a></span><span class="hs-special">{</span><span id="local-6989586621681161223"><span class="annot"><span class="annottext">[w]
h0 :: [w]
h0 :: forall w. SHA w -&gt; [w]
</span><a href="#local-6989586621681161223"><span class="hs-identifier hs-var hs-var">h0</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([w] -&gt; Block w -&gt; [w]) -&gt; [w] -&gt; [Block w] -&gt; [w]
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA w -&gt; [w] -&gt; Block w -&gt; [w]
forall w. (Num w, Bits w) =&gt; SHA w -&gt; [w] -&gt; Block w -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#hashBlock"><span class="hs-identifier hs-var">hashBlock</span></a></span><span> </span><span class="annot"><span class="annottext">SHA w
</span><a href="#local-6989586621681161224"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621681161223"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">([Block w] -&gt; [w]) -&gt; (String -&gt; [Block w]) -&gt; String -&gt; [w]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SHA w -&gt; String -&gt; [Block w]
forall w. (Num w, ByteConverter w) =&gt; SHA w -&gt; String -&gt; [Block w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#prepareMessage"><span class="hs-identifier hs-var">prepareMessage</span></a></span><span> </span><span class="annot"><span class="annottext">SHA w
</span><a href="#local-6989586621681161224"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- * Computing the digest</span><span>
</span><span id="line-254"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | SHA224 digest.</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha224"><span class="hs-identifier hs-type">sha224</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">224</span></span><span>
</span><span id="line-258"></span><span id="sha224"><span class="annot"><span class="annottext">sha224 :: String -&gt; SWord 224
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha224"><span class="hs-identifier hs-var hs-var">sha224</span></a></span></span><span> </span><span id="local-6989586621681161221"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161221"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161220"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SBV (WordN 192) -&gt; SBV (WordN (32 + 192))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161218"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SBV (WordN 160) -&gt; SBV (WordN (32 + 160))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161217"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SWord 128 -&gt; SBV (WordN (32 + 128))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161216"><span class="hs-identifier hs-var">h3</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SBV (WordN 96) -&gt; SBV (WordN (32 + 96))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161215"><span class="hs-identifier hs-var">h4</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SWord 64 -&gt; SBV (WordN (32 + 64))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161214"><span class="hs-identifier hs-var">h5</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SWord 32 -&gt; SBV (WordN (32 + 32))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161213"><span class="hs-identifier hs-var">h6</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681161220"><span class="annot"><span class="annottext">h0 :: SWord 32
</span><a href="#local-6989586621681161220"><span class="hs-identifier hs-var">h0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161218"><span class="annot"><span class="annottext">h1 :: SWord 32
</span><a href="#local-6989586621681161218"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161217"><span class="annot"><span class="annottext">h2 :: SWord 32
</span><a href="#local-6989586621681161217"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161216"><span class="annot"><span class="annottext">h3 :: SWord 32
</span><a href="#local-6989586621681161216"><span class="hs-identifier hs-var">h3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161215"><span class="annot"><span class="annottext">h4 :: SWord 32
</span><a href="#local-6989586621681161215"><span class="hs-identifier hs-var">h4</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161214"><span class="annot"><span class="annottext">h5 :: SWord 32
</span><a href="#local-6989586621681161214"><span class="hs-identifier hs-var">h5</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161213"><span class="annot"><span class="annottext">h6 :: SWord 32
</span><a href="#local-6989586621681161213"><span class="hs-identifier hs-var">h6</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32) -&gt; String -&gt; [SWord 32]
forall w.
(Num w, Bits w, ByteConverter w) =&gt;
SHA w -&gt; String -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-var">shaP</span></a></span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha224P"><span class="hs-identifier hs-var">sha224P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161221"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | SHA256 digest.</span><span>
</span><span id="line-262"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha256"><span class="hs-identifier hs-type">sha256</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span>
</span><span id="line-263"></span><span id="sha256"><span class="annot"><span class="annottext">sha256 :: String -&gt; SWord 256
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha256"><span class="hs-identifier hs-var hs-var">sha256</span></a></span></span><span> </span><span id="local-6989586621681161211"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161211"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161210"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SWord 224 -&gt; SBV (WordN (32 + 224))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161209"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SBV (WordN 192) -&gt; SBV (WordN (32 + 192))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161208"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SBV (WordN 160) -&gt; SBV (WordN (32 + 160))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161207"><span class="hs-identifier hs-var">h3</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SWord 128 -&gt; SBV (WordN (32 + 128))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161206"><span class="hs-identifier hs-var">h4</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SBV (WordN 96) -&gt; SBV (WordN (32 + 96))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161205"><span class="hs-identifier hs-var">h5</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SWord 64 -&gt; SBV (WordN (32 + 64))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161204"><span class="hs-identifier hs-var">h6</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; SWord 32 -&gt; SBV (WordN (32 + 32))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161203"><span class="hs-identifier hs-var">h7</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681161210"><span class="annot"><span class="annottext">h0 :: SWord 32
</span><a href="#local-6989586621681161210"><span class="hs-identifier hs-var">h0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161209"><span class="annot"><span class="annottext">h1 :: SWord 32
</span><a href="#local-6989586621681161209"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161208"><span class="annot"><span class="annottext">h2 :: SWord 32
</span><a href="#local-6989586621681161208"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161207"><span class="annot"><span class="annottext">h3 :: SWord 32
</span><a href="#local-6989586621681161207"><span class="hs-identifier hs-var">h3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161206"><span class="annot"><span class="annottext">h4 :: SWord 32
</span><a href="#local-6989586621681161206"><span class="hs-identifier hs-var">h4</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161205"><span class="annot"><span class="annottext">h5 :: SWord 32
</span><a href="#local-6989586621681161205"><span class="hs-identifier hs-var">h5</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161204"><span class="annot"><span class="annottext">h6 :: SWord 32
</span><a href="#local-6989586621681161204"><span class="hs-identifier hs-var">h6</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161203"><span class="annot"><span class="annottext">h7 :: SWord 32
</span><a href="#local-6989586621681161203"><span class="hs-identifier hs-var">h7</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32) -&gt; String -&gt; [SWord 32]
forall w.
(Num w, Bits w, ByteConverter w) =&gt;
SHA w -&gt; String -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-var">shaP</span></a></span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha256P"><span class="hs-identifier hs-var">sha256P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161211"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | SHA384 digest.</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha384"><span class="hs-identifier hs-type">sha384</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">384</span></span><span>
</span><span id="line-268"></span><span id="sha384"><span class="annot"><span class="annottext">sha384 :: String -&gt; SWord 384
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha384"><span class="hs-identifier hs-var hs-var">sha384</span></a></span></span><span> </span><span id="local-6989586621681161201"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161201"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161200"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 320) -&gt; SBV (WordN (64 + 320))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161199"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 256 -&gt; SBV (WordN (64 + 256))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161198"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 192) -&gt; SBV (WordN (64 + 192))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161197"><span class="hs-identifier hs-var">h3</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 128 -&gt; SBV (WordN (64 + 128))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161196"><span class="hs-identifier hs-var">h4</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 64 -&gt; SBV (WordN (64 + 64))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161195"><span class="hs-identifier hs-var">h5</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681161200"><span class="annot"><span class="annottext">h0 :: SWord 64
</span><a href="#local-6989586621681161200"><span class="hs-identifier hs-var">h0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161199"><span class="annot"><span class="annottext">h1 :: SWord 64
</span><a href="#local-6989586621681161199"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161198"><span class="annot"><span class="annottext">h2 :: SWord 64
</span><a href="#local-6989586621681161198"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161197"><span class="annot"><span class="annottext">h3 :: SWord 64
</span><a href="#local-6989586621681161197"><span class="hs-identifier hs-var">h3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161196"><span class="annot"><span class="annottext">h4 :: SWord 64
</span><a href="#local-6989586621681161196"><span class="hs-identifier hs-var">h4</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161195"><span class="annot"><span class="annottext">h5 :: SWord 64
</span><a href="#local-6989586621681161195"><span class="hs-identifier hs-var">h5</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64) -&gt; String -&gt; [SWord 64]
forall w.
(Num w, Bits w, ByteConverter w) =&gt;
SHA w -&gt; String -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-var">shaP</span></a></span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha384P"><span class="hs-identifier hs-var">sha384P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161201"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | SHA512 digest.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512"><span class="hs-identifier hs-type">sha512</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">512</span></span><span>
</span><span id="line-273"></span><span id="sha512"><span class="annot"><span class="annottext">sha512 :: String -&gt; SWord 512
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512"><span class="hs-identifier hs-var hs-var">sha512</span></a></span></span><span> </span><span id="local-6989586621681161193"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161193"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161192"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 448) -&gt; SBV (WordN (64 + 448))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161191"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 384 -&gt; SBV (WordN (64 + 384))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161190"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 320) -&gt; SBV (WordN (64 + 320))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161189"><span class="hs-identifier hs-var">h3</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 256 -&gt; SBV (WordN (64 + 256))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161188"><span class="hs-identifier hs-var">h4</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 192) -&gt; SBV (WordN (64 + 192))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161187"><span class="hs-identifier hs-var">h5</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 128 -&gt; SBV (WordN (64 + 128))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161186"><span class="hs-identifier hs-var">h6</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 64 -&gt; SBV (WordN (64 + 64))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161185"><span class="hs-identifier hs-var">h7</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681161192"><span class="annot"><span class="annottext">h0 :: SWord 64
</span><a href="#local-6989586621681161192"><span class="hs-identifier hs-var">h0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161191"><span class="annot"><span class="annottext">h1 :: SWord 64
</span><a href="#local-6989586621681161191"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161190"><span class="annot"><span class="annottext">h2 :: SWord 64
</span><a href="#local-6989586621681161190"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161189"><span class="annot"><span class="annottext">h3 :: SWord 64
</span><a href="#local-6989586621681161189"><span class="hs-identifier hs-var">h3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161188"><span class="annot"><span class="annottext">h4 :: SWord 64
</span><a href="#local-6989586621681161188"><span class="hs-identifier hs-var">h4</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161187"><span class="annot"><span class="annottext">h5 :: SWord 64
</span><a href="#local-6989586621681161187"><span class="hs-identifier hs-var">h5</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161186"><span class="annot"><span class="annottext">h6 :: SWord 64
</span><a href="#local-6989586621681161186"><span class="hs-identifier hs-var">h6</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161185"><span class="annot"><span class="annottext">h7 :: SWord 64
</span><a href="#local-6989586621681161185"><span class="hs-identifier hs-var">h7</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64) -&gt; String -&gt; [SWord 64]
forall w.
(Num w, Bits w, ByteConverter w) =&gt;
SHA w -&gt; String -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-var">shaP</span></a></span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512P"><span class="hs-identifier hs-var">sha512P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161193"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | SHA512_224 digest.</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_224"><span class="hs-identifier hs-type">sha512_224</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">224</span></span><span>
</span><span id="line-278"></span><span id="sha512_224"><span class="annot"><span class="annottext">sha512_224 :: String -&gt; SWord 224
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_224"><span class="hs-identifier hs-var hs-var">sha512_224</span></a></span></span><span> </span><span id="local-6989586621681161183"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161183"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161182"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 160) -&gt; SBV (WordN (64 + 160))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161181"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 96) -&gt; SBV (WordN (64 + 96))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161180"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 32 -&gt; SBV (WordN (64 + 32))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 32
</span><a href="#local-6989586621681161179"><span class="hs-identifier hs-var">h3Top</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681161182"><span class="annot"><span class="annottext">h0 :: SWord 64
</span><a href="#local-6989586621681161182"><span class="hs-identifier hs-var">h0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161181"><span class="annot"><span class="annottext">h1 :: SWord 64
</span><a href="#local-6989586621681161181"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161180"><span class="annot"><span class="annottext">h2 :: SWord 64
</span><a href="#local-6989586621681161180"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161178"><span class="annot"><span class="annottext">h3 :: SWord 64
</span><a href="#local-6989586621681161178"><span class="hs-identifier hs-var">h3</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64) -&gt; String -&gt; [SWord 64]
forall w.
(Num w, Bits w, ByteConverter w) =&gt;
SHA w -&gt; String -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-var">shaP</span></a></span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_224P"><span class="hs-identifier hs-var">sha512_224P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161183"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-280"></span><span>        </span><span id="local-6989586621681161179"><span class="annot"><span class="annottext">h3Top :: SBV (WordN ((63 - 32) + 1))
</span><a href="#local-6989586621681161179"><span class="hs-identifier hs-var hs-var">h3Top</span></a></span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 63 -&gt; Proxy 32 -&gt; SWord 64 -&gt; SBV (WordN ((63 - 32) + 1))
forall (i :: Nat) (j :: Nat) (n :: Nat) (bv :: Nat -&gt; *)
       (proxy :: Nat -&gt; *).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat i, KnownNat j,
 (i + 1) &lt;= n, j &lt;= i, IsNonZero ((i - j) + 1)) =&gt;
proxy i -&gt; proxy j -&gt; SBV (bv n) -&gt; SBV (bv ((i - j) + 1))
</span><a href="Data.SBV.Core.Sized.html#bvExtract"><span class="hs-identifier hs-var">bvExtract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy 63
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">63</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy 32
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161178"><span class="hs-identifier hs-var">h3</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | SHA512_256 digest.</span><span>
</span><span id="line-283"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_256"><span class="hs-identifier hs-type">sha512_256</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Sized.html#SWord"><span class="hs-identifier hs-type">SWord</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span>
</span><span id="line-284"></span><span id="sha512_256"><span class="annot"><span class="annottext">sha512_256 :: String -&gt; SWord 256
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_256"><span class="hs-identifier hs-var hs-var">sha512_256</span></a></span></span><span> </span><span id="local-6989586621681161174"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161174"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161173"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SBV (WordN 192) -&gt; SBV (WordN (64 + 192))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161172"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 128 -&gt; SBV (WordN (64 + 128))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161171"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64 -&gt; SWord 64 -&gt; SBV (WordN (64 + 64))
forall (n :: Nat) (bv :: Nat -&gt; *) (m :: Nat).
(KnownNat n, IsNonZero n, SymVal (bv n), KnownNat m, IsNonZero m,
 SymVal (bv m)) =&gt;
SBV (bv n) -&gt; SBV (bv m) -&gt; SBV (bv (n + m))
</span><a href="Data.SBV.Core.Sized.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">SWord 64
</span><a href="#local-6989586621681161170"><span class="hs-identifier hs-var">h3</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681161173"><span class="annot"><span class="annottext">h0 :: SWord 64
</span><a href="#local-6989586621681161173"><span class="hs-identifier hs-var">h0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161172"><span class="annot"><span class="annottext">h1 :: SWord 64
</span><a href="#local-6989586621681161172"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161171"><span class="annot"><span class="annottext">h2 :: SWord 64
</span><a href="#local-6989586621681161171"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161170"><span class="annot"><span class="annottext">h3 :: SWord 64
</span><a href="#local-6989586621681161170"><span class="hs-identifier hs-var">h3</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64) -&gt; String -&gt; [SWord 64]
forall w.
(Num w, Bits w, ByteConverter w) =&gt;
SHA w -&gt; String -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#shaP"><span class="hs-identifier hs-var">shaP</span></a></span><span> </span><span class="annot"><span class="annottext">SHA (SWord 64)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_256P"><span class="hs-identifier hs-var">sha512_256P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161174"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- * Testing</span><span>
</span><span id="line-289"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Collection of known answer tests for SHA. Since these tests take too long during regular</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- regression runs, we pass as an argument how many to run. Increase the below number to 24 to run all tests.</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- We have:</span><span>
</span><span id="line-294"></span><span class="hs-comment">--</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- &gt;&gt;&gt; knownAnswerTests 1</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-297"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#knownAnswerTests"><span class="hs-identifier hs-type">knownAnswerTests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-298"></span><span id="knownAnswerTests"><span class="annot"><span class="annottext">knownAnswerTests :: Int -&gt; Bool
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#knownAnswerTests"><span class="hs-identifier hs-var hs-var">knownAnswerTests</span></a></span></span><span> </span><span id="local-6989586621681161168"><span class="annot"><span class="annottext">nTest :: Int
</span><a href="#local-6989586621681161168"><span class="hs-identifier hs-var">nTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; [Bool] -&gt; [Bool]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161168"><span class="hs-identifier hs-var">nTest</span></a></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; [Bool]) -&gt; [Bool] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SWord 224 -&gt; String
forall a. (Show a, Integral a, SymVal a) =&gt; SBV a -&gt; String
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-var">showHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SWord 224
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha224"><span class="hs-identifier hs-var">sha224</span></a></span><span>     </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161164"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161163"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161164"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621681161164"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161163"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621681161163"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621681161162"><span class="hs-identifier hs-var">sha224Kats</span></a></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>                                           </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SWord 256 -&gt; String
forall a. (Show a, Integral a, SymVal a) =&gt; SBV a -&gt; String
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-var">showHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SWord 256
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha256"><span class="hs-identifier hs-var">sha256</span></a></span><span>     </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161161"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161160"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161161"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621681161161"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161160"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621681161160"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621681161159"><span class="hs-identifier hs-var">sha256Kats</span></a></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>                                           </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SWord 384 -&gt; String
forall a. (Show a, Integral a, SymVal a) =&gt; SBV a -&gt; String
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-var">showHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SWord 384
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha384"><span class="hs-identifier hs-var">sha384</span></a></span><span>     </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161158"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161157"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161158"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621681161158"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161157"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621681161157"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621681161156"><span class="hs-identifier hs-var">sha384Kats</span></a></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>                                           </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SWord 512 -&gt; String
forall a. (Show a, Integral a, SymVal a) =&gt; SBV a -&gt; String
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-var">showHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SWord 512
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512"><span class="hs-identifier hs-var">sha512</span></a></span><span>     </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161155"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161154"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161155"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621681161155"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161154"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621681161154"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621681161153"><span class="hs-identifier hs-var">sha512Kats</span></a></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>                                           </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SWord 224 -&gt; String
forall a. (Show a, Integral a, SymVal a) =&gt; SBV a -&gt; String
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-var">showHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SWord 224
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_224"><span class="hs-identifier hs-var">sha512_224</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161152"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161151"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161152"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621681161152"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161151"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621681161151"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621681161150"><span class="hs-identifier hs-var">sha512_224Kats</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>                                           </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SWord 256 -&gt; String
forall a. (Show a, Integral a, SymVal a) =&gt; SBV a -&gt; String
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-var">showHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SWord 256
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha512_256"><span class="hs-identifier hs-var">sha512_256</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161149"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161148"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161149"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621681161149"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161148"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621681161148"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621681161147"><span class="hs-identifier hs-var">sha512_256Kats</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- | From &lt;http://github.com/bcgit/bc-java/blob/master/core/src/test/java/org/bouncycastle/crypto/test/SHA224DigestTest.java&gt;</span><span>
</span><span id="line-306"></span><span>        </span><span class="annot"><a href="#local-6989586621681161162"><span class="hs-identifier hs-type">sha224Kats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>        </span><span id="local-6989586621681161162"><span class="annot"><span class="annottext">sha224Kats :: [(String, String)]
</span><a href="#local-6989586621681161162"><span class="hs-identifier hs-var hs-var">sha224Kats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>                                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;d14a028c2a3a2bc9476102bb288234c415a2b01f828ea62ac5b3e42f&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;a&quot;</span></span><span>                                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;abd37534c7d9a2efb9465de931cd7055ffdb8879563ae98078d6d6d5&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abc&quot;</span></span><span>                                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;75388b16512776cc5dba5da1fd890150b0c6455cb4f58b1952522525&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-comment">-- | From: &lt;http://github.com/bcgit/bc-java/blob/master/core/src/test/java/org/bouncycastle/crypto/test/SHA256DigestTest.java&gt;</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><a href="#local-6989586621681161159"><span class="hs-identifier hs-type">sha256Kats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-315"></span><span>        </span><span id="local-6989586621681161159"><span class="annot"><span class="annottext">sha256Kats :: [(String, String)]
</span><a href="#local-6989586621681161159"><span class="hs-identifier hs-var hs-var">sha256Kats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>                                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;a&quot;</span></span><span>                                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abc&quot;</span></span><span>                                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;248d6a61d20638b8e5c026930c3e6039a33ce45964ff2167f6ecedd419db06c1&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-comment">-- | From: &lt;http://github.com/bcgit/bc-java/blob/master/core/src/test/java/org/bouncycastle/crypto/test/SHA384DigestTest.java&gt;</span><span>
</span><span id="line-322"></span><span>        </span><span class="annot"><a href="#local-6989586621681161156"><span class="hs-identifier hs-type">sha384Kats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>        </span><span id="local-6989586621681161156"><span class="annot"><span class="annottext">sha384Kats :: [(String, String)]
</span><a href="#local-6989586621681161156"><span class="hs-identifier hs-var hs-var">sha384Kats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>                                                                                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da274edebfe76f65fbd51ad2f14898b95b&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;a&quot;</span></span><span>                                                                                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;54a59b9f22b0b80880d8427e548b7c23abd873486e1f035dce9cd697e85175033caa88e6d57bc35efae0b5afd3145f31&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abc&quot;</span></span><span>                                                                                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;cb00753f45a35e8bb5a03d699ac65007272c32ab0eded1631a8b605a43ff5bed8086072ba1e7cc2358baeca134c825a7&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;09330c33f71147e83d192fc782cd1b4753111b173b3b05d22fa08086e3b0f712fcc7c71a557e2db966c3e9fa91746039&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-comment">-- | From: &lt;http://github.com/bcgit/bc-java/blob/master/core/src/test/java/org/bouncycastle/crypto/test/SHA512DigestTest.java&gt;</span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><a href="#local-6989586621681161153"><span class="hs-identifier hs-type">sha512Kats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>        </span><span id="local-6989586621681161153"><span class="annot"><span class="annottext">sha512Kats :: [(String, String)]
</span><a href="#local-6989586621681161153"><span class="hs-identifier hs-var hs-var">sha512Kats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>                                                                                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;a&quot;</span></span><span>                                                                                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abc&quot;</span></span><span>                                                                                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;8e959b75dae313da8cf4f72814fc143f8f7779c6eb9f7fa17299aeadb6889018501d289e4900f7e4331b99dec4b5433ac7d329eeb6dd26545e96e55b874be909&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-comment">-- | From: &lt;http://github.com/bcgit/bc-java/blob/master/core/src/test/java/org/bouncycastle/crypto/test/SHA512t224DigestTest.java&gt;</span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><a href="#local-6989586621681161150"><span class="hs-identifier hs-type">sha512_224Kats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>        </span><span id="local-6989586621681161150"><span class="annot"><span class="annottext">sha512_224Kats :: [(String, String)]
</span><a href="#local-6989586621681161150"><span class="hs-identifier hs-var hs-var">sha512_224Kats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>                                                                                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;6ed0dd02806fa89e25de060c19d3ac86cabb87d6a0ddd05c333b84f4&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;a&quot;</span></span><span>                                                                                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;d5cdb9ccc769a5121d4175f2bfdd13d6310e0d3d361ea75d82108327&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abc&quot;</span></span><span>                                                                                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;4634270F707B6A54DAAE7530460842E20E37ED265CEEE9A43E8924AA&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;23FEC5BB94D60B23308192640B0C453335D664734FE40E7268674AF9&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>                         </span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-comment">-- | From: &lt;http://github.com/bcgit/bc-java/blob/master/core/src/test/java/org/bouncycastle/crypto/test/SHA512t256DigestTest.java&gt;</span><span>
</span><span id="line-346"></span><span>        </span><span class="annot"><a href="#local-6989586621681161147"><span class="hs-identifier hs-type">sha512_256Kats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621681161147"><span class="annot"><span class="annottext">sha512_256Kats :: [(String, String)]
</span><a href="#local-6989586621681161147"><span class="hs-identifier hs-var hs-var">sha512_256Kats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>                                                                                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;c672b8d1ef56ed28ab87c3622c5114069bdd3ad7b8f9737498d0c01ecef0967a&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;a&quot;</span></span><span>                                                                                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;455e518824bc0601f9fb858ff5c37d417d67c2f8e0df2babe4808858aea830f8&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abc&quot;</span></span><span>                                                                                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;53048E2681941EF99B2E29B76B4C7DABE4C2D0C634FC6D46E0E2F13107E7AF23&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;3928E184FB8690F840DA3988121D31BE65CB9D3EF83EE6146FEAC861E19B563A&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>                         </span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- * Code generation</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- ${codeGenIntro}</span><span>
</span><span id="line-356"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-357"></span><span class="hs-comment">{- $codeGenIntro
   It is not practical to generate SBV code for hashing an entire string, as it would
   require handling of a fixed size string. Instead we show how to generate code
   for hashing one block, which can then be incorporated into a larger program
   by providing the appropriate loop.
-}</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Generate code for one block of SHA256 in action, starting from an arbitrary hash value.</span><span>
</span><span id="line-365"></span><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#cgSHA256"><span class="hs-identifier hs-type">cgSHA256</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span id="cgSHA256"><span class="annot"><span class="annottext">cgSHA256 :: IO ()
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#cgSHA256"><span class="hs-identifier hs-var hs-var">cgSHA256</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; SBVCodeGen () -&gt; IO ()
forall a. Maybe String -&gt; String -&gt; SBVCodeGen a -&gt; IO a
</span><a href="Data.SBV.Compilers.C.html#compileToC"><span class="hs-identifier hs-var">compileToC</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="hs-string">&quot;sha256&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SBVCodeGen () -&gt; IO ()) -&gt; SBVCodeGen () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681161144"><span class="annot"><span class="annottext">algorithm :: SHA (SWord 32)
</span><a href="#local-6989586621681161144"><span class="hs-identifier hs-var hs-var">algorithm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32)
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#sha256P"><span class="hs-identifier hs-var">sha256P</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621681161143"><span class="annot"><span class="annottext">[SWord 8]
</span><a href="#local-6989586621681161143"><span class="hs-identifier hs-var">hInBytes</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; SBVCodeGen [SWord 8]
forall a. SymVal a =&gt; Int -&gt; String -&gt; SBVCodeGen [SBV a]
</span><a href="Data.SBV.Compilers.CodeGen.html#cgInputArr"><span class="hs-identifier hs-var">cgInputArr</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="hs-string">&quot;hIn&quot;</span></span><span>
</span><span id="line-371"></span><span>        </span><span id="local-6989586621681161141"><span class="annot"><span class="annottext">[SWord 8]
</span><a href="#local-6989586621681161141"><span class="hs-identifier hs-var">blockBytes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; SBVCodeGen [SWord 8]
forall a. SymVal a =&gt; Int -&gt; String -&gt; SBVCodeGen [SBV a]
</span><a href="Data.SBV.Compilers.CodeGen.html#cgInputArr"><span class="hs-identifier hs-var">cgInputArr</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="hs-string">&quot;block&quot;</span></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681161140"><span class="annot"><span class="annottext">hIn :: [SWord 32]
</span><a href="#local-6989586621681161140"><span class="hs-identifier hs-var hs-var">hIn</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ([SWord 8] -&gt; SWord 32) -&gt; [SWord 8] -&gt; [SWord 32]
forall a b. Int -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#chunkBy"><span class="hs-identifier hs-var">chunkBy</span></a></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">[SWord 8] -&gt; SWord 32
forall a. ByteConverter a =&gt; [SWord 8] -&gt; a
</span><a href="Data.SBV.Core.Sized.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">[SWord 8]
</span><a href="#local-6989586621681161143"><span class="hs-identifier hs-var">hInBytes</span></a></span><span>
</span><span id="line-374"></span><span>            </span><span id="local-6989586621681161139"><span class="annot"><span class="annottext">block :: [SWord 32]
</span><a href="#local-6989586621681161139"><span class="hs-identifier hs-var hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ([SWord 8] -&gt; SWord 32) -&gt; [SWord 8] -&gt; [SWord 32]
forall a b. Int -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#chunkBy"><span class="hs-identifier hs-var">chunkBy</span></a></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">[SWord 8] -&gt; SWord 32
forall a. ByteConverter a =&gt; [SWord 8] -&gt; a
</span><a href="Data.SBV.Core.Sized.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">[SWord 8]
</span><a href="#local-6989586621681161141"><span class="hs-identifier hs-var">blockBytes</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>            </span><span id="local-6989586621681161138"><span class="annot"><span class="annottext">result :: [SWord 32]
</span><a href="#local-6989586621681161138"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32) -&gt; [SWord 32] -&gt; Block (SWord 32) -&gt; [SWord 32]
forall w. (Num w, Bits w) =&gt; SHA w -&gt; [w] -&gt; Block w -&gt; [w]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#hashBlock"><span class="hs-identifier hs-var">hashBlock</span></a></span><span> </span><span class="annot"><span class="annottext">SHA (SWord 32)
</span><a href="#local-6989586621681161144"><span class="hs-identifier hs-var">algorithm</span></a></span><span> </span><span class="annot"><span class="annottext">[SWord 32]
</span><a href="#local-6989586621681161140"><span class="hs-identifier hs-var">hIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SWord 32] -&gt; Block (SWord 32)
forall a. [a] -&gt; Block a
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">[SWord 32]
</span><a href="#local-6989586621681161139"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; [SWord 8] -&gt; SBVCodeGen ()
forall a. SymVal a =&gt; String -&gt; [SBV a] -&gt; SBVCodeGen ()
</span><a href="Data.SBV.Compilers.CodeGen.html#cgOutputArr"><span class="hs-identifier hs-var">cgOutputArr</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;hash&quot;</span></span><span> </span><span class="annot"><span class="annottext">([SWord 8] -&gt; SBVCodeGen ()) -&gt; [SWord 8] -&gt; SBVCodeGen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SWord 32 -&gt; [SWord 8]) -&gt; [SWord 32] -&gt; [SWord 8]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SWord 32 -&gt; [SWord 8]
forall a. ByteConverter a =&gt; a -&gt; [SWord 8]
</span><a href="Data.SBV.Core.Sized.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="annot"><span class="annottext">[SWord 32]
</span><a href="#local-6989586621681161138"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- * Helpers</span><span>
</span><span id="line-382"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | Helper for chunking a list by given lengths and combining each chunk with a function</span><span>
</span><span id="line-385"></span><span id="local-6989586621681161413"><span id="local-6989586621681161414"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#chunkBy"><span class="hs-identifier hs-type">chunkBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161414"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681161413"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161414"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681161413"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-386"></span><span id="chunkBy"><span class="annot"><span class="annottext">chunkBy :: Int -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#chunkBy"><span class="hs-identifier hs-var hs-var">chunkBy</span></a></span></span><span> </span><span id="local-6989586621681161135"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621681161135"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681161134"><span class="annot"><span class="annottext">f :: [a] -&gt; b
</span><a href="#local-6989586621681161134"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [b]
</span><a href="#local-6989586621681161133"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681161133"><span class="annot"><span class="annottext">go :: [a] -&gt; [b]
</span><a href="#local-6989586621681161133"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><a href="#local-6989586621681161133"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681161132"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621681161132"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-389"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681161131"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161135"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [b]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [b]) -&gt; String -&gt; [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;chunkBy: Not a multiple of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161135"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681161131"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; b
</span><a href="#local-6989586621681161134"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681161131"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [b]
</span><a href="#local-6989586621681161133"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681161129"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-391"></span><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681161131"><span class="annot"><span class="annottext">first :: [a]
</span><a href="#local-6989586621681161131"><span class="hs-identifier hs-var">first</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681161129"><span class="annot"><span class="annottext">rest :: [a]
</span><a href="#local-6989586621681161129"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161135"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681161132"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Nicely lay out a hash value as a string</span><span>
</span><span id="line-394"></span><span id="local-6989586621681161360"><span class="annot"><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-type">showHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621681161360"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621681161360"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SymVal"><span class="hs-identifier hs-type">SymVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161360"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681161360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-395"></span><span id="showHash"><span class="annot"><span class="annottext">showHash :: SBV a -&gt; String
</span><a href="Documentation.SBV.Examples.Crypto.SHA.html#showHash"><span class="hs-identifier hs-var hs-var">showHash</span></a></span></span><span> </span><span id="local-6989586621681161127"><span class="annot"><span class="annottext">x :: SBV a
</span><a href="#local-6989586621681161127"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV a -&gt; Kind
forall a. HasKind a =&gt; a -&gt; Kind
</span><a href="Data.SBV.Core.Kind.html#kindOf"><span class="hs-identifier hs-var">kindOf</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681161127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; Maybe a
forall a. SymVal a =&gt; SBV a -&gt; Maybe a
</span><a href="Data.SBV.Core.Data.html#unliteral"><span class="hs-identifier hs-var">unliteral</span></a></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681161127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-396"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Kind.html#KBounded"><span class="hs-identifier hs-type">KBounded</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span id="local-6989586621681161123"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621681161123"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681161122"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621681161122"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
</span><a href="#local-6989586621681161121"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161123"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; String
forall a. (Integral a, Show a) =&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showHex</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681161122"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-397"></span><span>               </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Impossible happened: Unexpected hash value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SBV a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SBV a
</span><a href="#local-6989586621681161127"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681161121"><span class="annot"><span class="annottext">pad :: Int -&gt; String -&gt; String
</span><a href="#local-6989586621681161121"><span class="hs-identifier hs-var hs-var">pad</span></a></span></span><span> </span><span id="local-6989586621681161120"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621681161120"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681161119"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681161119"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681161120"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681161119"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="hs-char">'0'</span></span><span>
</span><span id="line-399"></span></pre></body></html>