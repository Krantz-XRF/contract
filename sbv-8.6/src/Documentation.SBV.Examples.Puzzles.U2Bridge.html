<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_CvBtJg9zXJ7EshuNqzeTCp"><span id="%24con2tag_3VycaeHUayi05hRB7ROvdU"></span></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module    : Documentation.SBV.Examples.Puzzles.U2Bridge</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright : (c) Levent Erkok</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer: erkokl@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- The famous U2 bridge crossing puzzle: &lt;http://www.braingle.com/brainteasers/515/u2.html&gt;</span><span>
</span><span id="line-10"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass       #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable   #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric        #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances    #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving   #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell      #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall -Werror #-}</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Documentation.SBV.Examples.Puzzles.U2Bridge</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runState</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortOn</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.SBV.html"><span class="hs-identifier">Data.SBV</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- * Modeling the puzzle</span><span>
</span><span id="line-34"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | U2 band members. We want to translate this to SMT-Lib as a data-type, and hence the</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- call to mkSymbolicEnumeration.</span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="U2Member"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#U2Member"><span class="hs-identifier hs-var">U2Member</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Bono"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Bono"><span class="hs-identifier hs-var">Bono</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Edge"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Edge"><span class="hs-identifier hs-var">Edge</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Adam"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Adam"><span class="hs-identifier hs-var">Adam</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Larry"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Larry"><span class="hs-identifier hs-var">Larry</span></a></span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Make 'U2Member' a symbolic value.</span><span>
</span><span id="line-41"></span><span id="%24cLarry"><span id="%24cAdam"><span id="%24cEdge"><span id="%24cBono"><span id="%24tU2Member"><span id="local-6989586621681167597"><span id="local-6989586621681167599"><span id="local-6989586621681167601"><span id="local-6989586621681167603"><span id="local-6989586621681167605"><span id="local-6989586621681167607"><span id="local-6989586621681167609"><span id="local-6989586621681167611"><span id="local-6989586621681167613"><span id="local-6989586621681167615"><span id="local-6989586621681167617"><span id="local-6989586621681167619"><span id="local-6989586621681167622"><span id="local-6989586621681167624"><span id="local-6989586621681167626"><span id="local-6989586621681167628"><span id="local-6989586621681167630"><span id="local-6989586621681167632"><span id="local-6989586621681167634"><span id="local-6989586621681167636"><span id="local-6989586621681167638"><span id="local-6989586621681167640"><span id="local-6989586621681167642"><span id="local-6989586621681167644"><span id="local-6989586621681167646"><span id="local-6989586621681167648"><span id="local-6989586621681167650"><span id="local-6989586621681167652"><span id="local-6989586621681167654"><span id="local-6989586621681167656"><span id="local-6989586621681167659"><span id="local-6989586621681167661"><span id="local-6989586621681167663"><span id="local-6989586621681167665"><span id="local-6989586621681167667"><span id="local-6989586621681167669"><span id="local-6989586621681167671"><span id="local-6989586621681167673"><span id="local-6989586621681167675"><span id="local-6989586621681167677"><span id="local-6989586621681167679"><span id="local-6989586621681167681"><span id="local-6989586621681167683"><span id="local-6989586621681167685"><span id="local-6989586621681167687"><span id="local-6989586621681167689"><span id="local-6989586621681167691"><span id="local-6989586621681167693"><span id="local-6989586621681167697"><span id="local-6989586621681167699"><span id="local-6989586621681167701"><span id="local-6989586621681167703"><span id="local-6989586621681167705"><span id="local-6989586621681167707"><span id="local-6989586621681167709"><span id="local-6989586621681167711"><span id="local-6989586621681167713"><span id="local-6989586621681167715"><span id="local-6989586621681167717"><span id="local-6989586621681167719"><span id="local-6989586621681167721"><span id="local-6989586621681167723"><span id="local-6989586621681167725"><span id="local-6989586621681167727"><span id="local-6989586621681167729"><span id="local-6989586621681167731"><span id="local-6989586621681167733"><span id="local-6989586621681167735"><span id="local-6989586621681167737"><span class="hs-identifier">mkSymbolicEnumeration</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">U2Member</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Symbolic shorthand for a 'U2Member'</span><span>
</span><span id="line-44"></span><span class="hs-keyword">type</span><span> </span><span id="SU2Member"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-var">SU2Member</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#U2Member"><span class="hs-identifier hs-type">U2Member</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Shorthands for symbolic versions of the members</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bono"><span class="hs-identifier hs-type">bono</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#edge"><span class="hs-identifier hs-type">edge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#adam"><span class="hs-identifier hs-type">adam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#larry"><span class="hs-identifier hs-type">larry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span>
</span><span id="line-48"></span><span class="hs-special">[</span><span id="bono"><span class="annot"><span class="annottext">bono :: SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bono"><span class="hs-identifier hs-var">bono</span></a></span></span><span class="hs-special">,</span><span> </span><span id="edge"><span class="annot"><span class="annottext">edge :: SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#edge"><span class="hs-identifier hs-var">edge</span></a></span></span><span class="hs-special">,</span><span> </span><span id="adam"><span class="annot"><span class="annottext">adam :: SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#adam"><span class="hs-identifier hs-var">adam</span></a></span></span><span class="hs-special">,</span><span> </span><span id="larry"><span class="annot"><span class="annottext">larry :: SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#larry"><span class="hs-identifier hs-var">larry</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(U2Member -&gt; SBV U2Member) -&gt; [U2Member] -&gt; [SBV U2Member]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">U2Member -&gt; SBV U2Member
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Bono"><span class="hs-identifier hs-var">Bono</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Edge"><span class="hs-identifier hs-var">Edge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Adam"><span class="hs-identifier hs-var">Adam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Larry"><span class="hs-identifier hs-var">Larry</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | Model time using 32 bits</span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="Time"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Time"><span class="hs-identifier hs-var">Time</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Symbolic variant for time</span><span>
</span><span id="line-54"></span><span class="hs-keyword">type</span><span> </span><span id="STime"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#STime"><span class="hs-identifier hs-var">STime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | Crossing times for each member of the band</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-type">crossTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#U2Member"><span class="hs-identifier hs-type">U2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span>
</span><span id="line-58"></span><span id="crossTime"><span class="annot"><span class="annottext">crossTime :: U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var hs-var">crossTime</span></a></span></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Bono"><span class="hs-identifier hs-type">Bono</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Adam"><span class="hs-identifier hs-type">Adam</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Larry"><span class="hs-identifier hs-type">Larry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">10</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | The symbolic variant.. The duplication is unfortunate.</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#sCrossTime"><span class="hs-identifier hs-type">sCrossTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#STime"><span class="hs-identifier hs-type">STime</span></a></span><span>
</span><span id="line-65"></span><span id="sCrossTime"><span class="annot"><span class="annottext">sCrossTime :: SBV U2Member -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#sCrossTime"><span class="hs-identifier hs-var hs-var">sCrossTime</span></a></span></span><span> </span><span id="local-6989586621681167574"><span class="annot"><span class="annottext">m :: SBV U2Member
</span><a href="#local-6989586621681167574"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><span class="annottext">SBool -&gt; STime -&gt; STime -&gt; STime
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167574"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bono"><span class="hs-identifier hs-var">bono</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time -&gt; STime
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Bono"><span class="hs-identifier hs-var">Bono</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>               </span><span class="annot"><span class="annottext">(STime -&gt; STime) -&gt; STime -&gt; STime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SBool -&gt; STime -&gt; STime -&gt; STime
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167574"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#edge"><span class="hs-identifier hs-var">edge</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time -&gt; STime
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Edge"><span class="hs-identifier hs-var">Edge</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>               </span><span class="annot"><span class="annottext">(STime -&gt; STime) -&gt; STime -&gt; STime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SBool -&gt; STime -&gt; STime -&gt; STime
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167574"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#adam"><span class="hs-identifier hs-var">adam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time -&gt; STime
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Adam"><span class="hs-identifier hs-var">Adam</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time -&gt; STime
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Larry"><span class="hs-identifier hs-var">Larry</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Must be Larry</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Location of the flash</span><span>
</span><span id="line-71"></span><span class="hs-keyword">data</span><span> </span><span id="Location"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Location"><span class="hs-identifier hs-var">Location</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Here"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Here"><span class="hs-identifier hs-var">Here</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="There"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#There"><span class="hs-identifier hs-var">There</span></a></span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Make 'Location' a symbolic value.</span><span>
</span><span id="line-74"></span><span id="%24cThere"><span id="%24cHere"><span id="%24tLocation"><span id="local-6989586621681167428"><span id="local-6989586621681167430"><span id="local-6989586621681167432"><span id="local-6989586621681167434"><span id="local-6989586621681167436"><span id="local-6989586621681167438"><span id="local-6989586621681167440"><span id="local-6989586621681167442"><span id="local-6989586621681167444"><span id="local-6989586621681167446"><span id="local-6989586621681167448"><span id="local-6989586621681167450"><span id="local-6989586621681167453"><span id="local-6989586621681167455"><span id="local-6989586621681167457"><span id="local-6989586621681167459"><span id="local-6989586621681167461"><span id="local-6989586621681167463"><span id="local-6989586621681167465"><span id="local-6989586621681167467"><span id="local-6989586621681167469"><span id="local-6989586621681167471"><span id="local-6989586621681167473"><span id="local-6989586621681167475"><span id="local-6989586621681167477"><span id="local-6989586621681167479"><span id="local-6989586621681167481"><span id="local-6989586621681167483"><span id="local-6989586621681167485"><span id="local-6989586621681167487"><span id="local-6989586621681167490"><span id="local-6989586621681167492"><span id="local-6989586621681167494"><span id="local-6989586621681167496"><span id="local-6989586621681167498"><span id="local-6989586621681167500"><span id="local-6989586621681167502"><span id="local-6989586621681167504"><span id="local-6989586621681167506"><span id="local-6989586621681167508"><span id="local-6989586621681167510"><span id="local-6989586621681167512"><span id="local-6989586621681167514"><span id="local-6989586621681167516"><span id="local-6989586621681167518"><span id="local-6989586621681167520"><span id="local-6989586621681167522"><span id="local-6989586621681167524"><span id="local-6989586621681167528"><span id="local-6989586621681167530"><span id="local-6989586621681167532"><span id="local-6989586621681167534"><span id="local-6989586621681167536"><span id="local-6989586621681167538"><span id="local-6989586621681167540"><span id="local-6989586621681167542"><span id="local-6989586621681167544"><span id="local-6989586621681167546"><span id="local-6989586621681167548"><span id="local-6989586621681167550"><span id="local-6989586621681167552"><span id="local-6989586621681167554"><span id="local-6989586621681167556"><span id="local-6989586621681167558"><span id="local-6989586621681167560"><span id="local-6989586621681167562"><span id="local-6989586621681167564"><span id="local-6989586621681167566"><span id="local-6989586621681167568"><span class="hs-identifier">mkSymbolicEnumeration</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Location</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Symbolic variant of 'Location'</span><span>
</span><span id="line-77"></span><span class="hs-keyword">type</span><span> </span><span id="SLocation"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-var">SLocation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBV"><span class="hs-identifier hs-type">SBV</span></a></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Shorthands for symbolic versions of locations</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-type">here</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#there"><span class="hs-identifier hs-type">there</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-type">SLocation</span></a></span><span>
</span><span id="line-81"></span><span class="hs-special">[</span><span id="here"><span class="annot"><span class="annottext">here :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span></span><span class="hs-special">,</span><span> </span><span id="there"><span class="annot"><span class="annottext">there :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#there"><span class="hs-identifier hs-var">there</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Location -&gt; SBV Location) -&gt; [Location] -&gt; [SBV Location]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Location -&gt; SBV Location
forall a. SymVal a =&gt; a -&gt; SBV a
</span><a href="Data.SBV.Core.Data.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Here"><span class="hs-identifier hs-var">Here</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#There"><span class="hs-identifier hs-var">There</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | The status of the puzzle after each move</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- This type is equipped with an automatically derived 'Mergeable' instance</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- because each field is 'Mergeable'. A 'Generic' instance must also be derived</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- for this to work, and the @DeriveAnyClass@ language extension must be</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- enabled. The derived 'Mergeable' instance simply walks down the structure</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- field by field and merges each one. An equivalent hand-written 'Mergeable'</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- instance is provided in a comment below.</span><span>
</span><span id="line-91"></span><span id="local-6989586621681167420"><span id="local-6989586621681167421"></span></span><span class="hs-keyword">data</span><span> </span><span id="Status"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Status"><span class="hs-identifier hs-var">Status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Status"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Status"><span class="hs-identifier hs-var">Status</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="time"><span class="annot"><span class="annottext">Status -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#time"><span class="hs-identifier hs-var hs-var">time</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#STime"><span class="hs-identifier hs-type">STime</span></a></span><span>       </span><span class="hs-comment">-- ^ elapsed time</span><span>
</span><span id="line-92"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="flash"><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#flash"><span class="hs-identifier hs-var hs-var">flash</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-type">SLocation</span></a></span><span>   </span><span class="hs-comment">-- ^ location of the flash</span><span>
</span><span id="line-93"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="lBono"><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lBono"><span class="hs-identifier hs-var hs-var">lBono</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-type">SLocation</span></a></span><span>   </span><span class="hs-comment">-- ^ location of Bono</span><span>
</span><span id="line-94"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="lEdge"><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lEdge"><span class="hs-identifier hs-var hs-var">lEdge</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-type">SLocation</span></a></span><span>   </span><span class="hs-comment">-- ^ location of Edge</span><span>
</span><span id="line-95"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="lAdam"><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lAdam"><span class="hs-identifier hs-var hs-var">lAdam</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-type">SLocation</span></a></span><span>   </span><span class="hs-comment">-- ^ location of Adam</span><span>
</span><span id="line-96"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="lLarry"><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lLarry"><span class="hs-identifier hs-var hs-var">lLarry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-type">SLocation</span></a></span><span>   </span><span class="hs-comment">-- ^ location of Larry</span><span>
</span><span id="line-97"></span><span>                     </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Status -&gt; Rep Status x)
-&gt; (forall x. Rep Status x -&gt; Status) -&gt; Generic Status
forall x. Rep Status x -&gt; Status
forall x. Status -&gt; Rep Status x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Status x -&gt; Status
$cfrom :: forall x. Status -&gt; Rep Status x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167406"><span id="local-6989586621681167408"><span class="annot"><span class="annottext">Bool -&gt; SBool -&gt; Status -&gt; Status -&gt; Status
(Bool -&gt; SBool -&gt; Status -&gt; Status -&gt; Status)
-&gt; (forall b.
    (Ord b, SymVal b, Num b) =&gt;
    [Status] -&gt; Status -&gt; SBV b -&gt; Status)
-&gt; Mergeable Status
forall b.
(Ord b, SymVal b, Num b) =&gt;
[Status] -&gt; Status -&gt; SBV b -&gt; Status
forall a.
(Bool -&gt; SBool -&gt; a -&gt; a -&gt; a)
-&gt; (forall b. (Ord b, SymVal b, Num b) =&gt; [a] -&gt; a -&gt; SBV b -&gt; a)
-&gt; Mergeable a
select :: [Status] -&gt; Status -&gt; SBV b -&gt; Status
$cselect :: forall b.
(Ord b, SymVal b, Num b) =&gt;
[Status] -&gt; Status -&gt; SBV b -&gt; Status
symbolicMerge :: Bool -&gt; SBool -&gt; Status -&gt; Status -&gt; Status
$csymbolicMerge :: Bool -&gt; SBool -&gt; Status -&gt; Status -&gt; Status
</span><a href="Data.SBV.Core.Model.html#C%3AMergeable"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Mergeable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- The derived Mergeable instance is equivalent to the following:</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- instance Mergeable Status where</span><span>
</span><span id="line-102"></span><span class="hs-comment">--   symbolicMerge f t s1 s2 = Status { time   = symbolicMerge f t (time   s1) (time   s2)</span><span>
</span><span id="line-103"></span><span class="hs-comment">--                                    , flash  = symbolicMerge f t (flash  s1) (flash  s2)</span><span>
</span><span id="line-104"></span><span class="hs-comment">--                                    , lBono  = symbolicMerge f t (lBono  s1) (lBono  s2)</span><span>
</span><span id="line-105"></span><span class="hs-comment">--                                    , lEdge  = symbolicMerge f t (lEdge  s1) (lEdge  s2)</span><span>
</span><span id="line-106"></span><span class="hs-comment">--                                    , lAdam  = symbolicMerge f t (lAdam  s1) (lAdam  s2)</span><span>
</span><span id="line-107"></span><span class="hs-comment">--                                    , lLarry = symbolicMerge f t (lLarry s1) (lLarry s2)</span><span>
</span><span id="line-108"></span><span class="hs-comment">--                                    }</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | Start configuration, time elapsed is 0 and everybody is 'here'</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#start"><span class="hs-identifier hs-type">start</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Status"><span class="hs-identifier hs-type">Status</span></a></span><span>
</span><span id="line-112"></span><span id="start"><span class="annot"><span class="annottext">start :: Status
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#start"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status :: STime
-&gt; SBV Location
-&gt; SBV Location
-&gt; SBV Location
-&gt; SBV Location
-&gt; SBV Location
-&gt; Status
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Status"><span class="hs-identifier hs-type hs-type">Status</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">time :: STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#time"><span class="hs-identifier hs-var">time</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-113"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flash :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#flash"><span class="hs-identifier hs-var">flash</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span>
</span><span id="line-114"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lBono :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lBono"><span class="hs-identifier hs-var">lBono</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span>
</span><span id="line-115"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lEdge :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lEdge"><span class="hs-identifier hs-var">lEdge</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span>
</span><span id="line-116"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lAdam :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lAdam"><span class="hs-identifier hs-var">lAdam</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span>
</span><span id="line-117"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lLarry :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lLarry"><span class="hs-identifier hs-var">lLarry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span>
</span><span id="line-118"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | A puzzle move is modeled as a state-transformer</span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span id="Move"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-var">Move</span></a></span></span><span> </span><span id="local-6989586621681167402"><span class="annot"><a href="#local-6989586621681167402"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Status"><span class="hs-identifier hs-type">Status</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681167402"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | Mergeable instance for 'Move' simply pushes the merging the data after run of each branch</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- starting from the same state.</span><span>
</span><span id="line-125"></span><span id="local-6989586621681167401"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681167398"><span class="annot"><a href="Data.SBV.Core.Model.html#Mergeable"><span class="hs-identifier hs-type">Mergeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681167401"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Model.html#Mergeable"><span class="hs-identifier hs-type">Mergeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681167401"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621681167397"><span class="annot"><span class="annottext">symbolicMerge :: Bool -&gt; SBool -&gt; Move a -&gt; Move a -&gt; Move a
</span><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var hs-var hs-var hs-var">symbolicMerge</span></a></span></span><span> </span><span id="local-6989586621681167395"><span class="annot"><span class="annottext">f :: Bool
</span><a href="#local-6989586621681167395"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681167394"><span class="annot"><span class="annottext">t :: SBool
</span><a href="#local-6989586621681167394"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681167393"><span class="annot"><span class="annottext">a :: Move a
</span><a href="#local-6989586621681167393"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681167392"><span class="annot"><span class="annottext">b :: Move a
</span><a href="#local-6989586621681167392"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681167391"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167391"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Status Identity Status
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-128"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681167390"><span class="annot"><span class="annottext">ar :: a
</span><a href="#local-6989586621681167390"><span class="hs-identifier hs-var">ar</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167389"><span class="annot"><span class="annottext">s1 :: Status
</span><a href="#local-6989586621681167389"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Move a -&gt; Status -&gt; (a, Status)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">runState</span></span><span> </span><span class="annot"><span class="annottext">Move a
</span><a href="#local-6989586621681167393"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167391"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-129"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621681167388"><span class="annot"><span class="annottext">br :: a
</span><a href="#local-6989586621681167388"><span class="hs-identifier hs-var">br</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167387"><span class="annot"><span class="annottext">s2 :: Status
</span><a href="#local-6989586621681167387"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Move a -&gt; Status -&gt; (a, Status)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">runState</span></span><span> </span><span class="annot"><span class="annottext">Move a
</span><a href="#local-6989586621681167392"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167391"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-130"></span><span>         </span><span class="annot"><span class="annottext">Status -&gt; StateT Status Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">(Status -&gt; StateT Status Identity ())
-&gt; Status -&gt; StateT Status Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SBool -&gt; Status -&gt; Status -&gt; Status
forall a. Mergeable a =&gt; Bool -&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var">symbolicMerge</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167395"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167394"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167389"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167387"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-131"></span><span>         </span><span class="annot"><span class="annottext">a -&gt; Move a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Move a) -&gt; a -&gt; Move a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SBool -&gt; a -&gt; a -&gt; a
forall a. Mergeable a =&gt; Bool -&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#symbolicMerge"><span class="hs-identifier hs-var">symbolicMerge</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167395"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167394"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681167390"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681167388"><span class="hs-identifier hs-var">br</span></a></span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Read the state via an accessor function</span><span>
</span><span id="line-134"></span><span id="local-6989586621681167798"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-type">peek</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Status"><span class="hs-identifier hs-type">Status</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681167798"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681167798"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-135"></span><span id="peek"><span class="annot"><span class="annottext">peek :: (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var hs-var">peek</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Status -&gt; a) -&gt; Move a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Given an arbitrary member, return his location</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whereIs"><span class="hs-identifier hs-type">whereIs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SLocation"><span class="hs-identifier hs-type">SLocation</span></a></span><span>
</span><span id="line-139"></span><span id="whereIs"><span class="annot"><span class="annottext">whereIs :: SBV U2Member -&gt; Move (SBV Location)
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whereIs"><span class="hs-identifier hs-var hs-var">whereIs</span></a></span></span><span> </span><span id="local-6989586621681167384"><span class="annot"><span class="annottext">p :: SBV U2Member
</span><a href="#local-6989586621681167384"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">SBool
-&gt; Move (SBV Location)
-&gt; Move (SBV Location)
-&gt; Move (SBV Location)
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167384"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bono"><span class="hs-identifier hs-var">bono</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; Move (SBV Location)
forall a. (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lBono"><span class="hs-identifier hs-var hs-var">lBono</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>           </span><span class="annot"><span class="annottext">(Move (SBV Location) -&gt; Move (SBV Location))
-&gt; Move (SBV Location) -&gt; Move (SBV Location)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SBool
-&gt; Move (SBV Location)
-&gt; Move (SBV Location)
-&gt; Move (SBV Location)
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167384"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#edge"><span class="hs-identifier hs-var">edge</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; Move (SBV Location)
forall a. (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lEdge"><span class="hs-identifier hs-var hs-var">lEdge</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>           </span><span class="annot"><span class="annottext">(Move (SBV Location) -&gt; Move (SBV Location))
-&gt; Move (SBV Location) -&gt; Move (SBV Location)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SBool
-&gt; Move (SBV Location)
-&gt; Move (SBV Location)
-&gt; Move (SBV Location)
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167384"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#adam"><span class="hs-identifier hs-var">adam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; Move (SBV Location)
forall a. (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lAdam"><span class="hs-identifier hs-var hs-var">lAdam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; Move (SBV Location)
forall a. (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lLarry"><span class="hs-identifier hs-var hs-var">lLarry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Transferring the flash to the other side</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferFlash"><span class="hs-identifier hs-type">xferFlash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span id="xferFlash"><span class="annot"><span class="annottext">xferFlash :: StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferFlash"><span class="hs-identifier hs-var hs-var">xferFlash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Status -&gt; Status) -&gt; StateT Status Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Status -&gt; Status) -&gt; StateT Status Identity ())
-&gt; (Status -&gt; Status) -&gt; StateT Status Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681167382"><span class="annot"><span class="annottext">s :: Status
</span><a href="#local-6989586621681167382"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167382"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">flash :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#flash"><span class="hs-identifier hs-var">flash</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBV Location -&gt; SBV Location -&gt; SBV Location
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#flash"><span class="hs-identifier hs-var hs-var">flash</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167382"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#there"><span class="hs-identifier hs-var">there</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | Transferring a person to the other side</span><span>
</span><span id="line-149"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferPerson"><span class="hs-identifier hs-type">xferPerson</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span id="xferPerson"><span class="annot"><span class="annottext">xferPerson :: SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferPerson"><span class="hs-identifier hs-var hs-var">xferPerson</span></a></span></span><span> </span><span id="local-6989586621681167380"><span class="annot"><span class="annottext">p :: SBV U2Member
</span><a href="#local-6989586621681167380"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">[</span><span id="local-6989586621681167379"><span class="annot"><span class="annottext">lb :: SBV Location
</span><a href="#local-6989586621681167379"><span class="hs-identifier hs-var">lb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167378"><span class="annot"><span class="annottext">le :: SBV Location
</span><a href="#local-6989586621681167378"><span class="hs-identifier hs-var">le</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167377"><span class="annot"><span class="annottext">la :: SBV Location
</span><a href="#local-6989586621681167377"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167376"><span class="annot"><span class="annottext">ll :: SBV Location
</span><a href="#local-6989586621681167376"><span class="hs-identifier hs-var">ll</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Status -&gt; SBV Location) -&gt; Move (SBV Location))
-&gt; [Status -&gt; SBV Location]
-&gt; StateT Status Identity [SBV Location]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; Move (SBV Location)
forall a. (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lBono"><span class="hs-identifier hs-var hs-var">lBono</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lEdge"><span class="hs-identifier hs-var hs-var">lEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lAdam"><span class="hs-identifier hs-var hs-var">lAdam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lLarry"><span class="hs-identifier hs-var hs-var">lLarry</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-151"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681167374"><span class="annot"><span class="annottext">move :: SBV Location -&gt; SBV Location
</span><a href="#local-6989586621681167374"><span class="hs-identifier hs-var hs-var">move</span></a></span></span><span> </span><span id="local-6989586621681167373"><span class="annot"><span class="annottext">l :: SBV Location
</span><a href="#local-6989586621681167373"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBV Location -&gt; SBV Location -&gt; SBV Location
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167373"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#there"><span class="hs-identifier hs-var">there</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span>
</span><span id="line-152"></span><span>                       </span><span id="local-6989586621681167372"><span class="annot"><span class="annottext">lb' :: SBV Location
</span><a href="#local-6989586621681167372"><span class="hs-identifier hs-var hs-var">lb'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBV Location -&gt; SBV Location -&gt; SBV Location
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167380"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bono"><span class="hs-identifier hs-var">bono</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location
</span><a href="#local-6989586621681167374"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167379"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167379"><span class="hs-identifier hs-var">lb</span></a></span><span>
</span><span id="line-153"></span><span>                       </span><span id="local-6989586621681167371"><span class="annot"><span class="annottext">le' :: SBV Location
</span><a href="#local-6989586621681167371"><span class="hs-identifier hs-var hs-var">le'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBV Location -&gt; SBV Location -&gt; SBV Location
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167380"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#edge"><span class="hs-identifier hs-var">edge</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location
</span><a href="#local-6989586621681167374"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167378"><span class="hs-identifier hs-var">le</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167378"><span class="hs-identifier hs-var">le</span></a></span><span>
</span><span id="line-154"></span><span>                       </span><span id="local-6989586621681167370"><span class="annot"><span class="annottext">la' :: SBV Location
</span><a href="#local-6989586621681167370"><span class="hs-identifier hs-var hs-var">la'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBV Location -&gt; SBV Location -&gt; SBV Location
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167380"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#adam"><span class="hs-identifier hs-var">adam</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location
</span><a href="#local-6989586621681167374"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167377"><span class="hs-identifier hs-var">la</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167377"><span class="hs-identifier hs-var">la</span></a></span><span>
</span><span id="line-155"></span><span>                       </span><span id="local-6989586621681167369"><span class="annot"><span class="annottext">ll' :: SBV Location
</span><a href="#local-6989586621681167369"><span class="hs-identifier hs-var hs-var">ll'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBV Location -&gt; SBV Location -&gt; SBV Location
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167380"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#larry"><span class="hs-identifier hs-var">larry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location
</span><a href="#local-6989586621681167374"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167376"><span class="hs-identifier hs-var">ll</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167376"><span class="hs-identifier hs-var">ll</span></a></span><span>
</span><span id="line-156"></span><span>                   </span><span class="annot"><span class="annottext">(Status -&gt; Status) -&gt; StateT Status Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Status -&gt; Status) -&gt; StateT Status Identity ())
-&gt; (Status -&gt; Status) -&gt; StateT Status Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681167368"><span class="annot"><span class="annottext">s :: Status
</span><a href="#local-6989586621681167368"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167368"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">lBono :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lBono"><span class="hs-identifier hs-var">lBono</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167372"><span class="hs-identifier hs-var">lb'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lEdge :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lEdge"><span class="hs-identifier hs-var">lEdge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167371"><span class="hs-identifier hs-var">le'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lAdam :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lAdam"><span class="hs-identifier hs-var">lAdam</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167370"><span class="hs-identifier hs-var">la'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lLarry :: SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lLarry"><span class="hs-identifier hs-var">lLarry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167369"><span class="hs-identifier hs-var">ll'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Increment the time, when only one person crosses</span><span>
</span><span id="line-159"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bumpTime1"><span class="hs-identifier hs-type">bumpTime1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span id="bumpTime1"><span class="annot"><span class="annottext">bumpTime1 :: SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bumpTime1"><span class="hs-identifier hs-var hs-var">bumpTime1</span></a></span></span><span> </span><span id="local-6989586621681167366"><span class="annot"><span class="annottext">p :: SBV U2Member
</span><a href="#local-6989586621681167366"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Status -&gt; Status) -&gt; StateT Status Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Status -&gt; Status) -&gt; StateT Status Identity ())
-&gt; (Status -&gt; Status) -&gt; StateT Status Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681167365"><span class="annot"><span class="annottext">s :: Status
</span><a href="#local-6989586621681167365"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167365"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">time :: STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#time"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#time"><span class="hs-identifier hs-var hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167365"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">STime -&gt; STime -&gt; STime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#sCrossTime"><span class="hs-identifier hs-var">sCrossTime</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167366"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Increment the time, when two people cross together</span><span>
</span><span id="line-163"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bumpTime2"><span class="hs-identifier hs-type">bumpTime2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span id="bumpTime2"><span class="annot"><span class="annottext">bumpTime2 :: SBV U2Member -&gt; SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bumpTime2"><span class="hs-identifier hs-var hs-var">bumpTime2</span></a></span></span><span> </span><span id="local-6989586621681167362"><span class="annot"><span class="annottext">p1 :: SBV U2Member
</span><a href="#local-6989586621681167362"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621681167361"><span class="annot"><span class="annottext">p2 :: SBV U2Member
</span><a href="#local-6989586621681167361"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Status -&gt; Status) -&gt; StateT Status Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Status -&gt; Status) -&gt; StateT Status Identity ())
-&gt; (Status -&gt; Status) -&gt; StateT Status Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681167360"><span class="annot"><span class="annottext">s :: Status
</span><a href="#local-6989586621681167360"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167360"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">time :: STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#time"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#time"><span class="hs-identifier hs-var hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167360"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">STime -&gt; STime -&gt; STime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#sCrossTime"><span class="hs-identifier hs-var">sCrossTime</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167362"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">STime -&gt; STime -&gt; STime
forall a. OrdSymbolic a =&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#smax"><span class="hs-operator hs-var">`smax`</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#sCrossTime"><span class="hs-identifier hs-var">sCrossTime</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167361"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Symbolic version of 'Control.Monad.when'</span><span>
</span><span id="line-167"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whenS"><span class="hs-identifier hs-type">whenS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span id="whenS"><span class="annot"><span class="annottext">whenS :: SBool -&gt; StateT Status Identity () -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whenS"><span class="hs-identifier hs-var hs-var">whenS</span></a></span></span><span> </span><span id="local-6989586621681167357"><span class="annot"><span class="annottext">t :: SBool
</span><a href="#local-6989586621681167357"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681167356"><span class="annot"><span class="annottext">a :: StateT Status Identity ()
</span><a href="#local-6989586621681167356"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool
-&gt; StateT Status Identity ()
-&gt; StateT Status Identity ()
-&gt; StateT Status Identity ()
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167357"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StateT Status Identity ()
</span><a href="#local-6989586621681167356"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; StateT Status Identity ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Move one member, remembering to take the flash</span><span>
</span><span id="line-171"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#move1"><span class="hs-identifier hs-type">move1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span id="move1"><span class="annot"><span class="annottext">move1 :: SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#move1"><span class="hs-identifier hs-var hs-var">move1</span></a></span></span><span> </span><span id="local-6989586621681167354"><span class="annot"><span class="annottext">p :: SBV U2Member
</span><a href="#local-6989586621681167354"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681167353"><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167353"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; Move (SBV Location)
forall a. (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#flash"><span class="hs-identifier hs-var hs-var">flash</span></a></span><span>
</span><span id="line-173"></span><span>             </span><span id="local-6989586621681167352"><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167352"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; Move (SBV Location)
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whereIs"><span class="hs-identifier hs-var">whereIs</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167354"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-174"></span><span>             </span><span class="hs-comment">-- only do the move if the person and the flash are at the same side</span><span>
</span><span id="line-175"></span><span>             </span><span class="annot"><span class="annottext">SBool -&gt; StateT Status Identity () -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whenS"><span class="hs-identifier hs-var">whenS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167353"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167352"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT Status Identity () -&gt; StateT Status Identity ())
-&gt; StateT Status Identity () -&gt; StateT Status Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bumpTime1"><span class="hs-identifier hs-var">bumpTime1</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167354"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-176"></span><span>                                  </span><span class="annot"><span class="annottext">StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferFlash"><span class="hs-identifier hs-var">xferFlash</span></a></span><span>
</span><span id="line-177"></span><span>                                  </span><span class="annot"><span class="annottext">SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferPerson"><span class="hs-identifier hs-var">xferPerson</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167354"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Move two members, again with the flash</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#move2"><span class="hs-identifier hs-type">move2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span id="move2"><span class="annot"><span class="annottext">move2 :: SBV U2Member -&gt; SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#move2"><span class="hs-identifier hs-var hs-var">move2</span></a></span></span><span> </span><span id="local-6989586621681167350"><span class="annot"><span class="annottext">p1 :: SBV U2Member
</span><a href="#local-6989586621681167350"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621681167349"><span class="annot"><span class="annottext">p2 :: SBV U2Member
</span><a href="#local-6989586621681167349"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681167348"><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167348"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; Move (SBV Location)
forall a. (Status -&gt; a) -&gt; Move a
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#flash"><span class="hs-identifier hs-var hs-var">flash</span></a></span><span>
</span><span id="line-182"></span><span>                 </span><span id="local-6989586621681167347"><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167347"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; Move (SBV Location)
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whereIs"><span class="hs-identifier hs-var">whereIs</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167350"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-183"></span><span>                 </span><span id="local-6989586621681167346"><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167346"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; Move (SBV Location)
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whereIs"><span class="hs-identifier hs-var">whereIs</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167349"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-184"></span><span>                 </span><span class="hs-comment">-- only do the move if both people and the flash are at the same side</span><span>
</span><span id="line-185"></span><span>                 </span><span class="annot"><span class="annottext">SBool -&gt; StateT Status Identity () -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#whenS"><span class="hs-identifier hs-var">whenS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167348"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167347"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%26%26"><span class="hs-operator hs-var">.&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167348"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="#local-6989586621681167346"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT Status Identity () -&gt; StateT Status Identity ())
-&gt; StateT Status Identity () -&gt; StateT Status Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bumpTime2"><span class="hs-identifier hs-var">bumpTime2</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167350"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167349"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-186"></span><span>                                                    </span><span class="annot"><span class="annottext">StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferFlash"><span class="hs-identifier hs-var">xferFlash</span></a></span><span>
</span><span id="line-187"></span><span>                                                    </span><span class="annot"><span class="annottext">SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferPerson"><span class="hs-identifier hs-var">xferPerson</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167350"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-188"></span><span>                                                    </span><span class="annot"><span class="annottext">SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#xferPerson"><span class="hs-identifier hs-var">xferPerson</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167349"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- * Actions</span><span>
</span><span id="line-192"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | A move action is a sequence of triples. The first component is symbolically</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- True if only one member crosses. (In this case the third element of the triple</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- is irrelevant.) If the first component is (symbolically) False, then both members</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- move together</span><span>
</span><span id="line-198"></span><span class="hs-keyword">type</span><span> </span><span id="Actions"><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Actions"><span class="hs-identifier hs-var">Actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#SU2Member"><span class="hs-identifier hs-type">SU2Member</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Run a sequence of given actions.</span><span>
</span><span id="line-201"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Status"><span class="hs-identifier hs-type">Status</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span id="run"><span class="annot"><span class="annottext">run :: Actions -&gt; Move [Status]
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((SBool, SBV U2Member, SBV U2Member)
 -&gt; StateT Status Identity Status)
-&gt; Actions -&gt; Move [Status]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(SBool, SBV U2Member, SBV U2Member)
-&gt; StateT Status Identity Status
</span><a href="#local-6989586621681167343"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-203"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681167343"><span class="annot"><span class="annottext">step :: (SBool, SBV U2Member, SBV U2Member)
-&gt; StateT Status Identity Status
</span><a href="#local-6989586621681167343"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681167342"><span class="annot"><span class="annottext">b :: SBool
</span><a href="#local-6989586621681167342"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167341"><span class="annot"><span class="annottext">p1 :: SBV U2Member
</span><a href="#local-6989586621681167341"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167340"><span class="annot"><span class="annottext">p2 :: SBV U2Member
</span><a href="#local-6989586621681167340"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SBool
-&gt; StateT Status Identity ()
-&gt; StateT Status Identity ()
-&gt; StateT Status Identity ()
forall a. Mergeable a =&gt; SBool -&gt; a -&gt; a -&gt; a
</span><a href="Data.SBV.Core.Model.html#ite"><span class="hs-identifier hs-var">ite</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167342"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#move1"><span class="hs-identifier hs-var">move1</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167341"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; StateT Status Identity ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#move2"><span class="hs-identifier hs-var">move2</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167341"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167340"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT Status Identity ()
-&gt; StateT Status Identity Status -&gt; StateT Status Identity Status
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT Status Identity Status
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- * Recognizing valid solutions</span><span>
</span><span id="line-207"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Check if a given sequence of actions is valid, i.e., they must all</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- cross the bridge according to the rules and in less than 17 seconds</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#isValid"><span class="hs-identifier hs-type">isValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.SBV.Core.Data.html#SBool"><span class="hs-identifier hs-type">SBool</span></a></span><span>
</span><span id="line-212"></span><span id="isValid"><span class="annot"><span class="annottext">isValid :: Actions -&gt; SBool
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#isValid"><span class="hs-identifier hs-var hs-var">isValid</span></a></span></span><span> </span><span id="local-6989586621681167338"><span class="annot"><span class="annottext">as :: Actions
</span><a href="#local-6989586621681167338"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status -&gt; STime
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#time"><span class="hs-identifier hs-var hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167337"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">STime -&gt; STime -&gt; SBool
forall a. OrdSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3C%3D"><span class="hs-operator hs-var">.&lt;=</span></a></span><span> </span><span class="annot"><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%26%26"><span class="hs-operator hs-var">.&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">((SBool, SBV U2Member, SBV U2Member) -&gt; SBool) -&gt; Actions -&gt; SBool
forall a. (a -&gt; SBool) -&gt; [a] -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#sAll"><span class="hs-identifier hs-var">sAll</span></a></span><span> </span><span class="annot"><span class="annottext">(SBool, SBV U2Member, SBV U2Member) -&gt; SBool
</span><a href="#local-6989586621681167334"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Actions
</span><a href="#local-6989586621681167338"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%26%26"><span class="hs-operator hs-var">.&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">[SBV Location] -&gt; [SBV Location] -&gt; SBool
forall a. EqSymbolic a =&gt; [a] -&gt; [a] -&gt; SBool
</span><a href="#local-6989586621681167333"><span class="hs-identifier hs-var">zigZag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SBV Location] -&gt; [SBV Location]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#there"><span class="hs-identifier hs-var">there</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#here"><span class="hs-identifier hs-var">here</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Status -&gt; SBV Location) -&gt; [Status] -&gt; [SBV Location]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#flash"><span class="hs-identifier hs-var hs-var">flash</span></a></span><span> </span><span class="annot"><span class="annottext">[Status]
</span><a href="#local-6989586621681167331"><span class="hs-identifier hs-var">states</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%26%26"><span class="hs-operator hs-var">.&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(SBV Location -&gt; SBool) -&gt; [SBV Location] -&gt; SBool
forall a. (a -&gt; SBool) -&gt; [a] -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#sAll"><span class="hs-identifier hs-var">sAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBV Location -&gt; SBV Location -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#there"><span class="hs-identifier hs-var">there</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lBono"><span class="hs-identifier hs-var hs-var">lBono</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167337"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lEdge"><span class="hs-identifier hs-var hs-var">lEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167337"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lAdam"><span class="hs-identifier hs-var hs-var">lAdam</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167337"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Status -&gt; SBV Location
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#lLarry"><span class="hs-identifier hs-var hs-var">lLarry</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621681167337"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681167334"><span class="annot"><span class="annottext">check :: (SBool, SBV U2Member, SBV U2Member) -&gt; SBool
</span><a href="#local-6989586621681167334"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681167330"><span class="annot"><span class="annottext">s :: SBool
</span><a href="#local-6989586621681167330"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167329"><span class="annot"><span class="annottext">p1 :: SBV U2Member
</span><a href="#local-6989586621681167329"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167328"><span class="annot"><span class="annottext">p2 :: SBV U2Member
</span><a href="#local-6989586621681167328"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#sNot"><span class="hs-identifier hs-var">sNot</span></a></span><span> </span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167330"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%3D%3E"><span class="hs-operator hs-var">.=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167329"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. OrdSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3E"><span class="hs-operator hs-var">.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167328"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- for two person moves, ensure first person is &quot;larger&quot;</span><span>
</span><span id="line-214"></span><span>                          </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%26%26"><span class="hs-operator hs-var">.&amp;&amp;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167330"><span class="hs-identifier hs-var">s</span></a></span><span>      </span><span class="annot"><span class="annottext">SBool -&gt; SBool -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#.%3D%3E"><span class="hs-operator hs-var">.=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167328"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member -&gt; SBV U2Member -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#bono"><span class="hs-identifier hs-var">bono</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- for one person moves, ensure second person is always &quot;bono&quot;</span><span>
</span><span id="line-215"></span><span>        </span><span id="local-6989586621681167331"><span class="annot"><span class="annottext">states :: [Status]
</span><a href="#local-6989586621681167331"><span class="hs-identifier hs-var hs-var">states</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Move [Status] -&gt; Status -&gt; [Status]
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Actions -&gt; Move [Status]
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Actions
</span><a href="#local-6989586621681167338"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#start"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621681167337"><span class="annot"><span class="annottext">end :: Status
</span><a href="#local-6989586621681167337"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Status] -&gt; Status
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Status]
</span><a href="#local-6989586621681167331"><span class="hs-identifier hs-var">states</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621681167333"><span class="annot"><span class="annottext">zigZag :: [a] -&gt; [a] -&gt; SBool
</span><a href="#local-6989586621681167333"><span class="hs-identifier hs-var hs-var">zigZag</span></a></span></span><span> </span><span id="local-6989586621681167323"><span class="annot"><span class="annottext">reqs :: [a]
</span><a href="#local-6989586621681167323"><span class="hs-identifier hs-var">reqs</span></a></span></span><span> </span><span id="local-6989586621681167322"><span class="annot"><span class="annottext">locs :: [a]
</span><a href="#local-6989586621681167322"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SBool] -&gt; SBool
</span><a href="Data.SBV.Core.Data.html#sAnd"><span class="hs-identifier hs-var">sAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([SBool] -&gt; SBool) -&gt; [SBool] -&gt; SBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; SBool) -&gt; [a] -&gt; [a] -&gt; [SBool]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; SBool
forall a. EqSymbolic a =&gt; a -&gt; a -&gt; SBool
</span><a href="Data.SBV.Core.Model.html#.%3D%3D"><span class="hs-operator hs-var">(.==)</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681167322"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681167323"><span class="hs-identifier hs-var">reqs</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- * Solving the puzzle</span><span>
</span><span id="line-221"></span><span class="hs-comment">-------------------------------------------------------------</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | See if there is a solution that has precisely @n@ steps</span><span>
</span><span id="line-224"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#solveN"><span class="hs-identifier hs-type">solveN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-225"></span><span id="solveN"><span class="annot"><span class="annottext">solveN :: Int -&gt; IO Bool
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#solveN"><span class="hs-identifier hs-var hs-var">solveN</span></a></span></span><span> </span><span id="local-6989586621681167318"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Checking for solutions with &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; move&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Eq a, Num a) =&gt; a -&gt; String
</span><a href="#local-6989586621681167315"><span class="hs-identifier hs-var">plu</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-226"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681167314"><span class="annot"><span class="annottext">genAct :: SymbolicT IO (SBool, SBV U2Member, SBV U2Member)
</span><a href="#local-6989586621681167314"><span class="hs-identifier hs-var hs-var">genAct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681167313"><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167313"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Symbolic SBool
forall a. SymVal a =&gt; Symbolic (SBV a)
</span><a href="Data.SBV.Client.BaseIO.html#exists_"><span class="hs-identifier hs-var">exists_</span></a></span><span>
</span><span id="line-227"></span><span>                              </span><span id="local-6989586621681167311"><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167311"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Symbolic (SBV U2Member)
forall a. SymVal a =&gt; Symbolic (SBV a)
</span><a href="Data.SBV.Client.BaseIO.html#exists_"><span class="hs-identifier hs-var">exists_</span></a></span><span>
</span><span id="line-228"></span><span>                              </span><span id="local-6989586621681167310"><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167310"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Symbolic (SBV U2Member)
forall a. SymVal a =&gt; Symbolic (SBV a)
</span><a href="Data.SBV.Client.BaseIO.html#exists_"><span class="hs-identifier hs-var">exists_</span></a></span><span>
</span><span id="line-229"></span><span>                              </span><span class="annot"><span class="annottext">(SBool, SBV U2Member, SBV U2Member)
-&gt; SymbolicT IO (SBool, SBV U2Member, SBV U2Member)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBool
</span><a href="#local-6989586621681167313"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167311"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SBV U2Member
</span><a href="#local-6989586621681167310"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>              </span><span id="local-6989586621681167309"><span class="annot"><span class="annottext">AllSatResult
</span><a href="#local-6989586621681167309"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Symbolic SBool -&gt; IO AllSatResult
forall a. Provable a =&gt; a -&gt; IO AllSatResult
</span><a href="Data.SBV.Client.BaseIO.html#allSat"><span class="hs-identifier hs-var">allSat</span></a></span><span> </span><span class="annot"><span class="annottext">(Symbolic SBool -&gt; IO AllSatResult)
-&gt; Symbolic SBool -&gt; IO AllSatResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Actions -&gt; SBool
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#isValid"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">(Actions -&gt; SBool) -&gt; SymbolicT IO Actions -&gt; Symbolic SBool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; SymbolicT IO (SBool, SBV U2Member, SBV U2Member))
-&gt; [Int] -&gt; SymbolicT IO Actions
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicT IO (SBool, SBV U2Member, SBV U2Member)
-&gt; Int -&gt; SymbolicT IO (SBool, SBV U2Member, SBV U2Member)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">SymbolicT IO (SBool, SBV U2Member, SBV U2Member)
</span><a href="#local-6989586621681167314"><span class="hs-identifier hs-var">genAct</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span>              </span><span id="local-6989586621681167306"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167306"><span class="hs-identifier hs-var">cnt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([(Bool, [(Bool, U2Member, U2Member)])]
 -&gt; [(Bool, [(Bool, U2Member, U2Member)])])
-&gt; (Int -&gt; (Bool, [(Bool, U2Member, U2Member)]) -&gt; IO ())
-&gt; AllSatResult
-&gt; IO Int
forall a.
SatModel a =&gt;
([(Bool, a)] -&gt; [(Bool, a)])
-&gt; (Int -&gt; (Bool, a) -&gt; IO ()) -&gt; AllSatResult -&gt; IO Int
</span><a href="Data.SBV.SMT.SMT.html#displayModels"><span class="hs-identifier hs-var">displayModels</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Bool, [(Bool, U2Member, U2Member)]) -&gt; String)
-&gt; [(Bool, [(Bool, U2Member, U2Member)])]
-&gt; [(Bool, [(Bool, U2Member, U2Member)])]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">(Bool, [(Bool, U2Member, U2Member)]) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Bool, [(Bool, U2Member, U2Member)]) -&gt; IO ()
</span><a href="#local-6989586621681167304"><span class="hs-identifier hs-var">disp</span></a></span><span> </span><span class="annot"><span class="annottext">AllSatResult
</span><a href="#local-6989586621681167309"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-232"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167306"><span class="hs-identifier hs-var">cnt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-233"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Found: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167306"><span class="hs-identifier hs-var">cnt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; solution&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Eq a, Num a) =&gt; a -&gt; String
</span><a href="#local-6989586621681167315"><span class="hs-identifier hs-var">plu</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167306"><span class="hs-identifier hs-var">cnt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; with &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; move&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. (Eq a, Num a) =&gt; a -&gt; String
</span><a href="#local-6989586621681167315"><span class="hs-identifier hs-var">plu</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-234"></span><span>                                  </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681167315"><span class="annot"><span class="annottext">plu :: a -&gt; String
</span><a href="#local-6989586621681167315"><span class="hs-identifier hs-var hs-var">plu</span></a></span></span><span> </span><span id="local-6989586621681167303"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621681167303"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681167303"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;s&quot;</span></span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><a href="#local-6989586621681167304"><span class="hs-identifier hs-type">disp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#U2Member"><span class="hs-identifier hs-type">U2Member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#U2Member"><span class="hs-identifier hs-type">U2Member</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>        </span><span id="local-6989586621681167304"><span class="annot"><span class="annottext">disp :: Int -&gt; (Bool, [(Bool, U2Member, U2Member)]) -&gt; IO ()
</span><a href="#local-6989586621681167304"><span class="hs-identifier hs-var hs-var">disp</span></a></span></span><span> </span><span id="local-6989586621681167302"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621681167302"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167301"><span class="annot"><span class="annottext">ss :: [(Bool, U2Member, U2Member)]
</span><a href="#local-6989586621681167301"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167300"><span class="hs-identifier hs-var">lss</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; results; got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167300"><span class="hs-identifier hs-var">lss</span></a></span><span>
</span><span id="line-239"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Solution #&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167302"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-240"></span><span>                         </span><span class="annot"><span class="annottext">Bool -&gt; Time -&gt; [(Bool, U2Member, U2Member)] -&gt; IO ()
</span><a href="#local-6989586621681167297"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[(Bool, U2Member, U2Member)]
</span><a href="#local-6989586621681167301"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-241"></span><span>                         </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>         </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681167300"><span class="annot"><span class="annottext">lss :: Int
</span><a href="#local-6989586621681167300"><span class="hs-identifier hs-var hs-var">lss</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Bool, U2Member, U2Member)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Bool, U2Member, U2Member)]
</span><a href="#local-6989586621681167301"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-243"></span><span>               </span><span id="local-6989586621681167297"><span class="annot"><span class="annottext">go :: Bool -&gt; Time -&gt; [(Bool, U2Member, U2Member)] -&gt; IO ()
</span><a href="#local-6989586621681167297"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621681167295"><span class="annot"><span class="annottext">t :: Time
</span><a href="#local-6989586621681167295"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Total time: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Time -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621681167295"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-244"></span><span>               </span><span class="annot"><a href="#local-6989586621681167297"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681167294"><span class="annot"><span class="annottext">l :: Bool
</span><a href="#local-6989586621681167294"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681167293"><span class="annot"><span class="annottext">t :: Time
</span><a href="#local-6989586621681167293"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621681167292"><span class="annot"><span class="annottext">a :: U2Member
</span><a href="#local-6989586621681167292"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681167291"><span class="annot"><span class="annottext">rest :: [(Bool, U2Member, U2Member)]
</span><a href="#local-6989586621681167291"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Time -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="#local-6989586621681167290"><span class="hs-identifier hs-var">sh2</span></a></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621681167293"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="#local-6989586621681167289"><span class="hs-identifier hs-var">shL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167294"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">U2Member -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="#local-6989586621681167292"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-245"></span><span>                                                </span><span class="annot"><span class="annottext">Bool -&gt; Time -&gt; [(Bool, U2Member, U2Member)] -&gt; IO ()
</span><a href="#local-6989586621681167297"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167294"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621681167293"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Time
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="#local-6989586621681167292"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Bool, U2Member, U2Member)]
</span><a href="#local-6989586621681167291"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-246"></span><span>               </span><span class="annot"><a href="#local-6989586621681167297"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681167287"><span class="annot"><span class="annottext">l :: Bool
</span><a href="#local-6989586621681167287"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681167286"><span class="annot"><span class="annottext">t :: Time
</span><a href="#local-6989586621681167286"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167285"><span class="annot"><span class="annottext">a :: U2Member
</span><a href="#local-6989586621681167285"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681167284"><span class="annot"><span class="annottext">b :: U2Member
</span><a href="#local-6989586621681167284"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681167283"><span class="annot"><span class="annottext">rest :: [(Bool, U2Member, U2Member)]
</span><a href="#local-6989586621681167283"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Time -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="#local-6989586621681167290"><span class="hs-identifier hs-var">sh2</span></a></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621681167286"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="#local-6989586621681167289"><span class="hs-identifier hs-var">shL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167287"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">U2Member -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="#local-6989586621681167285"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">U2Member -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="#local-6989586621681167284"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-247"></span><span>                                                </span><span class="annot"><span class="annottext">Bool -&gt; Time -&gt; [(Bool, U2Member, U2Member)] -&gt; IO ()
</span><a href="#local-6989586621681167297"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167287"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621681167286"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Time
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="#local-6989586621681167285"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Time
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">U2Member -&gt; Time
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#crossTime"><span class="hs-identifier hs-var">crossTime</span></a></span><span> </span><span class="annot"><span class="annottext">U2Member
</span><a href="#local-6989586621681167284"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Bool, U2Member, U2Member)]
</span><a href="#local-6989586621681167283"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-248"></span><span>               </span><span id="local-6989586621681167290"><span class="annot"><span class="annottext">sh2 :: a -&gt; String
</span><a href="#local-6989586621681167290"><span class="hs-identifier hs-var hs-var">sh2</span></a></span></span><span> </span><span id="local-6989586621681167281"><span class="annot"><span class="annottext">t :: a
</span><a href="#local-6989586621681167281"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681167280"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681167280"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681167281"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681167280"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681167280"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681167280"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-249"></span><span>               </span><span id="local-6989586621681167289"><span class="annot"><span class="annottext">shL :: Bool -&gt; String
</span><a href="#local-6989586621681167289"><span class="hs-identifier hs-var hs-var">shL</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot; --&gt; &quot;</span></span><span>
</span><span id="line-250"></span><span>               </span><span class="annot"><a href="#local-6989586621681167289"><span class="hs-identifier hs-var">shL</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot; &lt;-- &quot;</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Solve the U2-bridge crossing puzzle, starting by testing solutions with</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- increasing number of steps, until we find one. We have:</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- &gt;&gt;&gt; solveU2</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- Checking for solutions with 1 move.</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- Checking for solutions with 2 moves.</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- Checking for solutions with 3 moves.</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- Checking for solutions with 4 moves.</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- Checking for solutions with 5 moves.</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- Solution #1:</span><span>
</span><span id="line-262"></span><span class="hs-comment">--  0 --&gt; Edge, Bono</span><span>
</span><span id="line-263"></span><span class="hs-comment">--  2 &lt;-- Bono</span><span>
</span><span id="line-264"></span><span class="hs-comment">--  3 --&gt; Larry, Adam</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- 13 &lt;-- Edge</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- 15 --&gt; Edge, Bono</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- Total time: 17</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- Solution #2:</span><span>
</span><span id="line-269"></span><span class="hs-comment">--  0 --&gt; Edge, Bono</span><span>
</span><span id="line-270"></span><span class="hs-comment">--  2 &lt;-- Edge</span><span>
</span><span id="line-271"></span><span class="hs-comment">--  4 --&gt; Larry, Adam</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- 14 &lt;-- Bono</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- 15 --&gt; Edge, Bono</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- Total time: 17</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- Found: 2 solutions with 5 moves.</span><span>
</span><span id="line-276"></span><span class="hs-comment">--</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- Finding all possible solutions to the puzzle.</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#solveU2"><span class="hs-identifier hs-type">solveU2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span id="solveU2"><span class="annot"><span class="annottext">solveU2 :: IO ()
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#solveU2"><span class="hs-identifier hs-var hs-var">solveU2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="#local-6989586621681167277"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-280"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681167277"><span class="annot"><span class="annottext">go :: Int -&gt; IO ()
</span><a href="#local-6989586621681167277"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681167276"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621681167276"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681167275"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167275"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Bool
</span><a href="Documentation.SBV.Examples.Puzzles.U2Bridge.html#solveN"><span class="hs-identifier hs-var">solveN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167276"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-281"></span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681167275"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="#local-6989586621681167277"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681167276"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span></pre></body></html>