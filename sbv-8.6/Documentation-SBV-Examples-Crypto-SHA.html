<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Documentation.SBV.Examples.Crypto.SHA</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">sbv-8.6: SMT Based Verification: Symbolic Haskell theorem prover using SMT solving.</span><ul class="links" id="page-menu"><li><a href="src/Documentation.SBV.Examples.Crypto.SHA.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Levent Erkok</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>erkokl@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Documentation.SBV.Examples.Crypto.SHA</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Parameterizing SHA</a></li><li><a href="#g:2">Section 4.1.2, SHA functions</a></li><li><a href="#g:3">SHA variants</a></li><li><a href="#g:4">Section 5, Preprocessing</a></li><li><a href="#g:5">Section 6.2.2 and 6.4.2, Hash computation</a></li><li><a href="#g:6">Computing the digest</a></li><li><a href="#g:7">Testing</a></li><li><a href="#g:8">Code generation</a></li><li><a href="#g:9">Helpers</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of SHA2 class of algorithms, closely following the spec
 <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>.</p><p>We support all variants of SHA in the spec, except for SHA1. Note that
 this implementation is really useful for code-generation purposes from
 SBV, as it is hard to state (or prove!) any particular properties of
 these algorithms that is suitable for SMT solving.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:SHA">SHA</a> w = <a href="#v:SHA">SHA</a> {<ul class="subs"><li><a href="#v:wordSize">wordSize</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:blockSize">blockSize</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:sum0Coefficients">sum0Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</li><li><a href="#v:sum1Coefficients">sum1Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</li><li><a href="#v:sigma0Coefficients">sigma0Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</li><li><a href="#v:sigma1Coefficients">sigma1Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</li><li><a href="#v:shaConstants">shaConstants</a> :: [w]</li><li><a href="#v:h0">h0</a> :: [w]</li><li><a href="#v:shaLoopCount">shaLoopCount</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li></ul>}</li><li class="src short"><a href="#v:ch">ch</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; a -&gt; a -&gt; a -&gt; a</li><li class="src short"><a href="#v:maj">maj</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; a -&gt; a -&gt; a -&gt; a</li><li class="src short"><a href="#v:sum0">sum0</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a</li><li class="src short"><a href="#v:sum1">sum1</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a</li><li class="src short"><a href="#v:sigma0">sigma0</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a</li><li class="src short"><a href="#v:sigma1">sigma1</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a</li><li class="src short"><a href="#v:sha224P">sha224P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32)</li><li class="src short"><a href="#v:sha256P">sha256P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32)</li><li class="src short"><a href="#v:sha384P">sha384P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64)</li><li class="src short"><a href="#v:sha512P">sha512P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64)</li><li class="src short"><a href="#v:sha512_224P">sha512_224P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64)</li><li class="src short"><a href="#v:sha512_256P">sha512_256P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64)</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Block">Block</a> a = <a href="#v:Block">Block</a> [a]</li><li class="src short"><a href="#v:prepareMessage">prepareMessage</a> :: <span class="keyword">forall</span> w. (<a href="../base-4.13.0.0/Prelude.html#t:Num" title="Prelude">Num</a> w, <a href="Data-SBV.html#t:ByteConverter" title="Data.SBV">ByteConverter</a> w) =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-SHA.html#t:Block" title="Documentation.SBV.Examples.Crypto.SHA">Block</a> w]</li><li class="src short"><a href="#v:hashBlock">hashBlock</a> :: (<a href="../base-4.13.0.0/Prelude.html#t:Num" title="Prelude">Num</a> w, <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> w) =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; [w] -&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:Block" title="Documentation.SBV.Examples.Crypto.SHA">Block</a> w -&gt; [w]</li><li class="src short"><a href="#v:shaP">shaP</a> :: (<a href="../base-4.13.0.0/Prelude.html#t:Num" title="Prelude">Num</a> w, <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> w, <a href="Data-SBV.html#t:ByteConverter" title="Data.SBV">ByteConverter</a> w) =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [w]</li><li class="src short"><a href="#v:sha224">sha224</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 224</li><li class="src short"><a href="#v:sha256">sha256</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 256</li><li class="src short"><a href="#v:sha384">sha384</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 384</li><li class="src short"><a href="#v:sha512">sha512</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 512</li><li class="src short"><a href="#v:sha512_224">sha512_224</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 224</li><li class="src short"><a href="#v:sha512_256">sha512_256</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 256</li><li class="src short"><a href="#v:knownAnswerTests">knownAnswerTests</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:cgSHA256">cgSHA256</a> :: <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:chunkBy">chunkBy</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [b]</li><li class="src short"><a href="#v:showHash">showHash</a> :: (<a href="../base-4.13.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.13.0.0/Prelude.html#t:Integral" title="Prelude">Integral</a> a, <a href="Data-SBV-Internals.html#t:SymVal" title="Data.SBV.Internals">SymVal</a> a) =&gt; <a href="Data-SBV-Internals.html#t:SBV" title="Data.SBV.Internals">SBV</a> a -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Parameterizing SHA</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SHA" class="def">SHA</a> w <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#SHA" class="link">Source</a> <a href="#t:SHA" class="selflink">#</a></p><div class="doc"><p>Parameterized SHA representation, that captures all the differences
 between variants of the algorithm. <code>w</code> is the word-size type.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SHA" class="def">SHA</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:wordSize" class="def">wordSize</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>Section 1           : Word size we operate with</p></div></li><li><dfn class="src"><a id="v:blockSize" class="def">blockSize</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>Section 1           : Block size for messages</p></div></li><li><dfn class="src"><a id="v:sum0Coefficients" class="def">sum0Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</dfn><div class="doc"><p>Section 4.1.2-3     : Coefficients of the Sum0 function</p></div></li><li><dfn class="src"><a id="v:sum1Coefficients" class="def">sum1Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</dfn><div class="doc"><p>Section 4.1.2-3     : Coefficients of the Sum1 function</p></div></li><li><dfn class="src"><a id="v:sigma0Coefficients" class="def">sigma0Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</dfn><div class="doc"><p>Section 4.1.2-3     : Coefficients of the sigma0 function</p></div></li><li><dfn class="src"><a id="v:sigma1Coefficients" class="def">sigma1Coefficients</a> :: (<a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</dfn><div class="doc"><p>Section 4.1.2-3     : Coefficients of the sigma1 function</p></div></li><li><dfn class="src"><a id="v:shaConstants" class="def">shaConstants</a> :: [w]</dfn><div class="doc"><p>Section 4.2.2-3     : Magic SHA constants</p></div></li><li><dfn class="src"><a id="v:h0" class="def">h0</a> :: [w]</dfn><div class="doc"><p>Section 5.3.2-6     : Initial hash value</p></div></li><li><dfn class="src"><a id="v:shaLoopCount" class="def">shaLoopCount</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>Section 6.2.2, 6.4.2: How many iterations are there in the inner loop</p></div></li></ul></div></td></tr></table></div></div><a href="#g:2" id="g:2"><h1>Section 4.1.2, SHA functions</h1></a><div class="top"><p class="src"><a id="v:ch" class="def">ch</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; a -&gt; a -&gt; a -&gt; a <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#ch" class="link">Source</a> <a href="#v:ch" class="selflink">#</a></p><div class="doc"><p>The choose function.</p></div></div><div class="top"><p class="src"><a id="v:maj" class="def">maj</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; a -&gt; a -&gt; a -&gt; a <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#maj" class="link">Source</a> <a href="#v:maj" class="selflink">#</a></p><div class="doc"><p>The majority function.</p></div></div><div class="top"><p class="src"><a id="v:sum0" class="def">sum0</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sum0" class="link">Source</a> <a href="#v:sum0" class="selflink">#</a></p><div class="doc"><p>The sum-0 function. We parameterize over the rotation amounts as different
 variants of SHA use different rotation amnounts.</p></div></div><div class="top"><p class="src"><a id="v:sum1" class="def">sum1</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sum1" class="link">Source</a> <a href="#v:sum1" class="selflink">#</a></p><div class="doc"><p>The sum-1 function. Again, parameterized.</p></div></div><div class="top"><p class="src"><a id="v:sigma0" class="def">sigma0</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sigma0" class="link">Source</a> <a href="#v:sigma0" class="selflink">#</a></p><div class="doc"><p>The sigma0 function. Parameterized.</p></div></div><div class="top"><p class="src"><a id="v:sigma1" class="def">sigma1</a> :: <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> a =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; a -&gt; a <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sigma1" class="link">Source</a> <a href="#v:sigma1" class="selflink">#</a></p><div class="doc"><p>The sigma1 function. Parameterized.</p></div></div><a href="#g:3" id="g:3"><h1>SHA variants</h1></a><div class="top"><p class="src"><a id="v:sha224P" class="def">sha224P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32) <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha224P" class="link">Source</a> <a href="#v:sha224P" class="selflink">#</a></p><div class="doc"><p>Parameterization for SHA224.</p></div></div><div class="top"><p class="src"><a id="v:sha256P" class="def">sha256P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 32) <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha256P" class="link">Source</a> <a href="#v:sha256P" class="selflink">#</a></p><div class="doc"><p>Parameterization for SHA256. Inherits mostly from SHA224.</p></div></div><div class="top"><p class="src"><a id="v:sha384P" class="def">sha384P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64) <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha384P" class="link">Source</a> <a href="#v:sha384P" class="selflink">#</a></p><div class="doc"><p>Parameterization for SHA384.</p></div></div><div class="top"><p class="src"><a id="v:sha512P" class="def">sha512P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64) <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha512P" class="link">Source</a> <a href="#v:sha512P" class="selflink">#</a></p><div class="doc"><p>Parameterization for SHA512. Inherits mostly from SHA384.</p></div></div><div class="top"><p class="src"><a id="v:sha512_224P" class="def">sha512_224P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64) <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha512_224P" class="link">Source</a> <a href="#v:sha512_224P" class="selflink">#</a></p><div class="doc"><p>Parameterization for SHA512_224. Inherits mostly from SHA512</p></div></div><div class="top"><p class="src"><a id="v:sha512_256P" class="def">sha512_256P</a> :: <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> (<a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 64) <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha512_256P" class="link">Source</a> <a href="#v:sha512_256P" class="selflink">#</a></p><div class="doc"><p>Parameterization for SHA512_256. Inherits mostly from SHA512</p></div></div><a href="#g:4" id="g:4"><h1>Section 5, Preprocessing</h1></a><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Block" class="def">Block</a> a <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#Block" class="link">Source</a> <a href="#t:Block" class="selflink">#</a></p><div class="doc"><p><code><a href="Documentation-SBV-Examples-Crypto-SHA.html#t:Block" title="Documentation.SBV.Examples.Crypto.SHA">Block</a></code> is a  synonym for lists, but makes the intent clear.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Block" class="def">Block</a> [a]</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:prepareMessage" class="def">prepareMessage</a> :: <span class="keyword">forall</span> w. (<a href="../base-4.13.0.0/Prelude.html#t:Num" title="Prelude">Num</a> w, <a href="Data-SBV.html#t:ByteConverter" title="Data.SBV">ByteConverter</a> w) =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Documentation-SBV-Examples-Crypto-SHA.html#t:Block" title="Documentation.SBV.Examples.Crypto.SHA">Block</a> w] <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#prepareMessage" class="link">Source</a> <a href="#v:prepareMessage" class="selflink">#</a></p><div class="doc"><p>Prepare the message by turning it into blocks. We also check for the message
 size requirement here. Note that this won't actually happen in practice as the input
 length would be &gt; 2^64 (or 2^128), and you'd run out of memory first! Such a check</p></div></div><a href="#g:5" id="g:5"><h1>Section 6.2.2 and 6.4.2, Hash computation</h1></a><div class="top"><p class="src"><a id="v:hashBlock" class="def">hashBlock</a> :: (<a href="../base-4.13.0.0/Prelude.html#t:Num" title="Prelude">Num</a> w, <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> w) =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; [w] -&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:Block" title="Documentation.SBV.Examples.Crypto.SHA">Block</a> w -&gt; [w] <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#hashBlock" class="link">Source</a> <a href="#v:hashBlock" class="selflink">#</a></p><div class="doc"><p>Hash one block of message, starting from a previous hash. This function
 corresponds to body of the for-loop in the spec. This function always
 produces a list of length 8, corresponding to the final 8 values of the <code>H</code>.</p></div></div><div class="top"><p class="src"><a id="v:shaP" class="def">shaP</a> :: (<a href="../base-4.13.0.0/Prelude.html#t:Num" title="Prelude">Num</a> w, <a href="../base-4.13.0.0/Data-Bits.html#t:Bits" title="Data.Bits">Bits</a> w, <a href="Data-SBV.html#t:ByteConverter" title="Data.SBV">ByteConverter</a> w) =&gt; <a href="Documentation-SBV-Examples-Crypto-SHA.html#t:SHA" title="Documentation.SBV.Examples.Crypto.SHA">SHA</a> w -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [w] <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#shaP" class="link">Source</a> <a href="#v:shaP" class="selflink">#</a></p><div class="doc"><p>Compute the hash of a given string using the specified parameterized hash algorithm.</p></div></div><a href="#g:6" id="g:6"><h1>Computing the digest</h1></a><div class="top"><p class="src"><a id="v:sha224" class="def">sha224</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 224 <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha224" class="link">Source</a> <a href="#v:sha224" class="selflink">#</a></p><div class="doc"><p>SHA224 digest.</p></div></div><div class="top"><p class="src"><a id="v:sha256" class="def">sha256</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 256 <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha256" class="link">Source</a> <a href="#v:sha256" class="selflink">#</a></p><div class="doc"><p>SHA256 digest.</p></div></div><div class="top"><p class="src"><a id="v:sha384" class="def">sha384</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 384 <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha384" class="link">Source</a> <a href="#v:sha384" class="selflink">#</a></p><div class="doc"><p>SHA384 digest.</p></div></div><div class="top"><p class="src"><a id="v:sha512" class="def">sha512</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 512 <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha512" class="link">Source</a> <a href="#v:sha512" class="selflink">#</a></p><div class="doc"><p>SHA512 digest.</p></div></div><div class="top"><p class="src"><a id="v:sha512_224" class="def">sha512_224</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 224 <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha512_224" class="link">Source</a> <a href="#v:sha512_224" class="selflink">#</a></p><div class="doc"><p>SHA512_224 digest.</p></div></div><div class="top"><p class="src"><a id="v:sha512_256" class="def">sha512_256</a> :: <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Data-SBV-Trans.html#t:SWord" title="Data.SBV.Trans">SWord</a> 256 <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#sha512_256" class="link">Source</a> <a href="#v:sha512_256" class="selflink">#</a></p><div class="doc"><p>SHA512_256 digest.</p></div></div><a href="#g:7" id="g:7"><h1>Testing</h1></a><div class="top"><p class="src"><a id="v:knownAnswerTests" class="def">knownAnswerTests</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.13.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#knownAnswerTests" class="link">Source</a> <a href="#v:knownAnswerTests" class="selflink">#</a></p><div class="doc"><p>Collection of known answer tests for SHA. Since these tests take too long during regular
 regression runs, we pass as an argument how many to run. Increase the below number to 24 to run all tests.
 We have:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>knownAnswerTests 1
</code></strong>True
</pre></div></div><a href="#g:8" id="g:8"><h1>Code generation</h1></a><div class="doc empty">&nbsp;</div><div class="doc"><p>It is not practical to generate SBV code for hashing an entire string, as it would
   require handling of a fixed size string. Instead we show how to generate code
   for hashing one block, which can then be incorporated into a larger program
   by providing the appropriate loop.</p></div><div class="top"><p class="src"><a id="v:cgSHA256" class="def">cgSHA256</a> :: <a href="../base-4.13.0.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#cgSHA256" class="link">Source</a> <a href="#v:cgSHA256" class="selflink">#</a></p><div class="doc"><p>Generate code for one block of SHA256 in action, starting from an arbitrary hash value.</p></div></div><a href="#g:9" id="g:9"><h1>Helpers</h1></a><div class="top"><p class="src"><a id="v:chunkBy" class="def">chunkBy</a> :: <a href="../base-4.13.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [b] <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#chunkBy" class="link">Source</a> <a href="#v:chunkBy" class="selflink">#</a></p><div class="doc"><p>Helper for chunking a list by given lengths and combining each chunk with a function</p></div></div><div class="top"><p class="src"><a id="v:showHash" class="def">showHash</a> :: (<a href="../base-4.13.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.13.0.0/Prelude.html#t:Integral" title="Prelude">Integral</a> a, <a href="Data-SBV-Internals.html#t:SymVal" title="Data.SBV.Internals">SymVal</a> a) =&gt; <a href="Data-SBV-Internals.html#t:SBV" title="Data.SBV.Internals">SBV</a> a -&gt; <a href="../base-4.13.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="src/Documentation.SBV.Examples.Crypto.SHA.html#showHash" class="link">Source</a> <a href="#v:showHash" class="selflink">#</a></p><div class="doc"><p>Nicely lay out a hash value as a string</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>