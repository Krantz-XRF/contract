<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  Data.Numbers.CrackNum</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (c) Levent Erkok</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  erkokl@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- A library for formatting/analyzing FP and Integer values</span><span>
</span><span id="line-10"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE    FlexibleContexts #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE    NamedFieldPuns    #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Numbers.CrackNum</span><span>
</span><span id="line-18"></span><span>   </span><span class="hs-special">(</span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal representation of a Floating-point numbers</span></span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier">FP</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Precision"><span class="hs-identifier">Precision</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#IPrecision"><span class="hs-identifier">IPrecision</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Kind"><span class="hs-identifier">Kind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Creating FP values</span></span><span>
</span><span id="line-21"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#floatToFP"><span class="hs-identifier">floatToFP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#doubleToFP"><span class="hs-identifier">doubleToFP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#stringToFP"><span class="hs-identifier">stringToFP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier">integerToFP</span></a></span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Displaying FP and Int/Word values</span></span><span>
</span><span id="line-23"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#displayFP"><span class="hs-identifier">displayFP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#displayWord"><span class="hs-identifier">displayWord</span></a></span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Converting between floats and bit-representations</span></span><span>
</span><span id="line-25"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#floatToWord"><span class="hs-identifier">floatToWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#wordToFloat"><span class="hs-identifier">wordToFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#doubleToWord"><span class="hs-identifier">doubleToWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#wordToDouble"><span class="hs-identifier">wordToDouble</span></a></span><span>
</span><span id="line-26"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">testBit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setBit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Bits</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Int16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Int32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html"><span class="hs-identifier">Data.Numbers.CrackNum.Data</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Utils.html"><span class="hs-identifier">Data.Numbers.CrackNum.Utils</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Numbers.FloatingHex</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FH</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.ST</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">newArray</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">readArray</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MArray</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">STUArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">castSTUArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.ST</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runST</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Crack a Haskell Integer value as the given precision floating value. The Integer should</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- be the value corresponding to the bit-pattern as the float is laid out in memory according</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- to the IEEE rules.</span><span>
</span><span id="line-49"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-type">integerToFP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Precision"><span class="hs-identifier hs-type">Precision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span>
</span><span id="line-50"></span><span id="integerToFP"><span class="annot"><span class="annottext">integerToFP :: Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var hs-var">integerToFP</span></a></span></span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#HP"><span class="hs-identifier hs-type">HP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Int -&gt; Int -&gt; [Int] -&gt; [Int] -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#crack"><span class="hs-identifier hs-var">crack</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#HP"><span class="hs-identifier hs-var">HP</span></a></span><span>   </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">14</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">13</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">]</span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Int -&gt; Int -&gt; [Int] -&gt; [Int] -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#crack"><span class="hs-identifier hs-var">crack</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span>  </span><span class="annot"><span class="hs-number">127</span></span><span> </span><span class="annot"><span class="hs-number">31</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">30</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">29</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">23</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">22</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">21</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-type">DP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Int -&gt; Int -&gt; [Int] -&gt; [Int] -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#crack"><span class="hs-identifier hs-var">crack</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-var">DP</span></a></span><span> </span><span class="annot"><span class="hs-number">1023</span></span><span> </span><span class="annot"><span class="hs-number">63</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">62</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">61</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">52</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">51</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Use Haskell Float to represent SP</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#spVal"><span class="hs-identifier hs-type">spVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-56"></span><span id="spVal"><span class="annot"><span class="annottext">spVal :: Bool -&gt; Int -&gt; [Bool] -&gt; Float
</span><a href="Data.Numbers.CrackNum.html#spVal"><span class="hs-identifier hs-var hs-var">spVal</span></a></span></span><span> </span><span id="local-6989586621679065200"><span class="annot"><span class="annottext">dn :: Bool
</span><a href="#local-6989586621679065200"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span id="local-6989586621679065199"><span class="annot"><span class="annottext">expVal :: Int
</span><a href="#local-6989586621679065199"><span class="hs-identifier hs-var">expVal</span></a></span></span><span> </span><span id="local-6989586621679065198"><span class="annot"><span class="annottext">fracBits :: [Bool]
</span><a href="#local-6989586621679065198"><span class="hs-identifier hs-var">fracBits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065199"><span class="hs-identifier hs-var">expVal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
</span><a href="#local-6989586621679065195"><span class="hs-identifier hs-var">add1</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065194"><span class="hs-identifier hs-var">frac</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065194"><span class="annot"><span class="annottext">frac :: Float
</span><a href="#local-6989586621679065194"><span class="hs-identifier hs-var hs-var">frac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Float] -&gt; Float
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Float] -&gt; Float) -&gt; [Float] -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int -&gt; Float) -&gt; [Bool] -&gt; [Int] -&gt; [Float]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065191"><span class="annot"><span class="annottext">b :: Bool
</span><a href="#local-6989586621679065191"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679065190"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679065190"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065191"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065190"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065198"><span class="hs-identifier hs-var">fracBits</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>        </span><span id="local-6989586621679065195"><span class="annot"><span class="annottext">add1 :: Float -&gt; Float
</span><a href="#local-6989586621679065195"><span class="hs-identifier hs-var hs-var">add1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065200"><span class="hs-identifier hs-var">dn</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-59"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Use Haskell Double to represent DP</span><span>
</span><span id="line-62"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#dpVal"><span class="hs-identifier hs-type">dpVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-63"></span><span id="dpVal"><span class="annot"><span class="annottext">dpVal :: Bool -&gt; Int -&gt; [Bool] -&gt; Double
</span><a href="Data.Numbers.CrackNum.html#dpVal"><span class="hs-identifier hs-var hs-var">dpVal</span></a></span></span><span> </span><span id="local-6989586621679065186"><span class="annot"><span class="annottext">dn :: Bool
</span><a href="#local-6989586621679065186"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span id="local-6989586621679065185"><span class="annot"><span class="annottext">expVal :: Int
</span><a href="#local-6989586621679065185"><span class="hs-identifier hs-var">expVal</span></a></span></span><span> </span><span id="local-6989586621679065184"><span class="annot"><span class="annottext">fracBits :: [Bool]
</span><a href="#local-6989586621679065184"><span class="hs-identifier hs-var">fracBits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065185"><span class="hs-identifier hs-var">expVal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679065183"><span class="hs-identifier hs-var">add1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065182"><span class="hs-identifier hs-var">frac</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065182"><span class="annot"><span class="annottext">frac :: Double
</span><a href="#local-6989586621679065182"><span class="hs-identifier hs-var hs-var">frac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int -&gt; Double) -&gt; [Bool] -&gt; [Int] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065181"><span class="annot"><span class="annottext">b :: Bool
</span><a href="#local-6989586621679065181"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679065180"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679065180"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065181"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065180"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065184"><span class="hs-identifier hs-var">fracBits</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>        </span><span id="local-6989586621679065183"><span class="annot"><span class="annottext">add1 :: Double -&gt; Double
</span><a href="#local-6989586621679065183"><span class="hs-identifier hs-var hs-var">add1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065186"><span class="hs-identifier hs-var">dn</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-66"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Assemble a FP from the given bits and pieces.</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#crack"><span class="hs-identifier hs-type">crack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Precision"><span class="hs-identifier hs-type">Precision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span>
</span><span id="line-70"></span><span id="crack"><span class="annot"><span class="annottext">crack :: Precision -&gt; Int -&gt; Int -&gt; [Int] -&gt; [Int] -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#crack"><span class="hs-identifier hs-var hs-var">crack</span></a></span></span><span> </span><span id="local-6989586621679065179"><span class="annot"><span class="annottext">vPrec :: Precision
</span><a href="#local-6989586621679065179"><span class="hs-identifier hs-var">vPrec</span></a></span></span><span> </span><span id="local-6989586621679065178"><span class="annot"><span class="annottext">vBias :: Int
</span><a href="#local-6989586621679065178"><span class="hs-identifier hs-var">vBias</span></a></span></span><span> </span><span id="local-6989586621679065177"><span class="annot"><span class="annottext">signPos :: Int
</span><a href="#local-6989586621679065177"><span class="hs-identifier hs-var">signPos</span></a></span></span><span> </span><span id="local-6989586621679065176"><span class="annot"><span class="annottext">expPos :: [Int]
</span><a href="#local-6989586621679065176"><span class="hs-identifier hs-var">expPos</span></a></span></span><span> </span><span id="local-6989586621679065175"><span class="annot"><span class="annottext">fracPos :: [Int]
</span><a href="#local-6989586621679065175"><span class="hs-identifier hs-var">fracPos</span></a></span></span><span> </span><span id="local-6989586621679065174"><span class="annot"><span class="annottext">val :: Integer
</span><a href="#local-6989586621679065174"><span class="hs-identifier hs-var">val</span></a></span></span><span>
</span><span id="line-71"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FP :: Integer
-&gt; Precision
-&gt; Bool
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; [Bool]
-&gt; String
-&gt; Kind
-&gt; FP
</span><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type hs-type">FP</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">intVal :: Integer
</span><a href="Data.Numbers.CrackNum.Data.html#intVal"><span class="hs-identifier hs-var">intVal</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065174"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prec :: Precision
</span><a href="Data.Numbers.CrackNum.Data.html#prec"><span class="hs-identifier hs-var">prec</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065179"><span class="hs-identifier hs-var">vPrec</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sign :: Bool
</span><a href="Data.Numbers.CrackNum.Data.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065168"><span class="hs-identifier hs-var">vSign</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stExpt :: Int
</span><a href="Data.Numbers.CrackNum.Data.html#stExpt"><span class="hs-identifier hs-var">stExpt</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065166"><span class="hs-identifier hs-var">vStoredExp</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">expt :: Int
</span><a href="Data.Numbers.CrackNum.Data.html#expt"><span class="hs-identifier hs-var">expt</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065166"><span class="hs-identifier hs-var">vStoredExp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065164"><span class="hs-identifier hs-var">curBias</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bias :: Int
</span><a href="Data.Numbers.CrackNum.Data.html#bias"><span class="hs-identifier hs-var">bias</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065164"><span class="hs-identifier hs-var">curBias</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fracBits :: [Bool]
</span><a href="Data.Numbers.CrackNum.Data.html#fracBits"><span class="hs-identifier hs-var">fracBits</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">vFracBits</span></a></span><span>
</span><span id="line-78"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bitLayOut :: String
</span><a href="Data.Numbers.CrackNum.Data.html#bitLayOut"><span class="hs-identifier hs-var">bitLayOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Bool]] -&gt; String
</span><a href="Data.Numbers.CrackNum.Utils.html#layOut"><span class="hs-identifier hs-var">layOut</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065168"><span class="hs-identifier hs-var">vSign</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">vExpBits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">vFracBits</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kind :: Kind
</span><a href="Data.Numbers.CrackNum.Data.html#kind"><span class="hs-identifier hs-var">kind</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679065156"><span class="hs-identifier hs-var">vKind</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-81"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065155"><span class="annot"><span class="annottext">bit :: Int -&gt; Bool
</span><a href="#local-6989586621679065155"><span class="hs-identifier hs-var hs-var">bit</span></a></span></span><span> </span><span id="local-6989586621679065154"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679065154"><span class="hs-identifier hs-var">i</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065174"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-operator hs-var">`testBit`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065154"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-82"></span><span>         </span><span id="local-6989586621679065168"><span class="annot"><span class="annottext">vSign :: Bool
</span><a href="#local-6989586621679065168"><span class="hs-identifier hs-var hs-var">vSign</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679065155"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065177"><span class="hs-identifier hs-var">signPos</span></a></span><span>
</span><span id="line-83"></span><span>         </span><span id="local-6989586621679065158"><span class="annot"><span class="annottext">vExpBits :: [Bool]
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var hs-var">vExpBits</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679065155"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679065176"><span class="hs-identifier hs-var">expPos</span></a></span><span>
</span><span id="line-84"></span><span>         </span><span id="local-6989586621679065166"><span class="annot"><span class="annottext">vStoredExp :: Int
</span><a href="#local-6989586621679065166"><span class="hs-identifier hs-var hs-var">vStoredExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Int
forall a. Num a =&gt; [Bool] -&gt; a
</span><a href="Data.Numbers.CrackNum.Utils.html#bv"><span class="hs-identifier hs-var">bv</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">vExpBits</span></a></span><span>
</span><span id="line-85"></span><span>         </span><span id="local-6989586621679065161"><span class="annot"><span class="annottext">vFracBits :: [Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var hs-var">vFracBits</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679065155"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679065175"><span class="hs-identifier hs-var">fracPos</span></a></span><span>
</span><span id="line-86"></span><span>         </span><span id="local-6989586621679065152"><span class="annot"><span class="annottext">isZero :: Bool
</span><a href="#local-6989586621679065152"><span class="hs-identifier hs-var hs-var">isZero</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#all0"><span class="hs-identifier hs-var">all0</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">vExpBits</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#all0"><span class="hs-identifier hs-var">all0</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">vFracBits</span></a></span><span>
</span><span id="line-87"></span><span>         </span><span id="local-6989586621679065149"><span class="annot"><span class="annottext">isDenormal :: Bool
</span><a href="#local-6989586621679065149"><span class="hs-identifier hs-var hs-var">isDenormal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#all0"><span class="hs-identifier hs-var">all0</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">vExpBits</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#any1"><span class="hs-identifier hs-var">any1</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">vFracBits</span></a></span><span>
</span><span id="line-88"></span><span>         </span><span id="local-6989586621679065147"><span class="annot"><span class="annottext">isInfinity :: Bool
</span><a href="#local-6989586621679065147"><span class="hs-identifier hs-var hs-var">isInfinity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#all1"><span class="hs-identifier hs-var">all1</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">vExpBits</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#all0"><span class="hs-identifier hs-var">all0</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">vFracBits</span></a></span><span>
</span><span id="line-89"></span><span>         </span><span id="local-6989586621679065145"><span class="annot"><span class="annottext">isNAN :: Bool
</span><a href="#local-6989586621679065145"><span class="hs-identifier hs-var hs-var">isNAN</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#all1"><span class="hs-identifier hs-var">all1</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">vExpBits</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Utils.html#any1"><span class="hs-identifier hs-var">any1</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">vFracBits</span></a></span><span>
</span><span id="line-90"></span><span>         </span><span id="local-6989586621679065156"><span class="annot"><span class="annottext">vKind :: Kind
</span><a href="#local-6989586621679065156"><span class="hs-identifier hs-var hs-var">vKind</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065152"><span class="hs-identifier hs-var">isZero</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Kind
</span><a href="Data.Numbers.CrackNum.Data.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065168"><span class="hs-identifier hs-var">vSign</span></a></span><span>
</span><span id="line-91"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065147"><span class="hs-identifier hs-var">isInfinity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Kind
</span><a href="Data.Numbers.CrackNum.Data.html#Infty"><span class="hs-identifier hs-var">Infty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065168"><span class="hs-identifier hs-var">vSign</span></a></span><span>
</span><span id="line-92"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065145"><span class="hs-identifier hs-var">isNAN</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065161"><span class="hs-identifier hs-var">vFracBits</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.Numbers.CrackNum.Data.html#QNaN"><span class="hs-identifier hs-var">QNaN</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.Numbers.CrackNum.Data.html#SNaN"><span class="hs-identifier hs-var">SNaN</span></a></span><span>
</span><span id="line-93"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065149"><span class="hs-identifier hs-var">isDenormal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.Numbers.CrackNum.Data.html#Denormal"><span class="hs-identifier hs-var">Denormal</span></a></span><span>
</span><span id="line-94"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="Data.Numbers.CrackNum.Data.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span>
</span><span id="line-95"></span><span>         </span><span id="local-6989586621679065164"><span class="annot"><span class="annottext">curBias :: Int
</span><a href="#local-6989586621679065164"><span class="hs-identifier hs-var hs-var">curBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679065156"><span class="hs-identifier hs-var">vKind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-96"></span><span>                     </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Denormal"><span class="hs-identifier hs-type">Denormal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065178"><span class="hs-identifier hs-var">vBias</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-97"></span><span>                     </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065178"><span class="hs-identifier hs-var">vBias</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Display a Floating-point number in a nicely formatted way. (This function is also available</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- through the 'Show' instance for 'FP', but is provided here for symmetry with 'displayWord'.)</span><span>
</span><span id="line-101"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#displayFP"><span class="hs-identifier hs-type">displayFP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-102"></span><span id="displayFP"><span class="annot"><span class="annottext">displayFP :: FP -&gt; String
</span><a href="Data.Numbers.CrackNum.html#displayFP"><span class="hs-identifier hs-var hs-var">displayFP</span></a></span></span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span class="hs-special">{</span><span id="local-6989586621679065137"><span class="annot"><span class="annottext">Integer
intVal :: Integer
intVal :: FP -&gt; Integer
</span><a href="#local-6989586621679065137"><span class="hs-identifier hs-var hs-var">intVal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065136"><span class="annot"><span class="annottext">Precision
prec :: Precision
prec :: FP -&gt; Precision
</span><a href="#local-6989586621679065136"><span class="hs-identifier hs-var hs-var">prec</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065135"><span class="annot"><span class="annottext">Bool
sign :: Bool
sign :: FP -&gt; Bool
</span><a href="#local-6989586621679065135"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065134"><span class="annot"><span class="annottext">Int
stExpt :: Int
stExpt :: FP -&gt; Int
</span><a href="#local-6989586621679065134"><span class="hs-identifier hs-var hs-var">stExpt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065133"><span class="annot"><span class="annottext">Int
bias :: Int
bias :: FP -&gt; Int
</span><a href="#local-6989586621679065133"><span class="hs-identifier hs-var hs-var">bias</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065132"><span class="annot"><span class="annottext">Int
expt :: Int
expt :: FP -&gt; Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var hs-var">expt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065131"><span class="annot"><span class="annottext">[Bool]
fracBits :: [Bool]
fracBits :: FP -&gt; [Bool]
</span><a href="#local-6989586621679065131"><span class="hs-identifier hs-var hs-var">fracBits</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065130"><span class="annot"><span class="annottext">String
bitLayOut :: String
bitLayOut :: FP -&gt; String
</span><a href="#local-6989586621679065130"><span class="hs-identifier hs-var hs-var">bitLayOut</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065129"><span class="annot"><span class="annottext">Kind
kind :: Kind
kind :: FP -&gt; Kind
</span><a href="#local-6989586621679065129"><span class="hs-identifier hs-var hs-var">kind</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679065128"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065128"><span class="annot"><span class="annottext">ls :: [String]
</span><a href="#local-6989586621679065128"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;                  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065127"><span class="hs-identifier hs-var">inds1</span></a></span><span>
</span><span id="line-104"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;                  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065126"><span class="hs-identifier hs-var">inds2</span></a></span><span>
</span><span id="line-105"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;                  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">inds3</span></a></span><span>
</span><span id="line-106"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;          Binary: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065130"><span class="hs-identifier hs-var">bitLayOut</span></a></span><span>
</span><span id="line-107"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;             Hex: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; String
</span><a href="Data.Numbers.CrackNum.Utils.html#hexDisp"><span class="hs-identifier hs-var">hexDisp</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065123"><span class="hs-identifier hs-var">allBits</span></a></span><span>
</span><span id="line-108"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;       Precision: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Precision -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065136"><span class="hs-identifier hs-var">prec</span></a></span><span>
</span><span id="line-109"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;            Sign: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065135"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;Negative&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;Positive&quot;</span></span><span>
</span><span id="line-110"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;        Exponent: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var">expt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; (Stored: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065134"><span class="hs-identifier hs-var">stExpt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, Bias: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065133"><span class="hs-identifier hs-var">bias</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-111"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;       Hex-float: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065121"><span class="hs-identifier hs-var">hexVal</span></a></span><span>
</span><span id="line-112"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;           Value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065120"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-113"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>             </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;            Note: Representation for NaN's is not unique.&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="Data.Numbers.CrackNum.Data.html#isNaNKind"><span class="hs-identifier hs-var">isNaNKind</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679065129"><span class="hs-identifier hs-var">kind</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679065127"><span class="annot"><span class="annottext">inds1 :: String
</span><a href="#local-6989586621679065127"><span class="hs-identifier hs-var">inds1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065126"><span class="annot"><span class="annottext">inds2 :: String
</span><a href="#local-6989586621679065126"><span class="hs-identifier hs-var">inds2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065125"><span class="annot"><span class="annottext">inds3 :: String
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">inds3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065136"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-117"></span><span>                                  </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#HP"><span class="hs-identifier hs-type">HP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#hpInds1"><span class="hs-identifier hs-var">hpInds1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#hpInds2"><span class="hs-identifier hs-var">hpInds2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#hpInds3"><span class="hs-identifier hs-var">hpInds3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>                                  </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#spInds1"><span class="hs-identifier hs-var">spInds1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#spInds2"><span class="hs-identifier hs-var">spInds2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#spInds3"><span class="hs-identifier hs-var">spInds3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>                                  </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-type">DP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#dpInds1"><span class="hs-identifier hs-var">dpInds1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#dpInds2"><span class="hs-identifier hs-var">dpInds2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#dpInds3"><span class="hs-identifier hs-var">dpInds3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>        </span><span id="local-6989586621679065123"><span class="annot"><span class="annottext">allBits :: [Bool]
</span><a href="#local-6989586621679065123"><span class="hs-identifier hs-var hs-var">allBits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065136"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-121"></span><span>                    </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#HP"><span class="hs-identifier hs-type">HP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065137"><span class="hs-identifier hs-var">intVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-operator hs-var">`testBit`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065109"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065109"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065109"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int]
forall a. (Num a, Enum a) =&gt; a -&gt; [a]
</span><a href="#local-6989586621679065108"><span class="hs-identifier hs-var">startsAt</span></a></span><span> </span><span class="annot"><span class="hs-number">15</span></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>                    </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065137"><span class="hs-identifier hs-var">intVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-operator hs-var">`testBit`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065107"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065107"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065107"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int]
forall a. (Num a, Enum a) =&gt; a -&gt; [a]
</span><a href="#local-6989586621679065108"><span class="hs-identifier hs-var">startsAt</span></a></span><span> </span><span class="annot"><span class="hs-number">31</span></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>                    </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-type">DP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065137"><span class="hs-identifier hs-var">intVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-operator hs-var">`testBit`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065106"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065106"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065106"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int]
forall a. (Num a, Enum a) =&gt; a -&gt; [a]
</span><a href="#local-6989586621679065108"><span class="hs-identifier hs-var">startsAt</span></a></span><span> </span><span class="annot"><span class="hs-number">63</span></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065108"><span class="annot"><span class="annottext">startsAt :: a -&gt; [a]
</span><a href="#local-6989586621679065108"><span class="hs-identifier hs-var hs-var">startsAt</span></a></span></span><span> </span><span id="local-6989586621679065105"><span class="annot"><span class="annottext">n :: a
</span><a href="#local-6989586621679065105"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065105"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065105"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679065104"><span class="annot"><span class="annottext">dup :: b -&gt; (b, b)
</span><a href="#local-6989586621679065104"><span class="hs-identifier hs-var hs-var">dup</span></a></span></span><span> </span><span id="local-6989586621679065103"><span class="annot"><span class="annottext">x :: b
</span><a href="#local-6989586621679065103"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065103"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065103"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679065120"><span class="annot"><span class="annottext">val :: String
</span><a href="#local-6989586621679065120"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065121"><span class="annot"><span class="annottext">hexVal :: String
</span><a href="#local-6989586621679065121"><span class="hs-identifier hs-var">hexVal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679065129"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;+0.0&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;0x0p+0&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;-0.0&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;-0x0p+0&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Infty"><span class="hs-identifier hs-type">Infty</span></a></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
forall b. b -&gt; (b, b)
</span><a href="#local-6989586621679065104"><span class="hs-identifier hs-var">dup</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;+Infinity&quot;</span></span><span>
</span><span id="line-132"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Infty"><span class="hs-identifier hs-type">Infty</span></a></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
forall b. b -&gt; (b, b)
</span><a href="#local-6989586621679065104"><span class="hs-identifier hs-var">dup</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;-Infinity&quot;</span></span><span>
</span><span id="line-133"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#SNaN"><span class="hs-identifier hs-type">SNaN</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
forall b. b -&gt; (b, b)
</span><a href="#local-6989586621679065104"><span class="hs-identifier hs-var">dup</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;NaN (Signaling)&quot;</span></span><span>
</span><span id="line-134"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#QNaN"><span class="hs-identifier hs-type">QNaN</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
forall b. b -&gt; (b, b)
</span><a href="#local-6989586621679065104"><span class="hs-identifier hs-var">dup</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;NaN (Quietized)&quot;</span></span><span>
</span><span id="line-135"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Denormal"><span class="hs-identifier hs-type">Denormal</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; (String, String)
</span><a href="#local-6989586621679065102"><span class="hs-identifier hs-var">nval</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="hs-string">&quot; (DENORMAL)&quot;</span></span><span>
</span><span id="line-136"></span><span>                          </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Normal"><span class="hs-identifier hs-type">Normal</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; (String, String)
</span><a href="#local-6989586621679065102"><span class="hs-identifier hs-var">nval</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="hs-string">&quot; (NORMAL)&quot;</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>        </span><span id="local-6989586621679065102"><span class="annot"><span class="annottext">nval :: Bool -&gt; String -&gt; (String, String)
</span><a href="#local-6989586621679065102"><span class="hs-identifier hs-var hs-var">nval</span></a></span></span><span> </span><span id="local-6989586621679065101"><span class="annot"><span class="annottext">dn :: Bool
</span><a href="#local-6989586621679065101"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span id="local-6989586621679065100"><span class="annot"><span class="annottext">tag :: String
</span><a href="#local-6989586621679065100"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065099"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065098"><span class="hs-identifier hs-var">vd</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065100"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065099"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065097"><span class="hs-identifier hs-var">vh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>         </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065099"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679065099"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065135"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-140"></span><span>               </span><span id="local-6989586621679065098"><span class="annot"><span class="annottext">vd :: String
</span><a href="#local-6989586621679065098"><span class="hs-identifier hs-var hs-var">vd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065136"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>                      </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#HP"><span class="hs-identifier hs-type">HP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Float -&gt; String -&gt; String
forall a. RealFloat a =&gt; Maybe Int -&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showGFloat</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; [Bool] -&gt; Float
</span><a href="Data.Numbers.CrackNum.html#spVal"><span class="hs-identifier hs-var">spVal</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065101"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var">expt</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065131"><span class="hs-identifier hs-var">fracBits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-142"></span><span>                      </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Float -&gt; String -&gt; String
forall a. RealFloat a =&gt; Maybe Int -&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showGFloat</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; [Bool] -&gt; Float
</span><a href="Data.Numbers.CrackNum.html#spVal"><span class="hs-identifier hs-var">spVal</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065101"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var">expt</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065131"><span class="hs-identifier hs-var">fracBits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-143"></span><span>                      </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-type">DP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Double -&gt; String -&gt; String
forall a. RealFloat a =&gt; Maybe Int -&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showGFloat</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; [Bool] -&gt; Double
</span><a href="Data.Numbers.CrackNum.html#dpVal"><span class="hs-identifier hs-var">dpVal</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065101"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var">expt</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065131"><span class="hs-identifier hs-var">fracBits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-144"></span><span>               </span><span id="local-6989586621679065097"><span class="annot"><span class="annottext">vh :: String
</span><a href="#local-6989586621679065097"><span class="hs-identifier hs-var hs-var">vh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065136"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>                      </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#HP"><span class="hs-identifier hs-type">HP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Float -&gt; String -&gt; String
forall a. RealFloat a =&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">FH.showHFloat</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; [Bool] -&gt; Float
</span><a href="Data.Numbers.CrackNum.html#spVal"><span class="hs-identifier hs-var">spVal</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065101"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var">expt</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065131"><span class="hs-identifier hs-var">fracBits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-146"></span><span>                      </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Float -&gt; String -&gt; String
forall a. RealFloat a =&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">FH.showHFloat</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; [Bool] -&gt; Float
</span><a href="Data.Numbers.CrackNum.html#spVal"><span class="hs-identifier hs-var">spVal</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065101"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var">expt</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065131"><span class="hs-identifier hs-var">fracBits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-147"></span><span>                      </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-type">DP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; String -&gt; String
forall a. RealFloat a =&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">FH.showHFloat</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; [Bool] -&gt; Double
</span><a href="Data.Numbers.CrackNum.html#dpVal"><span class="hs-identifier hs-var">dpVal</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065101"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065132"><span class="hs-identifier hs-var">expt</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065131"><span class="hs-identifier hs-var">fracBits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Show instance for FP</span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679065090"><span id="local-6989586621679065093"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>   </span><span id="local-6989586621679065088"><span class="annot"><span class="annottext">show :: FP -&gt; String
</span><a href="#local-6989586621679065088"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FP -&gt; String
</span><a href="Data.Numbers.CrackNum.html#displayFP"><span class="hs-identifier hs-var">displayFP</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Display a Integer (signed/unsigned) number in a nicely formatted way</span><span>
</span><span id="line-154"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#displayWord"><span class="hs-identifier hs-type">displayWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#IPrecision"><span class="hs-identifier hs-type">IPrecision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-155"></span><span id="displayWord"><span class="annot"><span class="annottext">displayWord :: IPrecision -&gt; Integer -&gt; String
</span><a href="Data.Numbers.CrackNum.html#displayWord"><span class="hs-identifier hs-var hs-var">displayWord</span></a></span></span><span> </span><span id="local-6989586621679065087"><span class="annot"><span class="annottext">iprec :: IPrecision
</span><a href="#local-6989586621679065087"><span class="hs-identifier hs-var">iprec</span></a></span></span><span> </span><span id="local-6989586621679065086"><span class="annot"><span class="annottext">intVal :: Integer
</span><a href="#local-6989586621679065086"><span class="hs-identifier hs-var">intVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679065085"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065084"><span class="annot"><span class="annottext">sg :: Bool
</span><a href="#local-6989586621679065084"><span class="hs-identifier hs-var">sg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065083"><span class="annot"><span class="annottext">sz :: Int
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">sz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPrecision -&gt; (Bool, Int)
</span><a href="Data.Numbers.CrackNum.Utils.html#sgSz"><span class="hs-identifier hs-var">sgSz</span></a></span><span> </span><span class="annot"><span class="annottext">IPrecision
</span><a href="#local-6989586621679065087"><span class="hs-identifier hs-var">iprec</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621679065085"><span class="annot"><span class="annottext">ls :: [String]
</span><a href="#local-6989586621679065085"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;                  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; String
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679065081"><span class="hs-identifier hs-var">inds1</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679065081"><span class="hs-identifier hs-var">inds1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;                  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065080"><span class="hs-identifier hs-var">inds2</span></a></span><span>
</span><span id="line-159"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;          Binary: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; String
</span><a href="Data.Numbers.CrackNum.Utils.html#binDisp"><span class="hs-identifier hs-var">binDisp</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065078"><span class="hs-identifier hs-var">allBits</span></a></span><span>
</span><span id="line-160"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;             Hex: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; String
</span><a href="Data.Numbers.CrackNum.Utils.html#hexDisp"><span class="hs-identifier hs-var">hexDisp</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065078"><span class="hs-identifier hs-var">allBits</span></a></span><span>
</span><span id="line-161"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;            Type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IPrecision -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IPrecision
</span><a href="#local-6989586621679065087"><span class="hs-identifier hs-var">iprec</span></a></span><span>
</span><span id="line-162"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;            Sign: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065077"><span class="hs-identifier hs-var">signBit</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;Negative&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;Positive&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065084"><span class="hs-identifier hs-var">sg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;           Value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065076"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-165"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679065081"><span class="annot"><span class="annottext">inds1 :: Maybe String
</span><a href="#local-6989586621679065081"><span class="hs-identifier hs-var">inds1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065080"><span class="annot"><span class="annottext">inds2 :: String
</span><a href="#local-6989586621679065080"><span class="hs-identifier hs-var">inds2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>                           </span><span class="hs-number">8</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#bInds2"><span class="hs-identifier hs-var">bInds2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>                           </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#wInds1"><span class="hs-identifier hs-var">wInds1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#wInds2"><span class="hs-identifier hs-var">wInds2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>                           </span><span class="hs-number">32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#dInds1"><span class="hs-identifier hs-var">dInds1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#dInds2"><span class="hs-identifier hs-var">dInds2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>                           </span><span class="hs-number">64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#qInds1"><span class="hs-identifier hs-var">qInds1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Data.Numbers.CrackNum.Utils.html#qInds2"><span class="hs-identifier hs-var">qInds2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>                           </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Maybe String, String)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Maybe String, String))
-&gt; String -&gt; (Maybe String, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;displayWord: Unexpected size: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span id="local-6989586621679065078"><span class="annot"><span class="annottext">allBits :: [Bool]
</span><a href="#local-6989586621679065078"><span class="hs-identifier hs-var hs-var">allBits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065086"><span class="hs-identifier hs-var">intVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-operator hs-var">`testBit`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065067"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065067"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065067"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">sz</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">sz</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>        </span><span id="local-6989586621679065077"><span class="annot"><span class="annottext">signBit :: Bool
</span><a href="#local-6989586621679065077"><span class="hs-identifier hs-var hs-var">signBit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065078"><span class="hs-identifier hs-var">allBits</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span id="local-6989586621679065076"><span class="annot"><span class="annottext">val :: String
</span><a href="#local-6989586621679065076"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065084"><span class="hs-identifier hs-var">sg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065086"><span class="hs-identifier hs-var">intVal</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IPrecision
</span><a href="#local-6989586621679065087"><span class="hs-identifier hs-var">iprec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-176"></span><span>                         </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#I8"><span class="hs-identifier hs-type">I8</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int8 -&gt; String) -&gt; Int8 -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; Int8
forall a. Bits a =&gt; a -&gt; a
</span><a href="#local-6989586621679065064"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>                         </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#I16"><span class="hs-identifier hs-type">I16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int16 -&gt; String) -&gt; Int16 -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16
forall a. Bits a =&gt; a -&gt; a
</span><a href="#local-6989586621679065064"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>                         </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#I32"><span class="hs-identifier hs-type">I32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int32 -&gt; String) -&gt; Int32 -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32
forall a. Bits a =&gt; a -&gt; a
</span><a href="#local-6989586621679065064"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>                         </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; String) -&gt; Int64 -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64
forall a. Bits a =&gt; a -&gt; a
</span><a href="#local-6989586621679065064"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>                         </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;displayWord: Unexpected type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IPrecision -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IPrecision
</span><a href="#local-6989586621679065087"><span class="hs-identifier hs-var">iprec</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span id="local-6989586621679065284"><span class="annot"><a href="#local-6989586621679065064"><span class="hs-identifier hs-type">adjust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679065284"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065284"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065284"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-182"></span><span>        </span><span id="local-6989586621679065064"><span class="annot"><span class="annottext">adjust :: a -&gt; a
</span><a href="#local-6989586621679065064"><span class="hs-identifier hs-var hs-var">adjust</span></a></span></span><span> </span><span id="local-6989586621679065060"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679065060"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; [Int] -&gt; a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Int -&gt; a) -&gt; Int -&gt; a -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">setBit</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065060"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065057"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065057"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679065057"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Bool] -&gt; [(Int, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679065078"><span class="hs-identifier hs-var">allBits</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Convert the given string to a IEEE number with the required precision</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#stringToFP"><span class="hs-identifier hs-type">stringToFP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#Precision"><span class="hs-identifier hs-type">Precision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span>
</span><span id="line-186"></span><span id="stringToFP"><span class="annot"><span class="annottext">stringToFP :: Precision -&gt; String -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#stringToFP"><span class="hs-identifier hs-var hs-var">stringToFP</span></a></span></span><span> </span><span id="local-6989586621679065055"><span class="annot"><span class="annottext">precision :: Precision
</span><a href="#local-6989586621679065055"><span class="hs-identifier hs-var">precision</span></a></span></span><span> </span><span id="local-6989586621679065054"><span class="annot"><span class="annottext">input :: String
</span><a href="#local-6989586621679065054"><span class="hs-identifier hs-var">input</span></a></span></span><span>
</span><span id="line-187"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065055"><span class="hs-identifier hs-var">precision</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FP -&gt; Maybe FP -&gt; FP
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FP
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; FP) -&gt; String -&gt; FP
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;*** stringToFP: Cannot read a valid SP number from: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065054"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FP
</span><a href="#local-6989586621679065053"><span class="hs-identifier hs-var">mbF</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-type">DP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FP -&gt; Maybe FP -&gt; FP
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FP
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; FP) -&gt; String -&gt; FP
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;*** stringToFP: Cannot read a valid DP number from: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065054"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FP
</span><a href="#local-6989586621679065052"><span class="hs-identifier hs-var">mbD</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; FP
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; FP) -&gt; String -&gt; FP
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;*** stringToFP: Unsupported precision: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Precision -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679065055"><span class="hs-identifier hs-var">precision</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065051"><span class="annot"><span class="annottext">i :: String
</span><a href="#local-6989586621679065051"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'+'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065054"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><a href="#local-6989586621679065049"><span class="hs-identifier hs-type">specials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>        </span><span id="local-6989586621679065049"><span class="annot"><span class="annottext">specials :: [(String, (FP, FP))]
</span><a href="#local-6989586621679065049"><span class="hs-identifier hs-var hs-var">specials</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065048"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#floatToFP"><span class="hs-identifier hs-var">floatToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065047"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#doubleToFP"><span class="hs-identifier hs-var">doubleToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065046"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065048"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679065048"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065047"><span class="annot"><span class="annottext">f :: Float
</span><a href="#local-6989586621679065047"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065046"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679065046"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;infinity&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065045"><span class="hs-identifier hs-var">infinityF</span></a></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065044"><span class="hs-identifier hs-var">infinityD</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;-infinity&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065045"><span class="hs-identifier hs-var">infinityF</span></a></span><span class="hs-special">,</span><span>         </span><span class="hs-glyph">-</span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065044"><span class="hs-identifier hs-var">infinityD</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">,</span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span>                    </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;-0&quot;</span></span><span class="hs-special">,</span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span>                 </span><span class="hs-glyph">-</span><span>  </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;max&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065043"><span class="hs-identifier hs-var">maxFiniteF</span></a></span><span class="hs-special">,</span><span>           </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var">maxFiniteD</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;-max&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065043"><span class="hs-identifier hs-var">maxFiniteF</span></a></span><span class="hs-special">,</span><span>         </span><span class="hs-glyph">-</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var">maxFiniteD</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;min&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065041"><span class="hs-identifier hs-var">minNormalF</span></a></span><span class="hs-special">,</span><span>           </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065040"><span class="hs-identifier hs-var">minNormalD</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;-min&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065041"><span class="hs-identifier hs-var">minNormalF</span></a></span><span class="hs-special">,</span><span>         </span><span class="hs-glyph">-</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065040"><span class="hs-identifier hs-var">minNormalD</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;epsilon&quot;</span></span><span class="hs-special">,</span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065039"><span class="hs-identifier hs-var">epsilonF</span></a></span><span class="hs-special">,</span><span>             </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065038"><span class="hs-identifier hs-var">epsilonD</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>                                 </span><span class="annot"><span class="annottext">[(String, (FP, FP))]
-&gt; [(String, (FP, FP))] -&gt; [(String, (FP, FP))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;ulp&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span>          </span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-var">DP</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;nan&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="annot"><span class="hs-number">0x7f800001</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-var">DP</span></a></span><span> </span><span class="annot"><span class="hs-number">0x7ff0000000000001</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;snan&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="annot"><span class="hs-number">0x7f800001</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-var">DP</span></a></span><span> </span><span class="annot"><span class="hs-number">0x7ff0000000000001</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;qnan&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="annot"><span class="hs-number">0x7fc00000</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-var">DP</span></a></span><span> </span><span class="annot"><span class="hs-number">0x7ff8000000000000</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="#local-6989586621679065045"><span class="hs-identifier hs-type">infinityF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065043"><span class="hs-identifier hs-type">maxFiniteF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065041"><span class="hs-identifier hs-type">minNormalF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065039"><span class="hs-identifier hs-type">epsilonF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621679065045"><span class="annot"><span class="annottext">infinityF :: Float
</span><a href="#local-6989586621679065045"><span class="hs-identifier hs-var hs-var">infinityF</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-211"></span><span>        </span><span id="local-6989586621679065043"><span class="annot"><span class="annottext">maxFiniteF :: Float
</span><a href="#local-6989586621679065043"><span class="hs-identifier hs-var hs-var">maxFiniteF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">3.40282347e+38</span></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621679065041"><span class="annot"><span class="annottext">minNormalF :: Float
</span><a href="#local-6989586621679065041"><span class="hs-identifier hs-var hs-var">minNormalF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1.17549435e-38</span></span><span>
</span><span id="line-213"></span><span>        </span><span id="local-6989586621679065039"><span class="annot"><span class="annottext">epsilonF :: Float
</span><a href="#local-6989586621679065039"><span class="hs-identifier hs-var hs-var">epsilonF</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1.19209290e-07</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="#local-6989586621679065044"><span class="hs-identifier hs-type">infinityD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065042"><span class="hs-identifier hs-type">maxFiniteD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065040"><span class="hs-identifier hs-type">minNormalD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065038"><span class="hs-identifier hs-type">epsilonD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621679065044"><span class="annot"><span class="annottext">infinityD :: Double
</span><a href="#local-6989586621679065044"><span class="hs-identifier hs-var hs-var">infinityD</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621679065042"><span class="annot"><span class="annottext">maxFiniteD :: Double
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var hs-var">maxFiniteD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1.7976931348623157e+308</span></span><span>
</span><span id="line-218"></span><span>        </span><span id="local-6989586621679065040"><span class="annot"><span class="annottext">minNormalD :: Double
</span><a href="#local-6989586621679065040"><span class="hs-identifier hs-var hs-var">minNormalD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2.2250738585072014e-308</span></span><span>
</span><span id="line-219"></span><span>        </span><span id="local-6989586621679065038"><span class="annot"><span class="annottext">epsilonD :: Double
</span><a href="#local-6989586621679065038"><span class="hs-identifier hs-var hs-var">epsilonD</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2.2204460492503131e-16</span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><a href="#local-6989586621679065053"><span class="hs-identifier hs-type">mbF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065052"><span class="hs-identifier hs-type">mbD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679065053"><span class="annot"><span class="annottext">mbF :: Maybe FP
</span><a href="#local-6989586621679065053"><span class="hs-identifier hs-var">mbF</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065052"><span class="annot"><span class="annottext">mbD :: Maybe FP
</span><a href="#local-6989586621679065052"><span class="hs-identifier hs-var">mbD</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065051"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [(String, (FP, FP))] -&gt; Maybe (FP, FP)
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-operator hs-var">`lookup`</span></span><span> </span><span class="annot"><span class="annottext">[(String, (FP, FP))]
</span><a href="#local-6989586621679065049"><span class="hs-identifier hs-var">specials</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Float
forall a. (Read a, FloatingHexReader a) =&gt; String -&gt; Maybe a
</span><a href="#local-6989586621679065035"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065051"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Double
forall a. (Read a, FloatingHexReader a) =&gt; String -&gt; Maybe a
</span><a href="#local-6989586621679065035"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065051"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-223"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065034"><span class="annot"><span class="annottext">f :: FP
</span><a href="#local-6989586621679065034"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065033"><span class="annot"><span class="annottext">d :: FP
</span><a href="#local-6989586621679065033"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FP -&gt; Maybe FP
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FP
</span><a href="#local-6989586621679065034"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span>             </span><span class="annot"><span class="annottext">FP -&gt; Maybe FP
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FP
</span><a href="#local-6989586621679065033"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679065032"><span class="annot"><span class="annottext">f :: Float
</span><a href="#local-6989586621679065032"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679065031"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679065031"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FP -&gt; Maybe FP
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#floatToFP"><span class="hs-identifier hs-var">floatToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065032"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FP -&gt; Maybe FP
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#doubleToFP"><span class="hs-identifier hs-var">doubleToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065031"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679065030"><span class="annot"><span class="annottext">f :: Float
</span><a href="#local-6989586621679065030"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FP -&gt; Maybe FP
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#floatToFP"><span class="hs-identifier hs-var">floatToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065030"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FP
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679065029"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679065029"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FP
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">FP -&gt; Maybe FP
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#doubleToFP"><span class="hs-identifier hs-var">doubleToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065029"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                       </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FP
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Maybe FP
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>        </span><span id="local-6989586621679065268"><span class="annot"><a href="#local-6989586621679065035"><span class="hs-identifier hs-type">rd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679065268"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FH.FloatingHexReader</span></span><span> </span><span class="annot"><a href="#local-6989586621679065268"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679065268"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-230"></span><span>        </span><span id="local-6989586621679065035"><span class="annot"><span class="annottext">rd :: String -&gt; Maybe a
</span><a href="#local-6989586621679065035"><span class="hs-identifier hs-var hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679065028"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679065028"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065027"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065027"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679065027"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS a
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065028"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Maybe a] -&gt; [a]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. FloatingHexReader a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">FH.readHFloat</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679065028"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-231"></span><span>                 </span><span class="hs-special">[</span><span id="local-6989586621679065024"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679065024"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065024"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-232"></span><span>                 </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Turn a Haskell float to the internal detailed FP representation</span><span>
</span><span id="line-235"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#floatToFP"><span class="hs-identifier hs-type">floatToFP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span>
</span><span id="line-236"></span><span id="floatToFP"><span class="annot"><span class="annottext">floatToFP :: Float -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#floatToFP"><span class="hs-identifier hs-var hs-var">floatToFP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; FP) -&gt; (Float -&gt; Integer) -&gt; Float -&gt; FP
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Integer) -&gt; (Float -&gt; Word32) -&gt; Float -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Word32
</span><a href="Data.Numbers.CrackNum.html#floatToWord"><span class="hs-identifier hs-var">floatToWord</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Turn a Haskell double to the internal detailed FP representation</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#doubleToFP"><span class="hs-identifier hs-type">doubleToFP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.Data.html#FP"><span class="hs-identifier hs-type">FP</span></a></span><span>
</span><span id="line-240"></span><span id="doubleToFP"><span class="annot"><span class="annottext">doubleToFP :: Double -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#doubleToFP"><span class="hs-identifier hs-var hs-var">doubleToFP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Precision -&gt; Integer -&gt; FP
</span><a href="Data.Numbers.CrackNum.html#integerToFP"><span class="hs-identifier hs-var">integerToFP</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="Data.Numbers.CrackNum.Data.html#DP"><span class="hs-identifier hs-var">DP</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; FP) -&gt; (Double -&gt; Integer) -&gt; Double -&gt; FP
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Integer) -&gt; (Double -&gt; Word64) -&gt; Double -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Word64
</span><a href="Data.Numbers.CrackNum.html#doubleToWord"><span class="hs-identifier hs-var">doubleToWord</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- Reinterpreting float/double as word32/64 and back. Here, we use the</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- definitions from the reinterpret-cast package:</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">--     http://hackage.haskell.org/package/reinterpret-cast</span><span>
</span><span id="line-247"></span><span class="hs-comment">--</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- The reason we steal these definitions is to make sure we keep minimal</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- dependencies and no FFI requirements anywhere.</span><span>
</span><span id="line-250"></span><span class="hs-comment">-------------------------------------------------------------------------</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Reinterpret-casts a `Float` to a `Word32`.</span><span>
</span><span id="line-252"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#floatToWord"><span class="hs-identifier hs-type">floatToWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-253"></span><span id="floatToWord"><span class="annot"><span class="annottext">floatToWord :: Float -&gt; Word32
</span><a href="Data.Numbers.CrackNum.html#floatToWord"><span class="hs-identifier hs-var hs-var">floatToWord</span></a></span></span><span> </span><span id="local-6989586621679065022"><span class="annot"><span class="annottext">x :: Float
</span><a href="#local-6989586621679065022"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s Word32) -&gt; Word32
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; ST s Word32
forall s a b.
(MArray (STUArray s) a (ST s), MArray (STUArray s) b (ST s)) =&gt;
a -&gt; ST s b
</span><a href="Data.Numbers.CrackNum.html#cast"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679065022"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#floatToWord"><span class="hs-pragma hs-type">floatToWord</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Reinterpret-casts a `Word32` to a `Float`.</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#wordToFloat"><span class="hs-identifier hs-type">wordToFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-258"></span><span id="wordToFloat"><span class="annot"><span class="annottext">wordToFloat :: Word32 -&gt; Float
</span><a href="Data.Numbers.CrackNum.html#wordToFloat"><span class="hs-identifier hs-var hs-var">wordToFloat</span></a></span></span><span> </span><span id="local-6989586621679065020"><span class="annot"><span class="annottext">x :: Word32
</span><a href="#local-6989586621679065020"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s Float) -&gt; Float
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; ST s Float
forall s a b.
(MArray (STUArray s) a (ST s), MArray (STUArray s) b (ST s)) =&gt;
a -&gt; ST s b
</span><a href="Data.Numbers.CrackNum.html#cast"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679065020"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#wordToFloat"><span class="hs-pragma hs-type">wordToFloat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Reinterpret-casts a `Double` to a `Word64`.</span><span>
</span><span id="line-262"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#doubleToWord"><span class="hs-identifier hs-type">doubleToWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-263"></span><span id="doubleToWord"><span class="annot"><span class="annottext">doubleToWord :: Double -&gt; Word64
</span><a href="Data.Numbers.CrackNum.html#doubleToWord"><span class="hs-identifier hs-var hs-var">doubleToWord</span></a></span></span><span> </span><span id="local-6989586621679065019"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679065019"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s Word64) -&gt; Word64
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; ST s Word64
forall s a b.
(MArray (STUArray s) a (ST s), MArray (STUArray s) b (ST s)) =&gt;
a -&gt; ST s b
</span><a href="Data.Numbers.CrackNum.html#cast"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679065019"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#doubleToWord"><span class="hs-pragma hs-type">doubleToWord</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Reinterpret-casts a `Word64` to a `Double`.</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Data.Numbers.CrackNum.html#wordToDouble"><span class="hs-identifier hs-type">wordToDouble</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-268"></span><span id="wordToDouble"><span class="annot"><span class="annottext">wordToDouble :: Word64 -&gt; Double
</span><a href="Data.Numbers.CrackNum.html#wordToDouble"><span class="hs-identifier hs-var hs-var">wordToDouble</span></a></span></span><span> </span><span id="local-6989586621679065018"><span class="annot"><span class="annottext">x :: Word64
</span><a href="#local-6989586621679065018"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s Double) -&gt; Double
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; ST s Double
forall s a b.
(MArray (STUArray s) a (ST s), MArray (STUArray s) b (ST s)) =&gt;
a -&gt; ST s b
</span><a href="Data.Numbers.CrackNum.html#cast"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679065018"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#wordToDouble"><span class="hs-pragma hs-type">wordToDouble</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Numbers.CrackNum.html#cast"><span class="hs-pragma hs-type">cast</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-272"></span><span id="local-6989586621679065249"><span id="local-6989586621679065251"><span id="local-6989586621679065253"><span class="annot"><a href="Data.Numbers.CrackNum.html#cast"><span class="hs-identifier hs-type">cast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065253"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679065251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679065253"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STUArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679065253"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679065249"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679065253"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679065253"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065249"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-273"></span><span id="cast"><span class="annot"><span class="annottext">cast :: a -&gt; ST s b
</span><a href="Data.Numbers.CrackNum.html#cast"><span class="hs-identifier hs-var hs-var">cast</span></a></span></span><span> </span><span id="local-6989586621679065017"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679065017"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; a -&gt; ST s (STUArray s Int a)
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; e -&gt; m (a i e)
</span><span class="hs-identifier hs-var">newArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065017"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ST s (STUArray s Int a)
-&gt; (STUArray s Int a -&gt; ST s (STUArray s Int b))
-&gt; ST s (STUArray s Int b)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">STUArray s Int a -&gt; ST s (STUArray s Int b)
forall s ix a b. STUArray s ix a -&gt; ST s (STUArray s ix b)
</span><span class="hs-identifier hs-var">castSTUArray</span></span><span> </span><span class="annot"><span class="annottext">ST s (STUArray s Int b) -&gt; (STUArray s Int b -&gt; ST s b) -&gt; ST s b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(STUArray s Int b -&gt; Int -&gt; ST s b)
-&gt; Int -&gt; STUArray s Int b -&gt; ST s b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">STUArray s Int b -&gt; Int -&gt; ST s b
forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><span class="hs-identifier hs-var">readArray</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-274"></span></pre></body></html>